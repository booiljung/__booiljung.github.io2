<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/linux/ffmpeg/A005/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>출력 파일 포맷 설정 - 실험 도서관</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "1. \ud30c\uc77c \ud3ec\ub9f7\uc774\ub780", url: "#_top", children: [
          ]},
          {title: "2. FFmpeg\uc5d0\uc11c \uc9c0\uc6d0\ud558\ub294 \uc8fc\uc694 \ud30c\uc77c \ud3ec\ub9f7", url: "#2-ffmpeg", children: [
          ]},
          {title: "3. \ucd9c\ub825 \ud3ec\ub9f7 \uc124\uc815\ud558\uae30", url: "#3", children: [
          ]},
          {title: "4. \ud3ec\ub9f7 \uc120\ud0dd \uae30\uc900", url: "#4", children: [
          ]},
          {title: "5. \ud3ec\ub9f7\uc5d0 \ub530\ub978 \ucf54\ub371 \uc790\ub3d9 \uc124\uc815", url: "#5", children: [
          ]},
          {title: "6. \ucee8\ud14c\uc774\ub108 \ud3ec\ub9f7\uacfc \ucf54\ub371\uc758 \ucc28\uc774", url: "#6", children: [
          ]},
          {title: "7. \ud2b9\uc815 \ud3ec\ub9f7\uc5d0 \ub9de\ub294 \uc635\uc158", url: "#7", children: [
          ]},
          {title: "8. \uba40\ud2f0\ud50c\ub809\uc2f1(Muxing)\uacfc \ub514\uba40\ud2f0\ud50c\ub809\uc2f1(Demuxing)", url: "#8-muxing-demuxing", children: [
          ]},
          {title: "9. \ucee4\uc2a4\ud140 \ud3ec\ub9f7 \uc124\uc815", url: "#9", children: [
          ]},
          {title: "10. \uc790\ub9c9 \uc2a4\ud2b8\ub9bc \ucc98\ub9ac", url: "#10", children: [
          ]},
          {title: "11. \uc2a4\ud2b8\ub9ac\ubc0d\uc744 \uc704\ud55c \ud3ec\ub9f7 \uc124\uc815", url: "#11", children: [
          ]},
          {title: "12. \ud3ec\ub9f7\ubcc4 \ud2b9\uc218 \uc635\uc158", url: "#12", children: [
          ]},
          {title: "13. \ud3ec\ub9f7 \uc790\ub3d9 \uac10\uc9c0", url: "#13", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../A006/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../A006/" class="btn btn-xs btn-link">
        비디오 포맷 변환
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../A004/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../A004/" class="btn btn-xs btn-link">
        입력 파일 처리
      </a>
    </div>
    
  </div>

    

    <p>FFmpeg에서 출력 파일의 포맷을 설정하는 것은 매우 중요한 작업이다. 다양한 미디어 파일을 처리하는 FFmpeg는 여러 포맷을 지원하며, 이를 정확히 설정함으로써 원하는 결과물을 얻을 수 있다.</p>
<h3 id="1">1. 파일 포맷이란</h3>
<p>파일 포맷(file format)은 미디어 파일의 구조를 정의하는 규격을 말한다. 비디오, 오디오, 자막 등의 데이터를 어떻게 저장하고 읽어올지 결정하는 역할을 한다. 예를 들어, .mp4, .avi, .mkv, .mp3 등이 흔히 사용되는 포맷이다.</p>
<h3 id="2-ffmpeg">2. FFmpeg에서 지원하는 주요 파일 포맷</h3>
<p>FFmpeg은 다양한 파일 포맷을 지원한다. 그 중에서 가장 흔히 사용되는 포맷은 다음과 같다.</p>
<ul>
<li><strong>MP4</strong>: MPEG-4 Part 14 표준으로, 주로 비디오를 위한 컨테이너 포맷이다. 효율적인 압축을 제공하며, 다양한 비디오 코덱을 지원한다.</li>
<li><strong>AVI</strong>: 오래된 비디오 파일 포맷으로, Microsoft에서 개발하였다. 여러 코덱을 지원하지만, 압축 효율이 좋지 않은 경우가 많다.</li>
<li><strong>MKV</strong>: Matroska 포맷으로, 다중 트랙을 지원하며 고화질 비디오 저장에 많이 사용된다.</li>
<li><strong>MP3</strong>: 주로 오디오 파일을 위한 포맷으로, 높은 압축률과 낮은 품질 손실이 특징이다.</li>
</ul>
<h3 id="3">3. 출력 포맷 설정하기</h3>
<p>FFmpeg에서 출력 파일의 포맷을 설정하는 방법은 매우 간단한다. 출력 파일의 확장자에 따라 자동으로 포맷이 설정되기도 하지만, 명시적으로 포맷을 설정하려면 <code>-f</code> 옵션을 사용한다.</p>
<p>예를 들어, MP4 포맷으로 변환하려면 다음과 같이 명령을 실행할 수 있다.</p>
<pre><code class="language-bash">ffmpeg -i input.avi -f mp4 output.mp4
</code></pre>
<p>여기서 <code>-f mp4</code>는 출력 파일을 MP4 포맷으로 설정하는 부분이다. 만약 확장자와 다르게 포맷을 지정하고자 한다면 이 옵션이 필요하다.</p>
<h3 id="4">4. 포맷 선택 기준</h3>
<p>출력 포맷을 선택할 때 고려해야 할 주요 요소는 다음과 같다.</p>
<ul>
<li><strong>비디오 코덱과의 호환성</strong>: 특정 파일 포맷은 특정 비디오 코덱과 더 잘 어울린다. 예를 들어, MP4는 H.264 코덱과 자주 함께 사용된다.</li>
<li><strong>압축 효율</strong>: 파일 크기와 품질 간의 균형을 맞춰야 한다. 예를 들어, MKV는 무손실 비디오 저장에 적합하지만, 파일 크기가 커질 수 있다.</li>
<li><strong>플레이어 호환성</strong>: 모든 기기에서 동일한 포맷을 지원하지 않을 수 있으므로, 출력 포맷이 대상 기기에서 지원되는지 확인해야 한다.</li>
</ul>
<h3 id="5">5. 포맷에 따른 코덱 자동 설정</h3>
<p>FFmpeg에서 파일 포맷을 설정하면, 자동으로 그에 맞는 기본 코덱이 선택된다. 예를 들어, <code>-f mp4</code>로 설정하면 기본적으로 H.264 비디오 코덱과 AAC 오디오 코덱이 선택된다.</p>
<pre><code class="language-bash">ffmpeg -i input.avi -f mp4 -vcodec libx264 -acodec aac output.mp4
</code></pre>
<p>이 명령은 명시적으로 비디오 코덱을 <code>libx264</code>로, 오디오 코덱을 <code>aac</code>로 설정하는 방법을 보여준다. 만약 자동 설정된 코덱을 변경하고 싶다면 이렇게 명시적으로 코덱을 지정해야 한다.</p>
<h3 id="6">6. 컨테이너 포맷과 코덱의 차이</h3>
<p>컨테이너 포맷(container format)과 코덱(codec)은 서로 다른 개념이다. 컨테이너 포맷은 파일의 구조를 정의하는 반면, 코덱은 데이터의 압축 및 인코딩 방법을 결정한다. 같은 컨테이너 포맷이라도 서로 다른 코덱을 사용할 수 있다.</p>
<p>예를 들어, MP4 파일은 H.264, H.265 등 다양한 비디오 코덱을 사용할 수 있으며, 오디오 코덱으로는 AAC, MP3 등이 가능한다. 다음 표는 일부 컨테이너 포맷과 지원되는 주요 코덱들을 나타낸다.</p>
<table>
<thead>
<tr>
<th>컨테이너 포맷</th>
<th>비디오 코덱</th>
<th>오디오 코덱</th>
</tr>
</thead>
<tbody>
<tr>
<td>MP4</td>
<td>H.264, H.265, MPEG-4</td>
<td>AAC, MP3</td>
</tr>
<tr>
<td>MKV</td>
<td>H.264, H.265, VP8, VP9</td>
<td>AAC, MP3, Opus</td>
</tr>
<tr>
<td>AVI</td>
<td>H.264, MPEG-4</td>
<td>MP3, PCM</td>
</tr>
<tr>
<td>MOV</td>
<td>H.264, ProRes</td>
<td>AAC, ALAC</td>
</tr>
</tbody>
</table>
<p>컨테이너 포맷에 적합한 코덱을 선택하지 않으면 파일이 제대로 재생되지 않을 수 있다. FFmpeg에서 이를 제어할 수 있는 옵션은 <code>-vcodec</code>(비디오 코덱), <code>-acodec</code>(오디오 코덱)이다.</p>
<h3 id="7">7. 특정 포맷에 맞는 옵션</h3>
<p>특정 포맷을 사용할 때는 그 포맷에 맞는 세부 옵션들을 설정해야 할 수 있다. 예를 들어, MKV 포맷에서는 자막 트랙을 추가하거나, MP4 포맷에서는 특정 스트림을 준비하는 등의 작업이 필요할 수 있다.</p>
<ul>
<li><strong>MKV 포맷의 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -f matroska -c:v copy -c:a copy -c:s mov_text output.mkv
</code></pre>
<p>이 명령은 자막을 포함한 MP4 파일을 MKV 포맷으로 변환하는 예시이다. 여기서 <code>-c:v copy</code>, <code>-c:a copy</code>는 비디오와 오디오 스트림을 그대로 복사하는 것을 의미하며, <code>-c:s mov_text</code>는 자막을 변환하는 방법을 지정한다.</p>
<ul>
<li><strong>MP4 포맷의 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mkv -f mp4 -c:v libx264 -movflags faststart output.mp4
</code></pre>
<p><code>-movflags faststart</code> 옵션은 MP4 파일의 헤더를 파일의 시작 부분에 위치시키는 역할을 한다. 이 옵션은 스트리밍 환경에서 파일을 빠르게 시작할 수 있게 도와준다.</p>
<h3 id="8-muxing-demuxing">8. 멀티플렉싱(Muxing)과 디멀티플렉싱(Demuxing)</h3>
<p>멀티플렉싱(muxing)은 여러 미디어 스트림(비디오, 오디오, 자막 등)을 하나의 파일에 결합하는 과정이다. 반대로 디멀티플렉싱(demuxing)은 이러한 스트림을 분리하는 작업이다. FFmpeg에서는 <code>-f</code> 옵션으로 파일 포맷을 설정하여 멀티플렉싱을 제어할 수 있다.</p>
<ul>
<li><strong>비디오와 오디오를 함께 멀티플렉싱하는 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i video.mp4 -i audio.mp3 -f mp4 output.mp4
</code></pre>
<p>이 명령은 <code>video.mp4</code> 파일의 비디오 스트림과 <code>audio.mp3</code> 파일의 오디오 스트림을 결합하여 <code>output.mp4</code> 파일을 생성하는 예시이다.</p>
<ul>
<li><strong>비디오에서 오디오를 디멀티플렉싱하는 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -vn -acodec copy output.aac
</code></pre>
<p>여기서 <code>-vn</code> 옵션은 비디오를 제외하고 오디오만 추출하는 옵션이다. 이 명령은 <code>input.mp4</code> 파일에서 오디오 스트림만 추출하여 <code>output.aac</code> 파일로 저장한다.</p>
<h3 id="9">9. 커스텀 포맷 설정</h3>
<p>FFmpeg은 기존에 정의된 포맷 외에도 사용자가 커스텀 포맷을 정의하여 사용할 수 있다. 이를 위해서는 각 스트림의 코덱을 명확히 설정하고, 포맷이 요구하는 세부 사항들을 맞춰야 한다.</p>
<p>예를 들어, 오디오 스트림을 특정 비트레이트로 인코딩하면서 특정 파일 포맷을 지정할 수 있다.</p>
<pre><code class="language-bash">ffmpeg -i input.wav -f mp3 -b:a 192k output.mp3
</code></pre>
<p>이 명령에서 <code>-b:a 192k</code>는 오디오 스트림을 192kbps의 비트레이트로 설정하여 MP3 파일을 생성하는 방법을 보여준다. </p>
<h3 id="10">10. 자막 스트림 처리</h3>
<p>출력 파일에 자막 스트림을 추가하거나 변환하는 것도 FFmpeg에서 가능하며, 자막 파일을 별도로 인코딩하거나 비디오 파일에 직접 병합할 수 있다. FFmpeg는 여러 자막 포맷을 지원하며, 자막을 비디오와 함께 컨테이너에 포함시키거나, 비디오에 하드코딩할 수 있다.</p>
<ul>
<li><strong>자막을 비디오와 함께 컨테이너에 포함시키는 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -i subtitles.srt -c:v copy -c:a copy -c:s mov_text output.mp4
</code></pre>
<p>여기서 <code>-c:s mov_text</code> 옵션은 자막을 MP4 포맷에 맞는 텍스트 자막 포맷으로 변환하는 옵션이다.</p>
<ul>
<li><strong>비디오에 자막을 하드코딩하는 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -vf subtitles=subtitles.srt output.mp4
</code></pre>
<p>위 명령은 자막을 비디오 스트림에 직접 하드코딩하여 자막이 비디오의 일부로 변환되도록 설정한다. 자막이 하드코딩되면, 비디오 재생 중 자막을 끄거나 켜는 것이 불가능한다.</p>
<h3 id="11">11. 스트리밍을 위한 포맷 설정</h3>
<p>FFmpeg은 라이브 스트리밍을 위한 다양한 포맷도 지원한다. 스트리밍은 일반 파일 포맷과는 달리, 실시간으로 데이터를 전송하는 것이 중요하다. 흔히 사용되는 스트리밍 포맷으로는 RTMP, HTTP, HLS, MPEG-DASH 등이 있다.</p>
<ul>
<li><strong>RTMP 스트리밍 설정 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -f flv rtmp://streaming-server/app/stream_key
</code></pre>
<p>이 명령은 RTMP 서버로 비디오를 실시간 전송하기 위해 사용된다. <code>-f flv</code>는 스트리밍용으로 사용되는 포맷 중 하나인 FLV 포맷을 설정하는 부분이다. FLV는 스트리밍에 적합한 포맷 중 하나로, RTMP 서버와 자주 사용된다.</p>
<ul>
<li><strong>HTTP 스트리밍 설정 예시</strong>:</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -f mpegts http://localhost:8080
</code></pre>
<p>HTTP 스트리밍을 위해 FFmpeg에서는 <code>mpegts</code> 포맷을 사용할 수 있다. 이 명령은 로컬 서버에서 HTTP 스트리밍을 수행하는 예시이다.</p>
<h3 id="12">12. 포맷별 특수 옵션</h3>
<p>일부 포맷은 고유의 특수 옵션을 가지고 있으며, 이를 활용하면 보다 정교하게 출력 파일을 설정할 수 있다.</p>
<ul>
<li>
<p><strong>MP4에서 <code>-movflags faststart</code></strong>: 앞서 언급한 바와 같이, 이 옵션은 MP4 파일의 헤더를 파일의 시작 부분에 위치시키는 역할을 한다. 이를 통해 스트리밍 환경에서 파일이 빠르게 로드될 수 있다.</p>
</li>
<li>
<p><strong>MKV에서 <code>-compression_level</code></strong>: MKV 포맷은 다양한 압축 레벨을 설정할 수 있는 옵션을 제공한다. 예를 들어, 다음과 같이 압축 레벨을 설정할 수 있다.</p>
</li>
</ul>
<pre><code class="language-bash">ffmpeg -i input.mp4 -f matroska -compression_level 6 output.mkv
</code></pre>
<p>여기서 압축 레벨은 0에서 9까지 설정할 수 있으며, 숫자가 클수록 더 높은 압축을 의미한다.</p>
<ul>
<li><strong>MPEG-TS에서 <code>-mpegts_flags resync</code></strong>: MPEG-TS 포맷을 사용할 때 <code>-mpegts_flags resync</code> 옵션은 손상된 스트림을 복구하려고 시도하는 옵션이다. 주로 실시간 스트리밍에서 네트워크 오류로 인한 스트림 손상을 방지하는 데 사용된다.</li>
</ul>
<h3 id="13">13. 포맷 자동 감지</h3>
<p>FFmpeg은 입력 파일의 확장자나 내부 메타데이터를 분석하여 자동으로 파일 포맷을 감지할 수 있다. 그러나 때때로 이러한 자동 감지가 잘못될 수 있으며, 이 경우 명시적으로 포맷을 지정하는 것이 필요하다.</p>
<pre><code class="language-bash">ffmpeg -i input.unknown -f mp4 output.mp4
</code></pre>
<p>여기서 <code>input.unknown</code>은 확장자가 없는 파일로, FFmpeg이 자동으로 파일 포맷을 감지할 수 없는 경우이다. 이때 <code>-f mp4</code>를 사용하여 FFmpeg에 포맷을 명시적으로 지정한다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../A006/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../A006/" class="btn btn-xs btn-link">
        비디오 포맷 변환
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../A004/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../A004/" class="btn btn-xs btn-link">
        입력 파일 처리
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>