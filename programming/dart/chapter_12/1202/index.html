<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/programming/dart/chapter_12/1202/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>JSON 데이터 처리 - 소프트웨어 융합</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "1. JSON\uc758 \uae30\ubcf8 \uad6c\uc870", url: "#_top", children: [
          ]},
          {title: "2. Dart\uc5d0\uc11c JSON \ub370\uc774\ud130 \ucc98\ub9ac", url: "#2-dart-json", children: [
              {title: "2.1 \uc5ed\uc9c1\ub82c\ud654 (JSON -\u0026gt; Dart \uac1d\uccb4)", url: "#21-json-dart" },
              {title: "2.2 \uc9c1\ub82c\ud654 (Dart \uac1d\uccb4 -\u0026gt; JSON)", url: "#22-dart-json" },
          ]},
          {title: "3. \uc911\ucca9\ub41c JSON \ub370\uc774\ud130 \ucc98\ub9ac", url: "#3-json", children: [
          ]},
          {title: "4. JSON \ubc30\uc5f4 \ucc98\ub9ac", url: "#4-json", children: [
          ]},
          {title: "5. JSON \ub370\uc774\ud130\uc640 Dart \ud074\ub798\uc2a4 \uac04\uc758 \ubcc0\ud658", url: "#5-json-dart", children: [
              {title: "5.1 JSON -\u0026gt; Dart \ud074\ub798\uc2a4", url: "#51-json-dart" },
              {title: "5.2 Dart \ud074\ub798\uc2a4 -\u0026gt; JSON", url: "#52-dart-json" },
          ]},
          {title: "6. \uc911\ucca9\ub41c \ud074\ub798\uc2a4\uc640 JSON \ucc98\ub9ac", url: "#6-json", children: [
          ]},
          {title: "7. JSON \ub370\uc774\ud130\uc758 \uc720\ud6a8\uc131 \uac80\uc99d", url: "#7-json", children: [
              {title: "7.1 \ud544\uc218 \ud544\ub4dc \uac80\uc99d", url: "#71" },
              {title: "7.2 \ub370\uc774\ud130 \ud0c0\uc785 \uac80\uc99d", url: "#72" },
          ]},
          {title: "8. JSON \uc9c1\ub82c\ud654\uc640 \uc5ed\uc9c1\ub82c\ud654\uc758 \uc131\ub2a5 \uace0\ub824", url: "#8-json", children: [
              {title: "8.1 JSON \ub370\uc774\ud130 \uc555\ucd95", url: "#81-json" },
              {title: "8.2 \ube44\ub3d9\uae30 JSON \ucc98\ub9ac", url: "#82-json" },
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1203/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1203/" class="btn btn-xs btn-link">
        WebSocket 통신
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1201/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1201/" class="btn btn-xs btn-link">
        HTTP 요청 보내기
      </a>
    </div>
    
  </div>

    

    <p>JSON(JavaScript Object Notation)은 Dart에서 비동기식 데이터 처리나 HTTP 통신에서 자주 사용되는 형식이다. 이 섹션에서는 JSON 데이터의 구조, 처리 방식, 그리고 Dart에서 JSON 데이터를 활용하는 방법에 대해 다룬다. 또한, JSON 데이터를 변환하고, 직렬화 및 역직렬화를 통해 Dart 객체와 JSON 간의 상호 변환하는 방법을 설명한다.</p>
<h3 id="1-json">1. JSON의 기본 구조</h3>
<p>JSON은 데이터를 키-값 쌍으로 저장하는 경량 데이터 형식으로, 다음과 같은 기본 형식을 갖는다:</p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;John&quot;,
  &quot;age&quot;: 30,
  &quot;city&quot;: &quot;New York&quot;
}
</code></pre>
<p>Dart에서는 JSON 데이터를 주로 문자열로 취급하며, JSON 데이터를 객체로 변환하거나 객체를 JSON으로 변환하는 과정을 제공한다.</p>
<h3 id="2-dart-json">2. Dart에서 JSON 데이터 처리</h3>
<p>Dart에서 JSON 데이터를 처리할 때는 주로 <code>dart:convert</code> 라이브러리를 사용한다. 이 라이브러리는 JSON을 직렬화(객체 -&gt; JSON) 및 역직렬화(JSON -&gt; 객체)하는 기능을 제공한다.</p>
<h4 id="21-json-dart">2.1 역직렬화 (JSON -&gt; Dart 객체)</h4>
<p>JSON 문자열을 Dart 객체로 변환하려면 <code>jsonDecode</code> 함수를 사용한다. 예를 들어, 아래 JSON 문자열을 Dart 객체로 변환하는 코드를 살펴보자:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  String jsonString = '{&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30, &quot;city&quot;: &quot;New York&quot;}';
  Map&lt;String, dynamic&gt; user = jsonDecode(jsonString);

  print('Name: ${user['name']}');
  print('Age: ${user['age']}');
  print('City: ${user['city']}');
}
</code></pre>
<p>위 코드에서 JSON 문자열 <code>jsonString</code>이 <code>jsonDecode</code> 함수를 통해 Dart의 <code>Map&lt;String, dynamic&gt;</code> 객체로 변환되었다. 여기서 <code>dynamic</code> 타입은 JSON의 값이 다양한 형태(숫자, 문자열, 객체 등)를 가질 수 있음을 의미한다.</p>
<h4 id="22-dart-json">2.2 직렬화 (Dart 객체 -&gt; JSON)</h4>
<p>반대로, Dart 객체를 JSON 문자열로 변환하려면 <code>jsonEncode</code> 함수를 사용한다. 예를 들어, 아래 Dart 객체를 JSON 문자열로 변환하는 코드를 보겠다:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  Map&lt;String, dynamic&gt; user = {
    'name': 'John',
    'age': 30,
    'city': 'New York'
  };

  String jsonString = jsonEncode(user);

  print(jsonString);
}
</code></pre>
<p>이 코드에서는 <code>Map</code> 객체가 <code>jsonEncode</code> 함수를 통해 JSON 문자열로 변환되었다.</p>
<h3 id="3-json">3. 중첩된 JSON 데이터 처리</h3>
<p>때때로 JSON 데이터는 중첩된 형태로 나타난다. 즉, JSON 데이터 내에 또 다른 JSON 객체가 포함된 경우이다. 예를 들어, 아래와 같은 구조를 갖는 JSON을 처리할 수 있다:</p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;John&quot;,
  &quot;age&quot;: 30,
  &quot;address&quot;: {
    &quot;city&quot;: &quot;New York&quot;,
    &quot;zipcode&quot;: &quot;10001&quot;
  }
}
</code></pre>
<p>이 경우 Dart에서 JSON 데이터를 처리하는 방식은 동일하며, 중첩된 데이터를 접근할 때는 키를 체인 방식으로 사용한다. 아래 예제를 살펴보자:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  String jsonString = '''
  {
    &quot;name&quot;: &quot;John&quot;,
    &quot;age&quot;: 30,
    &quot;address&quot;: {
      &quot;city&quot;: &quot;New York&quot;,
      &quot;zipcode&quot;: &quot;10001&quot;
    }
  }
  ''';

  Map&lt;String, dynamic&gt; user = jsonDecode(jsonString);

  print('City: ${user['address']['city']}');
  print('Zipcode: ${user['address']['zipcode']}');
}
</code></pre>
<p>위 코드에서 중첩된 <code>address</code> 객체의 <code>city</code>와 <code>zipcode</code>에 접근하기 위해, <code>user['address']['city']</code>와 같은 방식으로 키 체인을 사용하였다.</p>
<h3 id="4-json">4. JSON 배열 처리</h3>
<p>JSON 데이터는 배열 형태로 나타날 수도 있다. 예를 들어, 사용자가 여러 명인 경우 다음과 같은 JSON 데이터가 있을 수 있다:</p>
<pre><code class="language-json">[
  {
    &quot;name&quot;: &quot;John&quot;,
    &quot;age&quot;: 30
  },
  {
    &quot;name&quot;: &quot;Jane&quot;,
    &quot;age&quot;: 25
  }
]
</code></pre>
<p>이 경우, Dart에서는 JSON 배열을 <code>List</code> 객체로 변환할 수 있으며, 각 요소는 <code>Map</code>으로 처리된다. 예를 들어, 아래와 같이 JSON 배열 데이터를 처리할 수 있다:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  String jsonString = '''
  [
    {&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30},
    {&quot;name&quot;: &quot;Jane&quot;, &quot;age&quot;: 25}
  ]
  ''';

  List&lt;dynamic&gt; users = jsonDecode(jsonString);

  for (var user in users) {
    print('Name: ${user['name']}, Age:${user['age']}');
  }
}
</code></pre>
<p>위 코드에서는 JSON 배열을 <code>jsonDecode</code> 함수를 통해 <code>List</code>로 변환하였으며, 각 <code>user</code> 객체에 반복문을 사용해 접근하고 있다.</p>
<h3 id="5-json-dart">5. JSON 데이터와 Dart 클래스 간의 변환</h3>
<p>Dart에서 JSON 데이터를 처리할 때, 일반적으로는 <code>Map</code> 객체를 사용하지만, 더 복잡한 구조의 데이터를 다룰 때는 Dart 클래스로 변환하는 것이 유용하다. 이 과정에서는 JSON 데이터를 Dart 클래스의 인스턴스로 역직렬화하거나, Dart 클래스의 인스턴스를 JSON으로 직렬화하는 방법이 필요하다.</p>
<h4 id="51-json-dart">5.1 JSON -&gt; Dart 클래스</h4>
<p>우선 JSON 데이터를 Dart 클래스의 인스턴스로 변환하는 방법을 알아보겠다. 예를 들어, 다음과 같은 <code>User</code> 클래스를 정의하고 JSON 데이터를 이를 바탕으로 처리할 수 있다:</p>
<pre><code class="language-dart">class User {
  String name;
  int age;
  String city;

  User({required this.name, required this.age, required this.city});

  factory User.fromJson(Map&lt;String, dynamic&gt; json) {
    return User(
      name: json['name'],
      age: json['age'],
      city: json['city']
    );
  }
}
</code></pre>
<p>여기서 <code>fromJson</code>이라는 팩토리 생성자를 사용하여 JSON 데이터를 Dart 객체로 변환한다. 다음은 JSON 문자열을 <code>User</code> 객체로 변환하는 예제이다:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  String jsonString = '{&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30, &quot;city&quot;: &quot;New York&quot;}';
  Map&lt;String, dynamic&gt; json = jsonDecode(jsonString);

  User user = User.fromJson(json);

  print('Name: ${user.name}, Age:${user.age}, City: ${user.city}');
}
</code></pre>
<p>이 코드는 JSON 데이터를 <code>User</code> 객체로 변환한 후, 각 필드를 출력한다.</p>
<h4 id="52-dart-json">5.2 Dart 클래스 -&gt; JSON</h4>
<p>반대로 Dart 객체를 JSON으로 변환하려면, 클래스에 <code>toJson</code> 메소드를 추가해야 한다. 아래는 <code>User</code> 클래스에 <code>toJson</code> 메소드를 추가한 예제이다:</p>
<pre><code class="language-dart">class User {
  String name;
  int age;
  String city;

  User({required this.name, required this.age, required this.city});

  factory User.fromJson(Map&lt;String, dynamic&gt; json) {
    return User(
      name: json['name'],
      age: json['age'],
      city: json['city']
    );
  }

  Map&lt;String, dynamic&gt; toJson() {
    return {
      'name': name,
      'age': age,
      'city': city
    };
  }
}
</code></pre>
<p><code>toJson</code> 메소드는 Dart 객체를 JSON으로 변환할 때 사용된다. 이제 <code>User</code> 객체를 JSON으로 변환하는 예제를 살펴보자:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  User user = User(name: 'John', age: 30, city: 'New York');
  String jsonString = jsonEncode(user.toJson());

  print(jsonString);
}
</code></pre>
<p>이 코드에서 <code>User</code> 객체는 <code>toJson</code> 메소드를 통해 <code>Map</code>으로 변환된 후, <code>jsonEncode</code> 함수를 사용하여 JSON 문자열로 직렬화된다.</p>
<h3 id="6-json">6. 중첩된 클래스와 JSON 처리</h3>
<p>중첩된 JSON 데이터를 다룰 때, 클래스 내에 또 다른 클래스를 정의해야 한다. 예를 들어, 사용자 정보에 주소를 포함하는 경우, <code>Address</code> 클래스를 별도로 정의하고 <code>User</code> 클래스 내에 이를 포함시킬 수 있다.</p>
<pre><code class="language-dart">class Address {
  String city;
  String zipcode;

  Address({required this.city, required this.zipcode});

  factory Address.fromJson(Map&lt;String, dynamic&gt; json) {
    return Address(
      city: json['city'],
      zipcode: json['zipcode']
    );
  }

  Map&lt;String, dynamic&gt; toJson() {
    return {
      'city': city,
      'zipcode': zipcode
    };
  }
}

class User {
  String name;
  int age;
  Address address;

  User({required this.name, required this.age, required this.address});

  factory User.fromJson(Map&lt;String, dynamic&gt; json) {
    return User(
      name: json['name'],
      age: json['age'],
      address: Address.fromJson(json['address'])
    );
  }

  Map&lt;String, dynamic&gt; toJson() {
    return {
      'name': name,
      'age': age,
      'address': address.toJson()
    };
  }
}
</code></pre>
<p>이제 중첩된 JSON 데이터를 Dart 클래스 객체로 변환하고, 다시 JSON으로 직렬화할 수 있다. 아래 예제를 보겠다:</p>
<pre><code class="language-dart">import 'dart:convert';

void main() {
  String jsonString = '''
  {
    &quot;name&quot;: &quot;John&quot;,
    &quot;age&quot;: 30,
    &quot;address&quot;: {
      &quot;city&quot;: &quot;New York&quot;,
      &quot;zipcode&quot;: &quot;10001&quot;
    }
  }
  ''';

  // JSON을 User 객체로 변환
  Map&lt;String, dynamic&gt; json = jsonDecode(jsonString);
  User user = User.fromJson(json);

  // 변환된 User 객체 출력
  print('Name: ${user.name}, Age:${user.age}, City: ${user.address.city}, Zipcode:${user.address.zipcode}');

  // User 객체를 JSON으로 직렬화
  String jsonStringFromUser = jsonEncode(user.toJson());
  print(jsonStringFromUser);
}
</code></pre>
<p>위 예제에서는 중첩된 <code>Address</code> 객체를 포함한 <code>User</code> 객체를 생성하고, 이를 JSON으로 변환하는 과정을 확인할 수 있다.</p>
<h3 id="7-json">7. JSON 데이터의 유효성 검증</h3>
<p>JSON 데이터를 처리할 때, 데이터의 유효성을 검증하는 것이 중요하다. 특히 외부에서 전달되는 JSON 데이터는 예상하지 못한 값이나 구조를 가질 수 있으므로, Dart 코드에서 이를 처리할 수 있는 예외 처리가 필요하다.</p>
<h4 id="71">7.1 필수 필드 검증</h4>
<p>Dart에서는 JSON 데이터에서 특정 필드가 존재하는지 여부를 검사할 수 있다. 아래는 특정 필드가 존재하지 않을 경우 예외를 던지는 예제이다:</p>
<pre><code class="language-dart">import 'dart:convert';

class User {
  String name;
  int age;

  User({required this.name, required this.age});

  factory User.fromJson(Map&lt;String, dynamic&gt; json) {
    if (!json.containsKey('name') || !json.containsKey('age')) {
      throw FormatException('Missing required fields: name or age');
    }
    return User(
      name: json['name'],
      age: json['age']
    );
  }
}

void main() {
  String jsonString = '{&quot;name&quot;: &quot;John&quot;}'; // age 필드가 없음

  try {
    Map&lt;String, dynamic&gt; json = jsonDecode(jsonString);
    User user = User.fromJson(json);
  } catch (e) {
    print('Error: $e');
  }
}
</code></pre>
<p>위 코드는 <code>name</code>과 <code>age</code> 필드가 모두 존재하는지 확인하며, 만약 해당 필드가 없다면 <code>FormatException</code>을 던진다. <code>age</code> 필드가 없으므로, 예외가 발생하여 오류 메시지가 출력된다.</p>
<h4 id="72">7.2 데이터 타입 검증</h4>
<p>JSON 데이터의 필드가 예상한 데이터 타입인지 확인하는 것도 중요하다. Dart에서는 <code>is</code> 연산자를 사용하여 데이터 타입을 확인할 수 있다. 아래는 JSON 필드가 예상한 데이터 타입이 아닐 경우 예외를 던지는 예제이다:</p>
<pre><code class="language-dart">import 'dart:convert';

class User {
  String name;
  int age;

  User({required this.name, required this.age});

  factory User.fromJson(Map&lt;String, dynamic&gt; json) {
    if (!json.containsKey('name') || !json.containsKey('age')) {
      throw FormatException('Missing required fields: name or age');
    }

    if (json['name'] is! String || json['age'] is! int) {
      throw FormatException('Invalid data types for fields: name or age');
    }

    return User(
      name: json['name'],
      age: json['age']
    );
  }
}

void main() {
  String jsonString = '{&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: &quot;thirty&quot;}'; // age의 타입이 잘못됨

  try {
    Map&lt;String, dynamic&gt; json = jsonDecode(jsonString);
    User user = User.fromJson(json);
  } catch (e) {
    print('Error: $e');
  }
}
</code></pre>
<p>이 예제에서는 <code>name</code> 필드가 문자열인지, <code>age</code> 필드가 정수인지 확인하며, 예상한 타입이 아닌 경우 <code>FormatException</code>을 던진다. JSON의 <code>age</code> 값이 문자열이므로, 예외가 발생하여 오류 메시지가 출력된다.</p>
<h3 id="8-json">8. JSON 직렬화와 역직렬화의 성능 고려</h3>
<p>Dart에서 JSON 데이터를 직렬화 및 역직렬화하는 작업은 빈번하게 사용되지만, 성능을 고려한 최적화가 필요할 때도 있다. 특히 대용량 JSON 데이터를 다룰 때, 데이터 크기와 처리 시간에 대한 고려가 필요하다.</p>
<h4 id="81-json">8.1 JSON 데이터 압축</h4>
<p>JSON 데이터의 크기를 줄이기 위해 압축 기법을 사용할 수 있다. Dart에서는 <code>dart:convert</code>의 <code>gzip</code> 함수를 사용하여 데이터를 압축하거나, <code>jsonEncode</code> 결과를 압축할 수 있다. 예를 들어, 아래와 같이 JSON 데이터를 gzip으로 압축할 수 있다:</p>
<pre><code class="language-dart">import 'dart:convert';
import 'dart:io';

void main() {
  Map&lt;String, dynamic&gt; data = {
    'name': 'John',
    'age': 30,
    'city': 'New York'
  };

  // JSON 직렬화
  String jsonString = jsonEncode(data);

  // gzip으로 압축
  List&lt;int&gt; compressed = gzip.encode(utf8.encode(jsonString));

  print('Compressed size: ${compressed.length} bytes');
}
</code></pre>
<p>압축된 데이터는 네트워크 전송 시 데이터 크기를 줄일 수 있어 성능 최적화에 기여할 수 있다.</p>
<h4 id="82-json">8.2 비동기 JSON 처리</h4>
<p>Dart의 비동기 처리 기능을 활용하면, 대규모 JSON 데이터를 처리할 때도 메인 스레드의 성능에 영향을 주지 않도록 할 수 있다. Dart에서는 <code>Future</code>와 <code>async/await</code>를 사용하여 비동기식으로 JSON 데이터를 처리할 수 있다.</p>
<pre><code class="language-dart">import 'dart:convert';
import 'dart:io';

Future&lt;void&gt; main() async {
  // 대규모 JSON 파일 읽기
  File file = File('large_data.json');
  Stream&lt;List&lt;int&gt;&gt; inputStream = file.openRead();

  // JSON 데이터를 비동기적으로 디코딩
  await for (var chunk in inputStream.transform(utf8.decoder).transform(json.decoder)) {
    print(chunk);
  }
}
</code></pre>
<p>이 예제에서는 대규모 JSON 파일을 비동기적으로 읽고 처리하여, 대용량 데이터를 다룰 때 메모리 사용량을 최소화하고 성능을 유지할 수 있다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1203/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1203/" class="btn btn-xs btn-link">
        WebSocket 통신
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1201/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1201/" class="btn btn-xs btn-link">
        HTTP 요청 보내기
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>