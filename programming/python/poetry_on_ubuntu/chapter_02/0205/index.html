<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/programming/python/poetry_on_ubuntu/chapter_02/0205/">
    <link rel="shortcut icon" href="../../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Python 버전과 호환성 관리 - 실험 도서관</title>
    <link href="../../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../../css/highlight.css">
    <link href="../../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "pyproject.toml \ud30c\uc77c\uc5d0\uc11c Python \ubc84\uc804 \uc124\uc815", url: "#_top", children: [
          ]},
          {title: "Python \ubc84\uc804 \ubc94\uc704 \uc124\uc815", url: "#python", children: [
          ]},
          {title: "\ub2e4\uc591\ud55c Python \ubc84\uc804 \ud14c\uc2a4\ud2b8", url: "#python_1", children: [
          ]},
          {title: "\ud2b9\uc815 Python \ubc84\uc804\uc5d0\uc11c\ub9cc \uc2e4\ud589 \uc81c\ud55c\ud558\uae30", url: "#python_2", children: [
          ]},
          {title: "Python \ubc84\uc804 \ud638\ud658\uc131 \ucda9\ub3cc \ud574\uacb0", url: "#python_3", children: [
          ]},
          {title: "Python \ubc84\uc804 \uad00\ub9ac \ub3c4\uad6c\uc640\uc758 \ud1b5\ud569", url: "#python_4", children: [
          ]},
          {title: "\ub2e4\uc911 Python \ubc84\uc804 \ud504\ub85c\uc81d\ud2b8 \uad00\ub9ac", url: "#python_5", children: [
          ]},
          {title: "Python \ubc84\uc804 \ud638\ud658\uc131 \ubb38\uc81c \ubc1c\uc0dd \uc2dc \ud574\uacb0 \ubc29\ubc95", url: "#python_6", children: [
          ]},
        ];

    </script>
    <script src="../../../../../js/base.js"></script>
      <script src="../../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../chapter_03/0301/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../chapter_03/0301/" class="btn btn-xs btn-link">
        새로운 Python 프로젝트 생성하기
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../0204/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../0204/" class="btn btn-xs btn-link">
        Poetry 설정 파일을 통한 프로젝트 초기화
      </a>
    </div>
    
  </div>

    

    <p>Poetry는 프로젝트의 Python 버전과 의존성을 쉽게 관리할 수 있도록 돕는 강력한 도구이다. 특히, Python의 다양한 버전에서 프로젝트가 원활히 작동하도록 하는 호환성 관리 기능이 매우 유용하다. 이 절에서는 Poetry를 사용하여 Python 버전 호환성을 어떻게 관리할 수 있는지에 대해 설명한다.</p>
<h3 id="pyprojecttoml-python">pyproject.toml 파일에서 Python 버전 설정</h3>
<p>Poetry는 <code>pyproject.toml</code> 파일을 통해 Python 버전 요구 사항을 지정한다. 이를 통해 특정 Python 버전에서만 프로젝트가 실행되도록 하거나, 여러 Python 버전을 지원하도록 설정할 수 있다.</p>
<p><code>pyproject.toml</code> 파일의 <code>[tool.poetry.dependencies]</code> 섹션에서 Python 버전 호환성을 설정한다. 다음은 예시이다.</p>
<pre><code class="language-toml">[tool.poetry.dependencies]
python = &quot;^3.8&quot;
</code></pre>
<p>위 코드는 Python 3.8 이상, 하지만 Python 4.0 미만의 버전을 요구한다는 의미이다. 이를 LaTeX 표기법으로 나타내면 다음과 같다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
3.8 \leq \text{Python version} &lt; 4.0
</div>
<script type="math/tex; mode=display">
3.8 \leq \text{Python version} < 4.0
</script>
</div>
<h3 id="python">Python 버전 범위 설정</h3>
<p>Poetry는 <code>^</code>, <code>~</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&lt;</code> 등의 연산자를 사용하여 Python 버전 범위를 설정할 수 있다. 각각의 연산자는 다음과 같이 동작한다.</p>
<ul>
<li><code>^3.8</code> : Python 3.8 이상 4.0 미만</li>
<li><code>~3.8</code> : Python 3.8 이상 3.9 미만</li>
<li><code>&gt;=3.7</code> : Python 3.7 이상</li>
<li><code>&lt;=3.9</code> : Python 3.9 이하</li>
</ul>
<p>예를 들어, 프로젝트가 Python 3.7 이상 3.9 이하의 버전에서 동작하도록 설정하려면 다음과 같이 작성할 수 있다.</p>
<pre><code class="language-toml">[tool.poetry.dependencies]
python = &quot;&gt;=3.7, &lt;=3.9&quot;
</code></pre>
<p>이는 다음의 수식으로 표현할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
3.7 \leq \text{Python version} \leq 3.9
</div>
<script type="math/tex; mode=display">
3.7 \leq \text{Python version} \leq 3.9
</script>
</div>
<p>이와 같이 버전 범위를 설정함으로써, 프로젝트가 다양한 Python 환경에서 안정적으로 동작할 수 있도록 제어할 수 있다.</p>
<h3 id="python_1">다양한 Python 버전 테스트</h3>
<p>프로젝트가 여러 버전의 Python을 지원하도록 설정했을 경우, 해당 버전들에서 프로젝트가 제대로 동작하는지 테스트하는 것이 중요하다. Poetry는 이를 위해 <code>tox</code>나 <code>nox</code>와 같은 도구와 연동하여 여러 Python 버전에서 테스트를 수행할 수 있다.</p>
<p>다음은 <code>tox</code>를 사용하는 예시이다. <code>tox</code> 설정 파일을 통해 여러 Python 버전에서 테스트를 진행할 수 있다.</p>
<pre><code class="language-ini">[tox]
envlist = py37, py38, py39

[testenv]
deps = pytest
commands = pytest
</code></pre>
<p>이를 실행하면 Python 3.7, 3.8, 3.9에서 각각 테스트가 수행된다.</p>
<h3 id="python_2">특정 Python 버전에서만 실행 제한하기</h3>
<p>때때로 프로젝트가 특정 Python 버전에서만 작동해야 하는 경우가 있다. 예를 들어, 새로운 문법이나 기능을 사용하는 경우, 지원되는 Python 버전 범위를 좁혀야 할 수 있다.</p>
<p>Poetry를 사용하면 <code>pyproject.toml</code> 파일에서 Python 버전을 제한하여 이러한 상황을 처리할 수 있다.</p>
<pre><code class="language-toml">[tool.poetry.dependencies]
python = &quot;&gt;=3.9&quot;
</code></pre>
<p>이는 Python 3.9 이상에서만 프로젝트가 실행되도록 제한하는 설정이다.</p>
<h3 id="python_3">Python 버전 호환성 충돌 해결</h3>
<p>프로젝트가 여러 의존성을 포함할 때, 일부 패키지가 특정 Python 버전에서만 작동하는 경우가 있다. 이때, Python 버전 간 호환성 문제를 해결하는 방법이 필요하다.</p>
<p>Poetry는 의존성 충돌을 방지하기 위해 각 패키지가 지원하는 Python 버전 범위를 확인하고, 이를 기반으로 설치 가능한 버전의 패키지를 선택한다. 예를 들어, 의존성 중 하나가 Python 3.8 이상에서만 동작하고, 다른 의존성이 Python 3.7 이하에서만 동작하는 경우, Poetry는 충돌을 감지하고 설치를 중단한다.</p>
<pre><code class="language-bash">poetry install
</code></pre>
<p>이 명령어를 실행하면, Poetry는 패키지 및 Python 버전 호환성을 확인하고 충돌이 발생하는 경우 이를 알려준다.</p>
<h3 id="python_4">Python 버전 관리 도구와의 통합</h3>
<p>Poetry는 Python 버전 관리 도구인 <code>pyenv</code>와의 통합도 지원한다. 이를 통해 Poetry는 <code>pyenv</code>에서 제공하는 Python 버전을 자동으로 감지하고 사용할 수 있다.</p>
<p>예를 들어, <code>pyenv</code>를 사용하여 Python 3.8.10을 설치한 후 해당 버전을 Poetry 프로젝트에서 사용하려면 다음과 같은 명령어를 실행한다.</p>
<pre><code class="language-bash">pyenv install 3.8.10
pyenv local 3.8.10
poetry env use 3.8.10
</code></pre>
<p>Poetry는 <code>pyenv</code>를 통해 설치된 Python 버전을 인식하고, 해당 버전을 기반으로 가상 환경을 구성한다.</p>
<h3 id="python_5">다중 Python 버전 프로젝트 관리</h3>
<p>프로젝트가 다중 Python 버전을 지원해야 할 경우, <code>tox</code>와 같은 도구 외에도 Poetry의 <code>env</code> 명령어를 사용하여 다중 Python 버전의 가상 환경을 관리할 수 있다. 예를 들어, Python 3.7, 3.8, 3.9 버전에서 각각의 가상 환경을 생성하고 관리할 수 있다.</p>
<pre><code class="language-bash">poetry env use 3.7
poetry env use 3.8
poetry env use 3.9
</code></pre>
<p>이 명령어를 통해 각 Python 버전에 맞는 가상 환경을 생성하고, 필요에 따라 해당 환경에서 의존성 및 프로젝트를 실행할 수 있다.</p>
<h3 id="python_6">Python 버전 호환성 문제 발생 시 해결 방법</h3>
<p>Python 버전 호환성 문제는 주로 프로젝트의 의존성 충돌이나 특정 버전에서만 작동하는 패키지로 인해 발생한다. 이러한 문제를 해결하기 위해서는 다음과 같은 단계를 따른다.</p>
<ol>
<li>
<p><strong>의존성 확인</strong>: <code>poetry show --tree</code> 명령어를 사용하여 의존성 트리를 확인하고, Python 버전과의 호환성 문제를 일으키는 패키지를 찾는다.</p>
</li>
<li>
<p><strong>의존성 제한</strong>: 특정 Python 버전에서만 작동하는 패키지가 있다면, 해당 패키지의 버전 범위를 좁히거나 다른 호환 가능한 버전을 찾아 설정한다.</p>
</li>
<li>
<p><strong>Poetry Lock 파일 재생성</strong>: 호환성 문제를 해결한 후, <code>poetry.lock</code> 파일을 갱신해야 한다. 다음 명령어를 사용하여 의존성 잠금 파일을 재생성한다.</p>
</li>
</ol>
<p><code>bash
   poetry lock --no-update</code></p>
<p>이 명령어는 기존에 설치된 의존성 버전을 업데이트하지 않고, 호환성 문제를 해결한 패키지로만 잠금 파일을 갱신한다.</p>
<ol>
<li><strong>Python 버전 범위 재설정</strong>: 필요한 경우 <code>pyproject.toml</code>에서 Python 버전 범위를 재설정하여 호환성 문제를 완전히 해결한다.</li>
</ol>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../chapter_03/0301/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../chapter_03/0301/" class="btn btn-xs btn-link">
        새로운 Python 프로젝트 생성하기
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../0204/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../0204/" class="btn btn-xs btn-link">
        Poetry 설정 파일을 통한 프로젝트 초기화
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>