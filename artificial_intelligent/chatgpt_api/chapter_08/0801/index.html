<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/artificial_intelligent/chatgpt_api/chapter_08/0801/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>API 키 관리 및 보안 - 소프트웨어 융합</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "API \ud0a4 \ubc1c\uae09 \ubc0f \uad00\ub9ac", url: "#_top", children: [
          ]},
          {title: "\ud658\uacbd \ubcc0\uc218\uc5d0 API \ud0a4 \uc800\uc7a5", url: "#api_1", children: [
              {title: "\ud658\uacbd \ubcc0\uc218 \uc124\uc815 \ubc29\ubc95", url: "#_1" },
          ]},
          {title: "\ube44\uacf5\uac1c \uc800\uc7a5\uc18c\uc640 \uad8c\ud55c \uad00\ub9ac", url: "#_2", children: [
          ]},
          {title: "API \ud0a4 \uc554\ud638\ud654", url: "#api_2", children: [
          ]},
          {title: "API \ud0a4\uc758 \uad8c\ud55c \uc81c\ud55c", url: "#api_3", children: [
              {title: "\ucd5c\uc18c \uad8c\ud55c \uc6d0\uce59 (Principle of Least Privilege)", url: "#principle-of-least-privilege" },
          ]},
          {title: "API \uc694\uccad\uc758 \ubcf4\uc548\uc801\uc778 \uc804\uc1a1", url: "#api_4", children: [
              {title: "TLS/SSL\uc758 \uc911\uc694\uc131", url: "#tlsssl" },
          ]},
          {title: "API \ud0a4\uc758 \uc7ac\uc0ac\uc6a9 \ubc29\uc9c0 \ubc0f \ud68c\uc804", url: "#api_5", children: [
              {title: "\ud0a4 \ud68c\uc804\uc758 \ud544\uc694\uc131", url: "#_3" },
          ]},
          {title: "API \ud0a4 \uc0ac\uc6a9 \ucd94\uc801 \ubc0f \ubaa8\ub2c8\ud130\ub9c1", url: "#api_6", children: [
              {title: "\ubaa8\ub2c8\ud130\ub9c1 \ubc29\ubc95", url: "#_4" },
          ]},
          {title: "", url: "#_5", children: [
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../0802/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../0802/" class="btn btn-xs btn-link">
        민감한 데이터 처리 시 주의 사항
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter_07/0704/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter_07/0704/" class="btn btn-xs btn-link">
        프롬프트 최적화를 통한 성능 향상
      </a>
    </div>
    
  </div>

    

    <p>OpenAI API를 안전하게 사용하기 위해서는 API 키 관리와 보안이 필수적이다. API 키는 OpenAI 서비스와 상호작용할 수 있는 인증 수단이므로, 이를 안전하게 보호하지 않으면 의도하지 않은 접근이나 남용이 발생할 수 있다. 이 섹션에서는 API 키의 생성, 관리, 저장, 그리고 보안적인 사용 방법에 대해 다룬다.</p>
<h3 id="api">API 키 발급 및 관리</h3>
<p>OpenAI API를 사용하려면 먼저 API 키를 발급받아야 한다. 다음은 OpenAI의 공식 웹사이트에서 API 키를 발급받고 관리하는 기본 절차이다.</p>
<ol>
<li><strong>API 키 발급</strong>: OpenAI 웹사이트에서 사용자 계정에 로그인한 후, API 설정 페이지에서 새로운 API 키를 생성할 수 있다.</li>
<li><strong>API 키 이름 지정</strong>: 여러 개의 API 키를 생성할 경우, 키마다 고유한 이름을 지정하여 나중에 구분하기 쉽게 관리하는 것이 좋다.</li>
<li><strong>API 키 삭제 및 재생성</strong>: 만약 API 키가 유출되거나 보안 문제가 발생했을 경우, 기존의 키를 삭제하고 새로운 키를 생성하는 것이 필요하다.</li>
</ol>
<p>API 키는 비공개 정보이므로 절대로 공용 저장소나 코드베이스에 노출되지 않도록 주의해야 한다.</p>
<h3 id="api_1">환경 변수에 API 키 저장</h3>
<p>API 키를 코드에 직접 포함시키는 것은 매우 위험한 방식이다. 이를 방지하기 위해, 일반적으로 <strong>환경 변수</strong>에 API 키를 저장하고 코드에서는 해당 환경 변수를 불러오는 방식으로 관리한다.</p>
<pre><code class="language-python">import os
import openai

openai.api_key = os.getenv(&quot;OPENAI_API_KEY&quot;)
</code></pre>
<h4 id="_1">환경 변수 설정 방법</h4>
<ul>
<li><strong>Windows</strong>: 터미널에서 <code>set</code> 명령어를 사용하여 환경 변수를 설정할 수 있다.</li>
</ul>
<p><code>set OPENAI_API_KEY=your_openai_api_key</code></p>
<ul>
<li><strong>Linux/macOS</strong>: <code>.bashrc</code> 또는 <code>.zshrc</code> 파일에 다음과 같은 라인을 추가하여 API 키를 영구적으로 설정할 수 있다.</li>
</ul>
<p><code>export OPENAI_API_KEY="your_openai_api_key"</code></p>
<p>이 방식으로 API 키를 코드에서 직접적으로 노출하지 않으면서 안전하게 사용할 수 있다.</p>
<h3 id="_2">비공개 저장소와 권한 관리</h3>
<p>API 키는 민감한 정보이므로 Git과 같은 소스 코드 관리 시스템에 포함되지 않도록 해야 한다. 이를 위해서는 아래와 같은 조치를 취할 수 있다.</p>
<ul>
<li><strong><code>.gitignore</code> 설정</strong>: <code>.env</code> 파일과 같은 민감한 정보를 저장하는 파일을 <code>.gitignore</code>에 추가하여 Git 저장소에 포함되지 않도록 한다.</li>
</ul>
<p><code># .gitignore 예시
  .env</code></p>
<ul>
<li>
<p><strong>비공개 저장소 사용</strong>: API 키를 사용하는 프로젝트는 가능한 한 비공개 저장소를 사용하는 것이 좋다. GitHub에서는 비공개 저장소를 제공하므로 이를 활용할 수 있다.</p>
</li>
<li>
<p><strong>액세스 권한 최소화</strong>: 팀 내에서 API 키에 대한 접근 권한을 필요한 사람들에게만 제한하는 것이 중요하다. 관리자가 아닌 사용자는 API 키에 접근할 필요가 없으며, 필요 시 관리자에게 문의하여 필요한 키만 공유받을 수 있다.</p>
</li>
</ul>
<h3 id="api_2">API 키 암호화</h3>
<p>API 키를 저장하거나 전송할 때는 가능한 한 암호화된 환경에서 관리하는 것이 좋다. 환경 변수를 사용하는 것 외에도, 애플리케이션에서 API 키를 암호화하여 저장하는 방법도 고려할 수 있다.</p>
<p>API 키를 암호화하는 방법으로는 대칭 키 암호화 방식을 사용할 수 있다. 예를 들어, Python의 <code>cryptography</code> 패키지를 사용하여 API 키를 암호화하고 복호화하는 방법을 구현할 수 있다.</p>
<pre><code class="language-python">from cryptography.fernet import Fernet

key = Fernet.generate_key()
cipher_suite = Fernet(key)

api_key = b&quot;your_openai_api_key&quot;
cipher_text = cipher_suite.encrypt(api_key)

plain_text = cipher_suite.decrypt(cipher_text)
print(plain_text.decode(&quot;utf-8&quot;))
</code></pre>
<p>암호화된 API 키는 안전하게 저장할 수 있으며, 복호화가 필요한 시점에만 키를 복호화하여 사용할 수 있다. </p>
<h3 id="api_3">API 키의 권한 제한</h3>
<p>API 키를 사용할 때는 필요한 최소한의 권한만 부여하는 것이 중요하다. OpenAI API는 현재 세부적인 권한 설정 기능을 제공하지 않지만, 가능한 한 각 프로젝트에 맞는 API 키를 발급하고, 그 키가 다른 프로젝트나 서비스에서 사용되지 않도록 관리해야 한다. 예를 들어, 하나의 API 키를 여러 애플리케이션에서 공유하는 대신, 각 애플리케이션에 별도의 키를 할당하는 것이 보안적인 측면에서 유리한다.</p>
<h4 id="principle-of-least-privilege">최소 권한 원칙 (Principle of Least Privilege)</h4>
<p>보안의 기본 원칙 중 하나는 최소 권한 원칙(Principle of Least Privilege)이다. 이는 각 시스템, 사용자, 서비스에 필요한 최소한의 권한만 부여하고, 불필요한 권한을 제거하는 것을 의미한다. OpenAI API 키를 사용할 때도 이 원칙을 적용하여 다음과 같이 관리할 수 있다.</p>
<ul>
<li>각 서비스별로 고유한 API 키를 생성하여 권한을 분리한다.</li>
<li>API 키가 필요한 범위를 최소화하고, 필요 시 키를 철회하거나 새로 발급한다.</li>
<li>시스템이 아닌 사람에게는 API 키를 직접 공유하지 않도록 주의한다.</li>
</ul>
<h3 id="api_4">API 요청의 보안적인 전송</h3>
<p>API 키를 사용하여 OpenAI 서버와 통신할 때는 반드시 <strong>HTTPS</strong> 프로토콜을 사용해야 한다. HTTPS는 데이터를 암호화하여 네트워크 상에서의 도청을 방지하므로, 민감한 정보(예: API 키)가 노출되지 않도록 보호한다. Python의 <code>requests</code> 라이브러리나 OpenAI 라이브러리를 사용하는 경우 기본적으로 HTTPS를 사용하므로 추가적인 설정은 필요하지 않지만, 이를 항상 유념하고 있어야 한다.</p>
<pre><code class="language-python">import openai

response = openai.Completion.create(
    engine=&quot;text-davinci-003&quot;,
    prompt=&quot;Hello, World!&quot;,
    max_tokens=5
)
</code></pre>
<h4 id="tlsssl">TLS/SSL의 중요성</h4>
<p>TLS(Transport Layer Security)와 SSL(Secure Sockets Layer)는 인터넷 상에서 데이터를 안전하게 전송하는 프로토콜이다. TLS는 SSL의 향상된 버전으로, 최신 웹 보안 표준으로 자리 잡았다. OpenAI API는 기본적으로 TLS를 사용하므로, HTTPS를 통해 안전하게 데이터를 주고받을 수 있다.</p>
<h3 id="api_5">API 키의 재사용 방지 및 회전</h3>
<p>API 키가 노출되거나 오용될 가능성을 최소화하기 위해 주기적으로 API 키를 회전(rotating)하는 것이 좋다. API 키 회전은 새로운 API 키를 생성한 후 기존 키를 비활성화하는 과정을 말한다.</p>
<h4 id="_3">키 회전의 필요성</h4>
<ul>
<li><strong>노출 위험 감소</strong>: API 키가 유출되었을 때 이를 빠르게 무효화하고 새로운 키로 교체함으로써 피해를 최소화할 수 있다.</li>
<li><strong>보안 강화</strong>: 주기적인 API 키 회전은 시스템의 보안성을 유지하고, 잠재적인 취약점을 줄일 수 있다.</li>
</ul>
<p>키를 회전하는 절차는 다음과 같다.</p>
<ol>
<li><strong>새로운 API 키 생성</strong>: 기존 키와 동일한 권한을 가진 새로운 API 키를 생성한다.</li>
<li><strong>새로운 키로 시스템 업데이트</strong>: 애플리케이션 코드 및 환경 변수를 새로운 API 키로 업데이트한다.</li>
<li><strong>기존 API 키 비활성화</strong>: 기존 API 키를 비활성화하거나 삭제한다.</li>
</ol>
<h3 id="api_6">API 키 사용 추적 및 모니터링</h3>
<p>API 키 사용 내역을 주기적으로 모니터링하는 것도 중요한 보안 조치 중 하나이다. OpenAI 대시보드에서는 API 호출 내역을 확인할 수 있으며, 이를 통해 비정상적인 API 사용이나 의심스러운 요청을 추적할 수 있다.</p>
<h4 id="_4">모니터링 방법</h4>
<ul>
<li><strong>API 호출 빈도 확인</strong>: 대시보드를 통해 각 API 키의 호출 빈도를 확인하고, 예상보다 많은 요청이 발생하는 경우 이를 조사해야 한다.</li>
<li><strong>IP 주소 추적</strong>: 비정상적인 IP 주소에서의 요청이 발생하면 API 키가 유출되었을 가능성을 고려하고 즉시 대응해야 한다.</li>
</ul>
<p>모니터링 시스템을 자동화하여 알림을 설정하는 것도 좋은 방법이다. 예를 들어, 일정량 이상의 API 호출이 발생하면 알림을 보내는 방식으로 시스템을 구축할 수 있다.</p>
<pre><code class="language-python">import logging

def monitor_api_usage(api_key):
    # API 호출 사용량을 확인하고 임계값 초과 시 로그 기록
    usage = check_api_usage(api_key)
    if usage &gt; THRESHOLD:
        logging.warning(f&quot;API 사용량이 임계값을 초과하였다: {usage}&quot;)
</code></pre>
<h3 id="_5"></h3>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../0802/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../0802/" class="btn btn-xs btn-link">
        민감한 데이터 처리 시 주의 사항
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter_07/0704/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter_07/0704/" class="btn btn-xs btn-link">
        프롬프트 최적화를 통한 성능 향상
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>