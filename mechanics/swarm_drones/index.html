<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://booiljung.github.io/mechanics/swarm_drones/" rel="canonical"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<title>비파괴 검사를 위한 군집 드론 행동과 자세 제어 방법 - 실험 도서관</title>
<link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet"/>
<link href="../../css/font-awesome-4.7.0.css" rel="stylesheet"/>
<link href="../../css/base.css" rel="stylesheet"/>
<link href="../../css/highlight.css" rel="stylesheet"/>
<link href="../../css/custom.css" rel="stylesheet"/>
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<script src="../../js/jquery-3.2.1.min.js"></script>
<script src="../../js/bootstrap-3.3.7.min.js"></script>
<script src="../../js/highlight.pack.js"></script>
<base target="_top"/>
<script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\ucd08\ub85d (Abstract)", url: "#_top", children: [
          ]},
          {title: "1. \uc11c\ub860 (Background)", url: "#1-background", children: [
          ]},
          {title: "2. \uc2dc\uc2a4\ud15c \uac1c\uc694", url: "#2", children: [
              {title: "2.1 \ub4dc\ub860\uc758 \ud558\ub4dc\uc6e8\uc5b4 \uad6c\uc131", url: "#21" },
              {title: "2.2 MAVLink \ud1b5\uc2e0", url: "#22-mavlink" },
              {title: "2.2 \uc18c\ud504\ud2b8\uc6e8\uc5b4 \uad6c\uc131", url: "#22" },
              {title: "1. \ud544\uc694\ud55c \ubcc0\uc218\ub4e4", url: "#1" },
              {title: "2. GPS \uc88c\ud45c\ub85c \ubcc0\ud658\ud558\ub294 \uc808\ucc28", url: "#2-gps" },
              {title: "3. \uacb0\uacfc", url: "#3" },
              {title: "3.3.4 \uac00\uc0c1 \ud3c9\uba74 \uc801\uc6a9", url: "#334" },
              {title: "3.3.5 \ud5a5\ud6c4 \uacfc\uc81c", url: "#335" },
              {title: "2.3 \uad70\uc9d1 \ube44\ud589 \uc81c\uc5b4", url: "#23_1" },
              {title: "2.4 \uac80\uc0ac \uc808\ucc28", url: "#24_1" },
          ]},
          {title: "3. \uad70\uc9d1 \uc81c\uc5b4 \uc2dc\uc2a4\ud15c", url: "#3_1", children: [
              {title: "3.1 \uad70\uc9d1 \uc0c1\ud0dc \uc804\uc774", url: "#31" },
              {title: "3.2 \uac1c\ubcc4 \ub4dc\ub860 \uc0c1\ud0dc \uc804\uc774", url: "#32" },
          ]},
          {title: "4. \uad00\uc81c \uc18c\ud504\ud2b8\uc6e8\uc5b4", url: "#4", children: [
              {title: "4.1 MAVLink \ud1b5\uc2e0", url: "#41-mavlink" },
              {title: "4.2 \uac00\uc0c1 \ud3c9\uba74 \uc0dd\uc131", url: "#42" },
          ]},
          {title: "5. \uacb0\ub860", url: "#5", children: [
          ]},
          {title: "\ucc38\uc870", url: "#_1", children: [
          ]},
        ];

    </script>
<script src="../../js/base.js"></script>
<script src="../../js/google_analytics.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script>
</meta></head>
<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>
<div class="container-fluid wm-page-content">
<a name="_top"></a>
<div aria-label="navigation" class="row wm-article-nav-buttons" role="navigation">
<div class="wm-article-nav pull-right">
<a class="btn btn-xs btn-default pull-right" href="../../artificial_intelligent/01_preface_ko/">
        Next
        <i aria-hidden="true" class="fa fa-chevron-right"></i>
</a>
<a class="btn btn-xs btn-link" href="../../artificial_intelligent/01_preface_ko/">
        소개
      </a>
</div>
<div class="wm-article-nav">
<a class="btn btn-xs btn-default pull-left" href="../collision_detection/triangle_vs_triangle/">
<i aria-hidden="true" class="fa fa-chevron-left"></i>
        Previous</a><a class="btn btn-xs btn-link" href="../collision_detection/triangle_vs_triangle/">
        삼각형과 삼각형의 충돌 검사
      </a>
</div>
</div>
<p>두대의 군집 드론을 동시에 제어하여 비파괴 검사를 하는 연구 논문을 작성 하라. 대한민국의 로봇학계의 논문 형식으로 하라. 두대의 드론은 피사체를 사이에 두고, 조종자의 지시에 따라, 피사체로부터 지정한 거리를 유지하며, 지정한 간격만큼 이동하며 영상을 취득한다. 드론이 상호 상대 드론의 위치를 추정하여, 비파괴 검사 장비를 상호 조준하며, 영상을 획득 한다. 시스템 상태는 군집 상타와 개별 드론 상태로 나뉜다. 드론 자동 제어를 위한 펌웨어는 아두파일럿을 적용하였고, 두대의 드론으로 비파괴 검사를 수행하기 위한 관제 소프트웨어를 개발하였다. 관제 소프트웨어와 드론 FC 간에는 MAVLink로 통신을 한다. 관제를 위한 상태 관리는 개별 드론 관제 상태와 군집 관제 상태로 구분 된다. 조종자는 군집 상태 관리를 전이하여 임무를 수행하고, 군집 상태 관리는 임무 수행을 위해 절차에 따라 개별 드론 관제 상태를 전이 한다. 군집 관제 상태는 피사체 설정을 위해 두개의 드론 사이에 가상의 평면을 생성하고, 조종자의 명령에 따라 군집 관제는 가상 평면 위에서 지정한 거리를 유지하며 지정한 경로로 이동하고 비파괴 검사 장치를 작동 시켜 영상을 획득 한다.</p>
<h2 id="abstract">초록 (Abstract)</h2>
<p>본 연구에서는 두 대의 드론을 이용한 군집 비파괴 검사 시스템을 제안한다. 제안된 시스템은 피사체를 중심으로 드론이 일정한 거리를 유지하며 이동하면서 영상을 취득하는 방식으로, 비파괴 검사 장비를 이용해 피사체의 결함을 탐지한다. 두 드론은 서로의 위치를 실시간으로 추정하며 상호 조준하여 검사 정확도를 높이며, MAVLink 프로토콜을 사용하여 관제 소프트웨어와 통신한다. 시스템 상태는 개별 드론의 상태와 군집 상태로 나뉘며, 각 드론은 독립적으로 동작하는 상태와 군집으로 동작하는 상태에서 임무를 수행한다. 조종자의 명령에 따라 드론은 이륙 후 피사체를 중심으로 지정된 위치에 도달하며, 이후 자동 모드로 전환하여 설정된 경로를 따라 검사 작업을 수행한다. 이 시스템은 비파괴 검사를 위한 고정밀 자동화 기술을 제공하며, 상호 협력하는 드론 간의 효율적인 제어 및 관제를 통해 검사 장비의 효과적인 사용을 가능하게 한다. 향후 연구에서는 검사 장비의 정밀도 향상과 다양한 형태의 피사체에 대한 적용 가능성을 검토할 계획이다.</p>
<h2 id="1-background">1. 서론 (Background)</h2>
<p>비파괴 검사(Non-Destructive Testing, NDT)는 검사 대상 물체의 손상 없이 결함이나 이상을 탐지하는 중요한 기술로, 건설, 항공, 에너지 산업 등에서 폭넓게 활용되고 있다. 특히, 대형 구조물이나 접근이 어려운 장소에서는 작업자가 직접 접근하기 어려운 경우가 많아 비파괴 검사의 필요성이 더욱 커지고 있다. 이러한 요구에 대응하기 위해 최근에는 드론을 활용한 비파괴 검사 기술이 주목받고 있다. 드론을 활용하면 검사자의 물리적 접근이 어려운 고층 구조물이나 복잡한 환경에서도 효율적으로 검사를 수행할 수 있으며, 검사 시간을 단축하고 작업자의 안전을 보장할 수 있다.</p>
<p>하지만 기존의 단일 드론을 이용한 비파괴 검사는 여러 한계가 있다. 단일 드론으로는 넓은 범위를 효과적으로 커버하기 어려우며, 정밀한 위치 제어가 요구되는 비파괴 검사 장비를 운용하는 데에도 한계가 존재한다. 이러한 문제를 해결하기 위해 다수의 드론을 이용한 군집 비파괴 검사 시스템이 등장하였다. 군집 드론은 여러 대의 드론이 협력하여 검사 대상을 다양한 각도에서 동시에 촬영하거나, 서로의 위치를 보정하며 정밀한 검사를 가능하게 하는 장점이 있다.</p>
<p>본 논문에서는 두 대의 드론을 이용하여 군집 비파괴 검사를 수행하는 시스템을 제안한다. 이 시스템은 피사체를 중심으로 드론들이 지정된 거리를 유지하며, 조종자의 지시에 따라 비파괴 검사를 수행한다. 두 드론은 상호 위치를 실시간으로 추정하여 검사 장비를 정확히 조준하며, 지정된 간격으로 이동하면서 영상을 취득한다. 이러한 방식을 통해 검사 영역의 커버리지를 넓히고, 검사 정확도를 높일 수 있다. 또한, 군집 드론이 피사체와의 거리를 유지하면서 자동으로 검사 작업을 수행함으로써 작업자의 개입을 최소화하고, 검사 과정의 효율성을 극대화할 수 있다.</p>
<p>본 연구에서 제안하는 시스템은 아두파일럿(ArduPilot) 펌웨어를 기반으로 하여 비행 및 제어를 수행하며, 관제 소프트웨어는 MAVLink 프로토콜을 통해 드론과의 통신을 관리한다. 또한, 본 시스템에서는 군집 제어와 개별 드론 제어를 구분하여 조종자가 군집 상태를 전이시키면 개별 드론은 그에 맞춰 적절한 행동을 취하게 된다. 이를 통해 검사 작업을 보다 유연하고 효과적으로 수행할 수 있다.</p>
<p>따라서 본 논문에서는 제안된 시스템의 구조, 동작 원리, 관제 소프트웨어 및 군집 제어 알고리즘을 설명하고, 이를 바탕으로 두 대의 드론을 이용한 비파괴 검사 실험 결과를 제시한다. 제안된 시스템이 비파괴 검사 현장에서 어떻게 활용될 수 있는지에 대해 논의하고, 향후 연구 방향을 제시하고자 한다.</p>
<h2 id="2">2. 시스템 개요</h2>
<h3 id="21">2.1 드론의 하드웨어 구성</h3>
<p>비파괴 검사 시스템을 구성하는 드론들은 각각 동일한 하드웨어로 구성되어 있으며, 다음과 같은 주요 구성 요소를 포함한다.</p>
<ul>
<li>
<p><strong>비파괴 검사 장비</strong>: 두 대의 드론에는 비파괴 검사를 위한 장비가 탑재되어 있다. 이 장비는 구조물의 결함을 비접촉 방식으로 분석하며, 엑스레이나 초음파 센서, 열화상 카메라 등의 장비가 사용될 수 있다.</p>
</li>
<li>
<p><strong>카메라</strong>: 각 드론은 고해상도 카메라를 통해 피사체의 표면을 촬영한다. 이 카메라는 드론의 이동 경로에 따라 연속적으로 이미지를 획득하여 검사 데이터를 제공한다.</p>
</li>
<li>
<p><strong>GPS 모듈</strong>: 각 드론은 GPS 모듈을 탑재하여 실시간 위치 추적이 가능하며, 드론 간 상대적 위치와 피사체와의 거리를 계산하는 데 사용된다.</p>
</li>
<li>
<p><strong>9축 IMU (Inertial Measurement Unit)</strong>: 9축 IMU는 드론의 가속도와 각속도, 방위각을 측정하여 안정적인 비행과 위치 추정을 지원한다. IMU 데이터는 드론의 자세 제어에 사용되며, 상대 드론의 위치에 대응하여 자세를 결정하는 과정에 중요한 역할을 한다.</p>
</li>
<li>
<p><strong>FC (Flight Controller)</strong>: 드론의 비행을 제어하는 핵심 장치로, 아두파일럿(ArduPilot) 펌웨어가 설치된 비행 컨트롤러(Flight Controller)가 사용된다. 이 FC는 IMU, GPS, 카메라 등의 데이터를 통합하여 비행 경로를 계획하고, 액추에이터를 제어한다 [Ardupilot].</p>
</li>
</ul>
<h3 id="22-mavlink">2.2 MAVLink 통신</h3>
<p>MAVLink는 <strong>Micro Air Vehicle Link</strong>의 약자로, 무인 항공기(UAV) 및 로봇과 관제 소프트웨어 간의 경량 통신 프로토콜을 의미한다. 본 연구에서는 두 대의 드론과 관제 소프트웨어 간의 통신을 원활하게 하기 위해 MAVLink 프로토콜을 채택하였다. MAVLink는 특히 저전력 환경에서 효율적으로 동작하며, 실시간으로 드론의 상태 정보와 명령을 주고받을 수 있는 구조를 제공한다. 이를 통해 본 시스템에서 군집 드론 제어, 상태 전이, 비파괴 검사 데이터를 교환하는 데 중요한 역할을 한다[MAVLink].</p>
<h4 id="221-mavlink-2">2.2.1 MAVLink 2 선택 이유</h4>
<p>본 연구에서는 기존의 MAVLink 1 대신 <strong>MAVLink 2</strong> 프로토콜을 선택하여 드론 간 통신 및 관제 시스템을 구현하였다. MAVLink 2은 MAVLink 1의 단점을 보완하고, 더욱 향상된 기능을 제공하는 최신 버전의 통신 프로토콜로, 다음과 같은 이유로 선택되었다 [MAVLink2].</p>
<p><strong>확장된 메시지 용량</strong>: MAVLink 2은 MAVLink 1에 비해 <strong>확장된 메시지 용량</strong>을 지원한다. MAVLink 1에서는 페이로드 크기가 최대 255바이트로 제한되었지만, MAVLink 2에서는 메시지 크기를 확장하여 더 많은 데이터를 포함할 수 있게 되었다. 이는 비파괴 검사 시스템에서 대용량의 센서 데이터를 주고받는 경우에 특히 유리하다. 검사 장비에서 생성되는 초음파 데이터나 고해상도 카메라 데이터를 실시간으로 전송할 때, MAVLink 2의 확장된 페이로드는 더욱 효율적인 데이터 통신을 가능하게 한다.</p>
<p><strong>신뢰성 향상 및 오류 검출</strong>: MAVLink 2은 기존의 8비트 CRC(Cyclic Redundancy Check) 대신 <strong>64비트 서명(Signature)</strong>을 추가하여 통신 보안을 강화했다. 이는 통신 중 발생할 수 있는 데이터 손상이나 신호 간섭을 보다 효과적으로 검출하고 복구할 수 있게 해준다. 비파괴 검사 중에 드론이 고도로 정밀한 조작을 요구하는 경우가 많기 때문에, 통신 오류를 최소화하고 신뢰성을 확보하는 것이 매우 중요하다. MAVLink 2의 향상된 오류 검출 및 복구 메커니즘 덕분에, 드론 간 명령 전송 및 상태 보고의 신뢰성이 크게 향상되었다.</p>
<p><strong>프로토콜 확장성</strong>: MAVLink 2은 <strong>메시지 확장 필드</strong>를 지원하여, 새로운 메시지나 맞춤형 명령을 쉽게 추가할 수 있는 구조로 설계되었다. 본 시스템에서는 비파괴 검사를 위한 추가적인 데이터를 주고받아야 할 필요가 있었고, MAVLink 2의 확장성을 활용하여 사용자 정의 메시지를 추가로 정의할 수 있었다. 이러한 확장성 덕분에, 검사 장비의 상태 데이터나 비파괴 검사 장비의 고유한 명령을 효율적으로 전송할 수 있었다.</p>
<p><strong>신속한 모드 전환 지원</strong>: MAVLink 2은 <strong>프레임 단축</strong> 기능을 제공하여 메시지를 보다 신속하게 전송할 수 있다. 이는 드론 간 상호 위치를 추정하고, 비파괴 검사 중 피사체를 정확하게 조준하는 데 있어 필수적이다. 드론이 조종자의 명령에 따라 신속하게 모드를 전환해야 하는 경우, MAVLink 2의 향상된 메시지 전송 속도는 실시간 제어 성능을 크게 향상시켰다. 예를 들어, 드론이 <strong>aim</strong> 모드에서 <strong>auto</strong> 모드로 전환할 때, 모드 전환 지연을 최소화하여 검사 작업의 효율성을 높였다.</p>
<p><strong>보안 강화</strong>: MAVLink 2은 <strong>암호화</strong> 기능을 추가하여 통신의 보안을 한층 강화하였다. 드론은 중요한 임무를 수행하는 도중에 외부의 신호 간섭이나 해킹 시도로부터 안전해야 하므로, MAVLink 2의 암호화 기능은 중요한 보안 요소로 작용한다. 특히, 드론 간 통신이 빈번하게 이루어지는 본 연구에서, 상호 위치 정보 및 명령 데이터의 무결성을 보장하는 것은 매우 중요하다. MAVLink 2의 보안 기능을 통해 임무 수행 중 통신의 안전성을 확보할 수 있었다.</p>
<p><strong>상호 호환성</strong>: MAVLink 2은 기존의 MAVLink 1과도 <strong>상호 호환성</strong>을 유지하여, 시스템 구축 시에 유연성을 제공한다. 기존의 MAVLink 1 기반 장비나 소프트웨어를 사용하는 경우에도 MAVLink 2으로 쉽게 전환할 수 있기 때문에, 다양한 하드웨어와 통합하여 사용할 수 있었다. 본 시스템은 MAVLink 2을 기본 프로토콜로 사용하면서, 기존의 MAVLink 1 장비도 손쉽게 통합할 수 있었다.</p>
<h4 id="222-mavlink-2">2.2.2 MAVLink 2 프로토콜의 구조</h4>
<p>MAVLink 2은 기존 MAVLink 1의 확장 버전으로, 더 많은 기능과 향상된 보안을 제공한다. 특히 메시지 필드 확장, 인증을 위한 서명 기능, 더 작은 메시지 크기 등 여러 개선 사항이 포함되어 있다. 본 연구에서는 MAVLink 2 프로토콜을 적용하여 드론과 관제 소프트웨어 간의 통신을 구현하였다. MAVLink 2 메시지는 기존 버전과 비교해 더 많은 기능을 제공하기 위해 메시지 필드가 확장되었으며, 다음과 같은 요소로 구성된다 [MAVLink2]:</p>
<p><strong>STX (Start of Frame)</strong>: MAVLink 2.0 메시지의 시작을 나타내는 1바이트 필드로, 값은 <code>0xFD</code>로 설정된다. 이는 MAVLink 1.0에서 사용되는 <code>0xFE</code>와 구별되는 값이다.</p>
<p><strong>Payload Length (1 Byte)</strong>: 페이로드의 크기를 나타내는 1바이트 필드로, 최대 255바이트까지 확장할 수 있다. MAVLink 1.0에서는 최대 255바이트로 고정되었으나, MAVLink 2.0에서는 사용되지 않는 필드를 동적으로 줄임으로써 더 작은 패킷 크기를 사용할 수 있게 되었다.</p>
<p><strong>Incompatibility Flags (1 Byte)</strong>: MAVLink 2.0에서 추가된 필드로, 메시지를 처리할 수 없는 경우 이를 알리는 비호환성 플래그이다. 드론 또는 관제 소프트웨어가 이 메시지를 처리할 수 없는 경우 적절한 에러 처리를 할 수 있다.</p>
<p><strong>Compatibility Flags (1 Byte)</strong>: 이전 버전과의 호환성을 유지하기 위해 추가된 필드로, 비호환성을 일으키지 않는 메시지의 경우 이 플래그가 설정된다. 이를 통해 MAVLink 2.0은 MAVLink 1.0과의 상호 운용성을 제공한다.</p>
<p><strong>Sequence (1 Byte)</strong>: 송신 측에서 전송되는 메시지의 순서 번호를 나타내는 필드로, 패킷의 순서를 식별할 수 있다. 이를 통해 관제 소프트웨어는 패킷 손실 여부를 확인할 수 있으며, 재전송 메커니즘을 통해 통신의 신뢰성을 보장할 수 있다.</p>
<p><strong>System ID (1 Byte)</strong>: 메시지를 전송하는 시스템의 ID를 나타낸다. 각 드론이나 관제 소프트웨어는 고유한 시스템 ID를 가지며, 이를 통해 서로 다른 시스템 간의 메시지 충돌을 방지한다.</p>
<p><strong>Component ID (1 Byte)</strong>: 시스템 내의 특정 구성 요소를 식별하기 위한 필드로, 예를 들어 FC(Flight Controller)나 카메라 모듈 등 서로 다른 하드웨어 간에 통신을 구분할 수 있다.</p>
<p><strong>Message ID (3 Bytes)</strong>: 메시지의 유형을 나타내는 필드로, 메시지가 어떤 명령이나 상태 정보를 포함하는지를 정의한다. MAVLink 1.0에서는 1바이트였던 것과 달리, MAVLink 2.0에서는 3바이트로 확장되어 총 16,777,216개의 메시지 유형을 정의할 수 있다.</p>
<p><strong>Payload (최대 255 Bytes)</strong>: 실제 데이터를 포함하는 부분으로, 드론의 상태 정보, 명령, 센서 데이터 등을 전송한다. 이 필드는 메시지의 목적에 따라 가변적이며, 최대 255바이트의 데이터를 담을 수 있다.</p>
<p><strong>Checksum (2 Bytes)</strong>: 메시지의 무결성을 확인하기 위한 2바이트 필드로, 메시지 전송 과정에서 발생할 수 있는 오류를 감지하고 검증하는 역할을 한다. MAVLink 2.0에서는 페이로드에 따라 동적으로 생성되는 체크섬 값을 사용하여 데이터 손상을 방지한다.</p>
<p><strong>Signature (0–13 Bytes)</strong> (선택 사항): MAVLink 2.0에서 추가된 보안 기능으로, 메시지의 서명 값을 포함한다. 서명은 메시지의 무결성을 보장하며, 메시지가 외부에서 변조되지 않았음을 확인할 수 있다. 서명 필드는 13바이트까지 확장될 수 있으며, 보안을 강화하고자 할 때 사용된다.</p>
<h4 id="223">2.2.3 드론과 관제 소프트웨어 간 통신 흐름</h4>
<p>MAVLink는 본 시스템에서 드론과 관제 소프트웨어 사이의 실시간 통신을 담당하며, 다음과 같은 통신 흐름을 따른다:</p>
<h5 id="2231-telemetry">2.2.3.1 드론 상태 정보 전송 (Telemetry)</h5>
<p>각 드론은 상태 메시지를 주기적으로 전송하여 현재 상태를 관제 소프트웨어에 알린다. 이 메시지는 드론의 비행 모드, 배터리 상태, 센서 상태 등을 포함한다. 이러한 정보는 조종자가 실시간으로 드론의 상태를 모니터링할 수 있도록 하며, 비행 경로를 동적으로 조정하는 데 필요한 데이터를 제공한다. 주요 상태 정보는 다음과 같다:</p>
<p><strong>위치 정보</strong>: 드론의 실시간 GPS 데이터를 기반으로 드론의 좌표를 제공한다. 관제 소프트웨어는 두 드론 간의 상대 위치를 실시간으로 모니터링하며, 지정된 경로를 따르고 있는지 확인한다. 드론의 위치 정보는 일반적으로 두 가지 방식으로 제공 된다.</p>
<ul>
<li>GPS 좌표 기반 위치 정보:</li>
<li>드론의 절대적인 위치를 위도(latitude), 경도(longitude), 고도(altitude)로 나타낸다. 이는 <strong>지구 좌표계</strong>에서 드론이 어디에 있는지를 나타내는 정보로, GPS 모듈에서 제공된다.</li>
<li>본 시스템에서 GPS 좌표 기반 위치 정보는 드론이 정확한 위치를 파악하고 상대 드론의 위치를 계산하는데 사용 된다.</li>
<li>상대 좌표 기반 위치 정보:</li>
<li>이륙 기준점으로부터의 <strong>상대적인 위치</strong>를 나타낸다. 이는 드론의 센서(예: IMU, 거리 센서)와 상호 통신을 통해 계산된 데이터다.</li>
<li>상대 좌표 정보는 군집 비행 시 다른 드론이나 특정 목표물과의 상대적인 위치를 추적하는 데 유용하다.</li>
</ul>
<p>이 두 가지 정보를 결합하여 드론은 절대 위치와 상대적인 관계를 모두 파악할 수 있어, 특히 군집 비행과 같은 정밀한 작업에서 중요한 역할을 한다.</p>
<p><strong>배터리 상태</strong>: 드론의 배터리 수준이 안전한 비행을 유지할 수 있는지 모니터링하며, 필요 시 자동으로 <strong>RTL(Return to Launch)</strong>  명령을 수행 하도록 설정 할 수 있다.</p>
<p><strong>IMU 데이터</strong>: 본 연구에서는 IMU(Inertial Measurement Unit) 데이터를 실시간으로 활용하여 드론의 자세, 가속도, 각속도, 방위각을 모니터링하며, 이를 통해 드론의 포즈와 비행 안전성을 지속적으로 감시한다. 이러한 IMU 데이터는 비파괴 검사 장비의 활성화 여부를 결정하는 중요한 요소로 작용한다. 드론의 속도나 각속도가 미리 설정된 안전 한계를 초과하는 경우, 비파괴 검사 장비로부터 획득된 데이터는 과도한 측정 노이즈나 블러로 인해 정확한 분석이 불가능할 수 있다. 따라서, IMU 데이터는 드론의 안정성을 판단하고, 비파괴 검사 장비가 정확한 결과를 제공할 수 있는 최적의 조건에서만 작동하도록 제어하는 역할을 수행한다.</p>
<h5 id="2232-command-transmission">2.2.3.2 명령 전송 (Command Transmission)</h5>
<p>관제 소프트웨어는 드론에 대한 명령을 MAVLink 메시지를 통해 전송한다. 이 과정은 조종자의 명령에 따라 자동화되며, 주로 <strong>Command Long</strong> 메시지를 사용하여 다양한 비행 모드를 제어한다. 주요 명령 유형은 다음과 같다:</p>
<p><strong>이륙 및 착륙 명령</strong>: 관제 소프트웨어에서 <strong>Command Long 메시지</strong>를 전송하여 드론에게 <strong>takeoff</strong> 또는 <strong>land</strong> 명령을 내린다. 이 명령은 드론이 자동으로 고도와 위치를 조정하여 안전하게 이륙하거나 착륙할 수 있도록 한다.</p>
<p><strong>비행 경로 설정</strong>: <strong>Position Target 메시지</strong>를 통해 드론의 목표 위치를 지정한다. 이 메시지는 드론의 GPS 좌표와 목표 고도를 포함하며, 드론은 해당 목표에 맞춰 이동한다. 관제 소프트웨어는 이를 통해 두 드론이 피사체 주위를 일정한 거리로 이동하며 비파괴 검사를 수행할 수 있도록 한다.</p>
<p><strong>모드 전환 명령</strong>: 본 연구에서 드론의 비행 상태와 임무 수행을 관리하기 위해 아두파일럿(ArduPilot) 펌웨어를 사용하여 드론의 다양한 비행 모드를 제어한다. 드론의 상태 전환과 제어는 <strong>MAVLink</strong> 프로토콜을 통해 이루어지며, 관제 소프트웨어에서 명령을 전송하여 드론의 비행 모드를 전환한다. 주요 모드 전환 명령은 <strong>ARM</strong>, <strong>DISARM</strong>, <strong>TAKEOFF</strong>, <strong>LAND</strong>, <strong>RTL (Return to Launch)</strong>, <strong>GUIDED</strong>, <strong>BRAKE</strong> 모드를 사용한다. 각 명령의 동작은 아두파일럿의 기본 명령 집합을 따르며, 군집 비행 제어를 위한 중요한 요소로 작용한다.</p>
<h5 id="2233-inter-drone-communication">2.2.3.3. 드론 간 통신 (Inter-Drone Communication)</h5>
<p>본 시스템에서는 드론 간 직접적인 통신을 수행하지 않고, 관제 소프트웨어에서 두 드론의 상대적 위치를 계산한 후, 각 드론에 필요한 정보를 전송하는 방식을 채택하였다. 이는 무선 네트워크의 트래픽을 최소화하고, 통신 효율성을 극대화하기 위한 중요한 전략이다. 드론 간의 통신을 직접 수행하게 되면, 실시간 위치 정보와 명령 전송이 과도하게 발생하여 무선 네트워크의 대역폭이 불필요하게 소모될 수 있다. 이를 방지하기 위해 본 연구에서는 다음과 같은 통신 방식을 설계하였다.</p>
<p><strong>최소화된 메시지 전송</strong>: 관제 소프트웨어는 두 드론의 위치 데이터를 실시간으로 수집하고, 두 드론 간의 상대적 위치와 각도를 계산하여 필요한 정보만을 각각의 드론에 전송한다. 이 방식은 드론 간의 직접적인 데이터 전송을 줄여, 네트워크 트래픽을 최소화하는 효과를 제공한다. 특히, 드론이 비파괴 검사를 수행하는 동안에는 불필요한 통신을 제한하여 통신 지연이나 데이터 손실을 방지한다.</p>
<p><strong>Aim 모드에서의 통신</strong>: 군집 관제 상태에서 <strong>Aim 모드</strong>로 진입했을 때에만, 관제 소프트웨어는 두 드론의 상대 위치를 각 드론에 전송하여, 드론들이 상대편 드론을 조준할 수 있도록 한다. Aim 모드는 두 드론이 피사체에 대해 정밀하게 검사 장비를 조준하는 중요한 모드로, 이때만 드론 간 상호 위치 정보가 필요하다. 따라서 다른 비행 모드에서는 불필요한 위치 데이터 전송을 제한하고, Aim 모드에서만 최소한의 데이터가 전송되도록 설계하였다. 이로 인해 시스템은 무선 네트워크의 부담을 줄이면서, 필요한 시점에 정확한 데이터를 전송할 수 있게 된다.</p>
<h3 id="22">2.2 소프트웨어 구성</h3>
<p>비파괴 검사를 위한 두 대의 드론 제어 시스템에서 소프트웨어는 드론 제어, 상호 통신 등 다양한 기능을 담당한다. 이 소프트웨어 구성은 <strong>드론 펌웨어</strong>, <strong>군집 관제 소프트웨어</strong>로 나뉘며, 각각의 역할과 구성 요소는 다음과 같다.</p>
<h4 id="221">2.2.1 드론 펌웨어</h4>
<p><strong>아두파일럿(ArduPilot)</strong>은 오픈 소스 기반의 자율 비행 소프트웨어로, 다양한 드론, 비행기, 로봇 등의 제어를 지원하는 플랫폼이다. 아두파일럿은 다양한 하드웨어 플랫폼에서 실행 가능하며, 본 연구에서는 드론의 자동 비행과 상태 관리를 위해 아두파일럿을 사용한다. 이 시스템에서 아두파일럿이 담당하는 역할은 다음과 같다.</p>
<p><strong>비행 제어</strong>: 아두파일럿은 드론의 비행을 관리하는 주요 소프트웨어로, GPS 및 IMU(관성 측정 장치) 데이터를 활용하여 드론의 위치와 자세를 실시간으로 제어한다. 이를 통해 드론은 조종자의 개입 없이도 설정한 경로를 따라 정확히 이동할 수 있다. 경로는 관제 소프트웨어에서 설정되며, 아두파일럿은 이 경로를 따라 비행하도록 명령을 처리한다.</p>
<p><strong>비행 모드 관리</strong>: 아두파일럿은 다양한 비행 모드를 제공하여 드론이 상황에 맞게 동작할 수 있도록 한다. 본 연구에서 사용하는 비행 모드는 두 가지로 구분된다.</p>
<ol>
<li><strong>군집 관제 소프트웨어가 제어하는 경우</strong>:</li>
<li><strong>Guided 모드</strong>: 드론이 군집 관제 소프트웨어에서 지정한 경로에 따라 자동으로 비행하며, 실시간 명령에 따라 위치를 조정할 수 있다.</li>
<li><strong>Takeoff 모드</strong>: 드론이 군집 관제 소프트웨어 명령에 따라 자동으로 이륙하여 설정된 고도에 도달한다.</li>
<li><strong>Land 모드</strong>: 드론이 자동으로 착륙하여 안전하게 지면에 닿을 수 있도록 한다.</li>
<li><strong>RTL (Return to Launch) 모드</strong>: 드론이 자동으로 출발 지점으로 복귀하여 착륙하는 모드이다. 배터리 부족이나 긴급 상황 시 사용된다.</li>
<li>
<p><strong>Brake 모드</strong>: 드론을 즉시 정지시키는 모드로, 긴급 상황에서 사용된다.</p>
</li>
<li>
<p><strong>긴급 상황에서 인간 조종자가 제어하는 경우</strong>:</p>
</li>
<li><strong>Loiter 모드</strong>: 긴급 상황에서 조종자가 드론을 수동으로 제어해야 할 때 사용된다. 이 모드에서는 드론이 GPS 기반 위치를 유지하며, 조종자는 드론을 필요한 대로 이동시킬 수 있다. 그러나 이 모드는 긴급 상황에서만 사용되며, 대부분의 비행은 관제 소프트웨어에 의해 자동으로 제어된다.</li>
</ol>
<p><strong>센서 데이터 처리</strong>: 아두파일럿은 드론에 장착된 센서(GPS, IMU, 카메라 등)로부터 수집한 데이터를 실시간으로 처리한다. 이러한 데이터는 드론의 비행 경로와 자세를 제어하는 데 사용되며, 비행 중 드론의 안정성을 유지하고, 피사체를 정확히 조준하는 데 기여한다.</p>
<p><strong>MAVLink 프로토콜 통신</strong>: 아두파일럿은 MAVLink 프로토콜을 통해 관제 소프트웨어와 통신한다. MAVLink는 경량의 메시지 전송 프로토콜로, 드론의 상태 정보를 관제 시스템에 실시간으로 전송하고, 관제 소프트웨어로부터 명령을 수신하여 드론의 비행 경로, 자세, 모드 전환 등을 수행한다. 예를 들어, 관제 소프트웨어에서 특정 명령(예: <strong>takeoff</strong>)을 전달하면, 아두파일럿은 해당 명령을 받아 드론을 이륙시키고, 지정된 고도에 도달하도록 한다.</p>
<p><strong>안전 관리</strong>: 아두파일럿은 비행 중 드론의 안정성과 안전을 확보하기 위한 다양한 기능을 제공한다. 예를 들어, 배터리 부족 시 <strong>rtl</strong> 모드를 자동으로 활성화하여 드론이 안전하게 출발 지점으로 복귀하도록 한다. 또한, 실시간 비행 상태 모니터링을 통해 이상 상태 발생 시 자동으로 대처할 수 있다.</p>
<p>이와 같이, 아두파일럿은 본 연구에서 두 대의 드론이 자율적으로 비파괴 검사를 수행할 수 있도록 하는 핵심적인 소프트웨어 역할을 하며, 드론의 비행 경로 제어, 센서 데이터 처리, 실시간 통신 및 안전 관리 등을 통합적으로 수행한다.</p>
<h4 id="222">2.2.2 군집 관제 소프트웨어</h4>
<p>군집 관제 소프트웨어는 지상에서 두 대의 드론을 동시에 제어하고, 드론 간 상호 통신을 지원하며, 비파괴 검사를 수행하는 임무를 조율하는 핵심 요소이다. 이 소프트웨어는 <strong>MAVLink 프로토콜</strong>을 사용하여 드론과 실시간으로 데이터를 주고받으며, 드론의 상태를 모니터링하고 조종자의 명령을 드론에 전달하는 역할을 한다. 군집 관제 소프트웨어는 두 가지 주요 제어 체계를 가지고 있다: <strong>개별 드론 제어</strong>와 <strong>군집 드론 제어</strong>.</p>
<h4 id="223_1">2.2.3 군집 상태 관리</h4>
<p>군집 상태 관리는 상태 전이 다이어그램을 기반으로 설계되었다. 이 다이어그램은 군집의 상태를 정의한다. 군집 상태는 다음과 같은 상태로 정의된다:</p>
<ul>
<li><strong>Idle 상태</strong>: 군집이 대기 중이거나, 인간 조종자가 수동 관제하는 상태.</li>
<li><strong>Flightcheck</strong>: 개별 드론의 기능을 점검하는 상태.</li>
<li><strong>Takeoff 상태</strong>: 군집이 동시에 이륙하여 설정된 고도까지 상승하는 상태.</li>
<li><strong>Freeze 상태</strong>: 비행 중 비상 정지 명령이 내려졌을 때 군집의 비행이 멈추는 상태.</li>
<li><strong>Land 상태</strong>: 임무 완료 또는 조종자의 명령에 의해 군집이 착륙하는 상태.</li>
<li><strong>RTL (Return to Launch) 상태</strong>: 임무가 중단되거나 종료될 때, 군집이 시작 지점으로 복귀하는 상태.</li>
<li><strong>AutoAim</strong>: 피사체에 대해 군집이 위치를 조정하며 비파괴 검사 장비를 피사체에 정확하게 조준하는 상태.</li>
<li><strong>Auto</strong>: 드론들이 자동으로 시동하고 이륙하여 비파괴 검사 임무를 수행하는 상태.</li>
</ul>
<p>군집 상태는 조종자의 명령에 따라 절차적으로 전이되며, 한 드론의 상태 변화에 따라 다른 드론도 적절히 반응하여 동기화된다. 예를 들어, 군집이 <strong>Aim</strong> 상태에 진입하면 두 드론은 상호 위치를 파악하고 피사체에 대해 정확한 조준을 유지한다.</p>
<p>군집 상태 <span class="arithmatex"><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> 전이 조건은 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
S(t) = \left\{
\begin{array}{ll}
S_{\text{idle}} &amp; \text{if} \ t = 0 \\
S_{\text{flightcheck}} &amp; \text{if} \ C_{\text{flightcheck}}(t) \\
S_{\text{takeoff}} &amp; \text{if} \ C_{\text{takeoff}}(t) \\
S_{\text{freeze}} &amp; \text{if} \ C_{\text{freeze}}(t) \\
S_{\text{land}} &amp; \text{if} \ C_{\text{land}}(t) \\
S_{\text{rtl}} &amp; \text{if} \ C_{\text{rtl}}(t) \\
S_{\text{autoaim}} &amp; \text{if} \ C_{\text{autoaim}}(t) \\
S_{\text{auto}} &amp; \text{if} \ C_{\text{auto}}(t) \\
\end{array}
\right.
</div>
<script type="math/tex; mode=display">
S(t) = \left\{
\begin{array}{ll}
S_{\text{idle}} & \text{if} \ t = 0 \\
S_{\text{flightcheck}} & \text{if} \ C_{\text{flightcheck}}(t) \\
S_{\text{takeoff}} & \text{if} \ C_{\text{takeoff}}(t) \\
S_{\text{freeze}} & \text{if} \ C_{\text{freeze}}(t) \\
S_{\text{land}} & \text{if} \ C_{\text{land}}(t) \\
S_{\text{rtl}} & \text{if} \ C_{\text{rtl}}(t) \\
S_{\text{autoaim}} & \text{if} \ C_{\text{autoaim}}(t) \\
S_{\text{auto}} & \text{if} \ C_{\text{auto}}(t) \\
\end{array}
\right.
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">S(t)</span><script type="math/tex">S(t)</script></span>는 시간 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span>에서의 군집 상태이며, 각 상태 전이 조건은 <span class="arithmatex"><span class="MathJax_Preview">C_x(t)</span><script type="math/tex">C_x(t)</script></span>로 정의된다. 예를 들어, <span class="arithmatex"><span class="MathJax_Preview">C_{\text{takeoff}}(t)</span><script type="math/tex">C_{\text{takeoff}}(t)</script></span>는 조종자가 <strong>takeoff</strong> 명령을 내렸을 때 성립하는 조건을 의미하며, 이 조건이 만족되면 군집 상태는 <strong>takeoff</strong>로 전이된다.</p>
<p>군집 상태 관리는 조종자의 명령에 따라 군집 상태를 전이하고, 각 드론의 상태를 실시간으로 조정하는 역할을 한다. 군집 상태 관리는 다음과 같은 절차로 구성된다:</p>
<ol>
<li>
<p><strong>조종자 명령 수신</strong>: 조종자는 관제 소프트웨어를 통해 군집 상태 전이 명령을 내린다. 예를 들어, <strong>takeoff</strong> 명령이 내려지면 군집 상태가 <strong>takeoff</strong>로 전이된다.</p>
</li>
<li>
<p><strong>상태 전이 조건 확인</strong>: 각 군집 상태의 전이 조건을 확인하여 해당 조건이 충족되면 군집 상태를 전이한다. 상태 전이 조건은 조종자 명령 또는 드론의 센서 데이터에 기반하여 결정된다. 예를 들여, <strong>takeoff</strong> 상태가 완료되면 <strong>idle</strong>상태로 전이 된다.</p>
</li>
<li>
<p><strong>상대 위치 조정</strong>: 군집 상태가 전이된 후, 두 드론 간의 상대적 위치를 계산하고 가상 평면을 중심으로 지정된 거리를 유지하도록 제어한다. 이때, GPS 및 IMU 데이터를 이용하여 두 드론의 상대 위치를 실시간으로 추정하고 보정한다.</p>
</li>
<li>
<p><strong>임무 수행</strong>: 군집 상태가 <strong>aim</strong> 또는 <strong>auto</strong>로 전이되면, 드론은 가상 평면을 기준으로 비행하며 비파괴 검사를 수행한다. 이때, 관제 소프트웨어는 실시간으로 드론의 상태를 모니터링하고, 필요한 경우 군집 상태를 다시 전이한다.</p>
</li>
<li>
<p><strong>임무 완료 및 착륙</strong>: 임무가 완료되거나, 조종자의 명령에 의해 군집 상태가 <strong>land</strong> 또는 <strong>RTL</strong> 전이되고 두 드론은 착륙한다.</p>
</li>
</ol>
<p>군집 상태 관리를 통해, 군집 드론이 피사체의 가상 평면을 정확하게 비행하며 비파괴 검사를 수행하는 과정을 명확히 관제 할 수 있다. 이러한 군집 제어 방식은 두 드론 간의 상호 의존성을 기반으로 하며, 실시간 데이터 교환과 상태 전이를 통해 안정적인 비파괴 검사를 가능하게 한다.</p>
<h4 id="224">2.2.4 개별 드론 상태</h4>
<p>관제 소프트웨어는 군집 상태뿐만 아니라 각 드론의 개별 상태도 관리한다. 개별 드론은 독립적으로 조종될 수 있으며, 특정 상황에서는 한 대의 드론만 상태를 전환하거나 동작을 수행할 수 있다. 주요 개별 드론 상태는 다음과 같다:</p>
<ul>
<li><strong>Idle</strong>: 개별 드론이 대기 중인 상태.</li>
<li><strong>Flightcheck</strong>: 개별 드론의 기능을 점검하는 상태.</li>
<li><strong>Arm</strong>: 드론이 이륙 준비가 완료된 상태.</li>
<li><strong>Takeoff</strong>: 드론이 이륙하여 설정된 고도까지 상승하는 상태.</li>
<li><strong>Brake</strong>: 비행 중인 드론이 정지하여 움직임을 멈춘 상태.</li>
<li><strong>Land</strong>: 드론이 착륙하는 상태.</li>
<li><strong>RTL (Return to Launch)</strong>: 드론이 출발 위치로 복귀하는 상태.</li>
<li><strong>Aim</strong>: 개별 드론이 피사체에 대해 조준을 맞추는 상태.</li>
</ul>
<p>이러한 개별 상태 전이는 군집 상태 관리 모듈이 조종자의 명령이나 드론의 비행 상태를 실시간으로 모니터링하고, 필요에 따라 명령을 전달함으로써 이루어진다.</p>
<p>개별 드론 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>의 상태 <span class="arithmatex"><span class="MathJax_Preview">S_d</span><script type="math/tex">S_d</script></span> 전이 조건 <span class="arithmatex"><span class="MathJax_Preview">C_d</span><script type="math/tex">C_d</script></span>는 다음과 같다:
$$
S_n(t) = \left{
\begin{array}{ll}
S_{d,\text{idle}} &amp; \text{if} \ t = 0 \
S_{d,\text{flightcheck}} &amp; \text{if} \ C_{d,\text{flightcheck}}(t) \
S_{d,\text{arm}} &amp; \text{if} \ C_{d,\text{arm}}(t) \
S_{d,\text{takeoff}} &amp; \text{if} \ C_{d,\text{takeoff}}(t) \
S_{d,\text{brake}} &amp; \text{if} \ C_{d,\text{brake}}(t) \
S_{d,\text{land}} &amp; \text{if} \ C_{d,\text{land}}(t) \
S_{d,\text{rtl}} &amp; \text{if} \ C_{d,\text{rtl}}(t) \
S_{d,\text{aim}} &amp; \text{if} \ C_{d,\text{aim}}(t) \
\end{array}
\right.
$$</p>
<h4 id="225">2.2.5 군집과 개별 드론 상태</h4>
<p>조종자의 명령과 </p>
<div class="mermaid">stateDiagram-v2
    direction LR    
    classDef badBadEvent font-weight:bold,stroke-width:2px

    state "S_idle" as idle
    state "S_flightcheck" as flightcheck
    state "S_land" as land
    state "S_rtl" as rtl
    state "S_takeoff" as takeoff
    state "S_autoaim" as autoaim
    state "S_auto" as auto
    state "S_freeze" as freeze   

    [*] --&gt; idle

    idle --&gt; flightcheck: if user commands flightcheck
    flightcheck --&gt; idle: if completed
    flightcheck --&gt; freeze: if fail
    state flightcheck {
        direction LR
        state "S_d,flightcheck" as d_flightcheck*
        [*] --&gt; d_flightcheck*
        d_flightcheck* --&gt; [*]: if completed
    }

    idle --&gt; takeoff: if user commands takeoff
    takeoff --&gt; idle: if completed
    takeoff --&gt; freeze: if fail
    state takeoff {
        direction LR
        state "S_d,flightcheck" as d_flightcheck**
        state "S_d,arm" as d_arm**
        state "S_d,takeoff" as d_takeoff**
        [*] --&gt; d_flightcheck**
        d_flightcheck** --&gt; d_arm**: if completed
        d_arm** --&gt; d_arm**: trials
        d_arm** --&gt; d_takeoff**: if completed
        d_takeoff** --&gt; d_takeoff**: trials
        d_takeoff** --&gt; [*]: if completed
    }

    idle --&gt; land: if user commands land
    land --&gt; idle: if completed
    land --&gt; freeze: if fail
    state land {
        direction LR
        state "S_d_land" as d_land***
        [*] --&gt; d_land***
        d_land*** --&gt; d_land***: repeatly
        d_land*** --&gt; [*]: if completed
    }

    idle --&gt; rtl: if user commands RTL
    rtl --&gt; idle: completed
    rtl --&gt; freeze: if fail
    state rtl {
        direction LR
        state "S_d,rtl" as d_rtl****
        [*] --&gt; d_rtl****
        d_rtl**** --&gt; d_rtl****: repeatly
        d_rtl**** --&gt; [*]: if completed
    }

    idle --&gt; autoaim: User can command when in air
    autoaim --&gt; freeze: if fail
    autoaim --&gt; idle: if stop
    state autoaim {
        direction LR
        state "S_d,aim" as d_aim*****
        [*] --&gt; d_aim*****
        d_aim***** --&gt; d_aim*****: repeatly     
        d_aim***** --&gt; [*]: if stop
    }    

    idle --&gt; auto: if user commands automatic mission execution
    auto --&gt; freeze:::badBadEvent: if fail
    auto --&gt; idle: if stop
    state auto {
        direction LR
        state "S_d,flightcheck" as d_flightcheck!
        state "S_d,arm" as d_arm!
        state "S_d,takeoff" as d_takeoff!
        state "S_d,aim" as d_aim!

        [*] --&gt; d_flightcheck!
        d_flightcheck! --&gt; d_arm!: if completed
        d_arm! --&gt; d_arm!: trials
        d_arm! --&gt; d_takeoff!: if completed
        d_takeoff! --&gt; d_takeoff!: trials
        d_takeoff! --&gt; d_aim!: if completed
        d_aim! --&gt; d_aim!: repeatly
        d_aim! --&gt; [*]: if stop
    }   

    freeze --&gt; idle: if user commands to transit to idle
    state freeze {
        [*] --&gt; brake
        brake --&gt; brake: repeatly
    }
</div>
<h4 id="226">2.2.6 탐색 절차</h4>
<ul>
<li>피사체에 대한 가상 평면 생성 </li>
<li>가상 평면을 원점으로 드론의 국소 좌표 계산</li>
<li>드론의 위치를 가상 평면상으로 투영하고 가상 평면상에서 드론 이동, 주어진 거리만큼 간격 유지</li>
<li>계산된 위치로 드론 이동</li>
</ul>
<h4 id="227">2.2.7 피사체 가상 평면 생성</h4>
<p>본 연구에서 두 대의 드론은 피사체를 사이에 두고 비파괴 검사를 수행하기 위해, 피사체와 드론 간의 상대적 거리를 유지하면서 정확한 검사를 수행해야 한다. 이를 위해 드론 사이에  <strong>가상 평면</strong>이 생성한다. 이 평면은 드론의 GPS 위치로부터 중간 지점을 기준으로 하여 위치, 방위각을 계산하여 설정된다.</p>
<p>두 대의 드론은 각각 실시간으로 GPS 좌표를 측정한다. 각 드론 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>의 위치 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{g}_d</span><script type="math/tex">\mathbf{g}_d</script></span>는
$$
\mathbf{g}_d = (\phi_d, \lambda_d, h)
$$
로 정의되며, 여기서, <span class="arithmatex"><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span>는 위도, <span class="arithmatex"><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>는 경도, <span class="arithmatex"><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>는 상대 고도이다.</p>
<p><strong>군집 중심 위치 계산</strong>: 두 드론의 GPS좌표는 라디안 단위 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{g}_1=(\dot{\phi}_1, \dot{\lambda}_1, h_1)</span><script type="math/tex">\mathbf{g}_1=(\dot{\phi}_1, \dot{\lambda}_1, h_1)</script></span>와 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{g}_2=(\dot{\phi}_2, \dot{\lambda}_2, h_2)</span><script type="math/tex">\mathbf{g}_2=(\dot{\phi}_2, \dot{\lambda}_2, h_2)</script></span>로 두 점 사이의 대원(지구 표면을 따라 그린 가장 짧은 경로)을 따라 중간 위치를 가상 평면의 원점으로 계산한다. 중간 위치의 위도와 경도 <span class="arithmatex"><span class="MathJax_Preview">(\dot{\phi}_o, \dot{\lambda}_o, h_o)</span><script type="math/tex">(\dot{\phi}_o, \dot{\lambda}_o, h_o)</script></span>는 다음과 같이 계산할 수 있다:
$$
\begin{align<em>}
\dot{x}_c &amp;= \cos(\dot{\phi}_2) \cdot \cos(\dot{\lambda}_2 - \dot{\lambda}_1)
\
\dot{y}_c &amp;= \cos(\dot{\phi}_2) \cdot \sin(\dot{\lambda}_2 - \dot{\lambda}_1)
\
\dot{\phi}_o &amp;= \tan^{-1}\left(\frac{\sin(\dot{\phi}_1) + \sin(\dot{\phi}_2)}{\sqrt{(\cos(\dot{\phi}_1) + {\dot{x}}_c)^2 + \dot{y}_c^2}}\right)
\
\dot{\lambda}_o &amp;= \dot{\lambda}_1 + \tan^{-1}\left(\frac{\dot{y}_c}{\cos(\dot{\phi}_1) + \dot{x}_c}\right)
\
h_o &amp;= \frac{h_2-h_1}{2}
\end{align</em>}
$$</p>
<p><strong>군집 방위각 계산</strong>:</p>
<p>지구 표면에서 특정 위치에서 지구의 타원체와 중력 방향으로 수직인 평면을 수평면이라고 한다. 수평면에 두대의 드론이 위치할때 두 드론의 중간 위치의 수평면 위에서 직교 벡터의 방향을 군집 드론의 방위각으로 정하였다. 군집 방위각은 가상 평면의 방위각에 해당 한다.</p>
<p>군집 방위각(azimuth) <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>를 계산한다:
$$
\begin{align<em>}
\Delta\dot{\lambda} &amp;= \dot{\lambda}_2 - \dot{\lambda}_1
\
\dot{\alpha} &amp;= \tan^{-1} \left( \frac{\sin(\Delta\dot{\lambda}) \cdot \cos(\dot{\phi}_2)}{\cos(\dot{\phi}_1) \cdot \sin(\dot{\phi}_2) - \sin(\dot{\phi}_1) \cdot \cos(\dot{\phi}_2) \cdot \cos(Δ\dot{\lambda})} \right)
\
\alpha &amp;= (\dot{\alpha} \cdot \frac{180}{\pi} + 360) \mod \, 360
\
\end{align</em>}
$$</p>
<h4 id="227_1">2.2.7 가상 평면상에서 드론 관제</h4>
<p>반경 수백미터 이내의 제한된 영역에서 피사체를 기준으로 비행 경로를 다루기 위해서는 피사체를 원점으로 하는 ENU 좌표계로 변환하여 비행 경로를 계산하면 간결해진다.</p>
<p>먼저, 라디안 단위 GPS 좌표계 위도 <span class="arithmatex"><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span>, 경도 <span class="arithmatex"><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>, 고도 <span class="arithmatex"><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>를 ECEF 좌표 <span class="arithmatex"><span class="MathJax_Preview">(x,y,z)</span><script type="math/tex">(x,y,z)</script></span>로 변환하는 방법은 다음과 같다:
$$
\begin{align<em>}
N &amp;= \dfrac{a}{\sqrt{1 - e^2 \sin^2 \phi}} \
x &amp;= (n + h) \cos \dot{\phi} \cos \dot{\lambda} \
y &amp;= (n + h) \cos \dot{\phi} \sin \dot{\lambda} \
z &amp;= \left( N (1 - e^2) + h \right) \sin \dot{\phi}
\end{align</em>}
\tag{1}
$$
여기서 <span class="arithmatex"><span class="MathJax_Preview">e^2</span><script type="math/tex">e^2</script></span>는 이심률로 <span class="arithmatex"><span class="MathJax_Preview">1 - \left( \dfrac{b}{a} \right)^2</span><script type="math/tex">1 - \left( \dfrac{b}{a} \right)^2</script></span> 이며, <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>는 지구의 장축 반경으로 약 <span class="arithmatex"><span class="MathJax_Preview">6,378,137 \space m</span><script type="math/tex">6,378,137 \space m</script></span> 이고, <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span>는 단축 반경으로 <span class="arithmatex"><span class="MathJax_Preview">a(1 - 1/298.257223563)</span><script type="math/tex">a(1 - 1/298.257223563)</script></span>이다.</p>
<p>식 <span class="arithmatex"><span class="MathJax_Preview">(1)</span><script type="math/tex">(1)</script></span>으로 가상 평면 원점의 GPS 좌표로부터 가상 평면의 원점 ECEF 좌표 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_o = (x_o, y_o, z_o)</span><script type="math/tex">\mathbf{p}_o = (x_o, y_o, z_o)</script></span>와 드론의 ECEF 좌표 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_d = (x_d, y_d, z_d)</span><script type="math/tex">\mathbf{p}_d = (x_d, y_d, z_d)</script></span>를 구하며, 가상평면 원점의 국소 좌표 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_o</span><script type="math/tex">\dot{\mathbf{p}}_o</script></span>과 가상 평면을 원점으로 하는 드론의 국소 좌표 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_d = (\dot{x}_d, \dot{y}_d, \dot{z}_d)</span><script type="math/tex">\dot{\mathbf{p}}_d = (\dot{x}_d, \dot{y}_d, \dot{z}_d)</script></span>를 계산 한다.
$$
\dot{\mathbf{p}}_d = \mathbf{p}_d - \mathbf{p}_o \
\dot{\mathbf{p}}_o = \mathbf{p}_o - \mathbf{p}_o \
\tag{2}
$$
가상 평면의 법선 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{n}</span><script type="math/tex">\mathbf{n}</script></span>은 다음과 같다:
$$
\mathbf{n} = \begin{bmatrix}
-\cos \dot{\alpha} &amp; \sin \dot{\alpha} &amp; 0 \
-\sin \dot{\alpha} &amp; -\cos \dot{\alpha} &amp; 0 \
0 &amp; 0 &amp; 1 \
\end{bmatrix}
\cdot
\begin{bmatrix}
0 \
0 \
-1
\end{bmatrix}
$$
가상 평면은 법선 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{n}</span><script type="math/tex">\mathbf{n}</script></span>과 원점 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_o</span><script type="math/tex">\dot{\mathbf{p}}_o</script></span> 을 사용하여 다음과 같이 표현할 수 있다.
$$
(\mathbf{x} - \dot{\mathbf{p}}_o) \cdot \mathbf{n} = 0
$$
여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{x}</span><script type="math/tex">\mathbf{x}</script></span>는 평면 위의 임의의 점으로 점 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{x}</span><script type="math/tex">\mathbf{x}</script></span>가 평면에 있을 때 성립한다.</p>
<p><strong>교점 계산</strong>: 이제 선의 방정식을 평면의 방정식에 대입하여 교점을 찾는다. 즉, 선 위의 임의의 점 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{r}(t)</span><script type="math/tex">\mathbf{r}(t)</script></span>이 평면 방정식을 만족하는 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span>를 구하는 과정이다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{align*}
(\mathbf{r}(t) - \dot{\mathbf{p}}) \cdot \mathbf{n} &amp;= 
((\dot{\mathbf{p}}_1 + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1)) - \dot{\mathbf{p}}) \cdot \mathbf{n}
\\
&amp;= ((\dot{\mathbf{p}}_1 - \dot{\mathbf{p}}) + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1)) \cdot \mathbf{n}
\\
&amp;= (\dot{\mathbf{p}}_1 - \dot{\mathbf{p}}) \cdot \mathbf{n} + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1) \cdot \mathbf{n}
\end{align*}
</div>
<script type="math/tex; mode=display">
\begin{align*}
(\mathbf{r}(t) - \dot{\mathbf{p}}) \cdot \mathbf{n} &= 
((\dot{\mathbf{p}}_1 + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1)) - \dot{\mathbf{p}}) \cdot \mathbf{n}
\\
&= ((\dot{\mathbf{p}}_1 - \dot{\mathbf{p}}) + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1)) \cdot \mathbf{n}
\\
&= (\dot{\mathbf{p}}_1 - \dot{\mathbf{p}}) \cdot \mathbf{n} + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1) \cdot \mathbf{n}
\end{align*}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
t = -\frac{(\dot{\mathbf{p}}_1 - \dot{\mathbf{p}}) \cdot \mathbf{n}}{(\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1) \cdot \mathbf{n}}
</div>
<script type="math/tex; mode=display">
t = -\frac{(\dot{\mathbf{p}}_1 - \dot{\mathbf{p}}) \cdot \mathbf{n}}{(\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1) \cdot \mathbf{n}}
</script>
</div>
<p>이때 <span class="arithmatex"><span class="MathJax_Preview">(\mathbf{p}_2 - \mathbf{p}_1) \cdot \mathbf{n} \ne 0</span><script type="math/tex">(\mathbf{p}_2 - \mathbf{p}_1) \cdot \mathbf{n} \ne 0</script></span> 이고, <span class="arithmatex"><span class="MathJax_Preview">t \in [0, 1]</span><script type="math/tex">t \in [0, 1]</script></span> 이면 교점이 존재 한다.</p>
<p>두 드론을 연결한 선분은 두 드론의 위치 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_1</span><script type="math/tex">\dot{\mathbf{p}}_1</script></span>과 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_2</span><script type="math/tex">\dot{\mathbf{p}}_2</script></span> 사이로 정의될 수 있으며, 가상 평면과 드론들과의 교점은 매개변수 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span>를 사용하여 다음과 같이 표현된다.
$$
\mathbf{r}(t) = \dot{\mathbf{p}}<em>1 + t (\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1)
$$
가상 평면상에서 교점으로부터 <span class="arithmatex"><span class="MathJax_Preview">\dot{\psi}</span><script type="math/tex">\dot{\psi}</script></span> 방향으로 <span class="arithmatex"><span class="MathJax_Preview">l</span><script type="math/tex">l</script></span> 만큼 이동하고, 가상 평면으로부터 법선 벡터 방향으로 <span class="arithmatex"><span class="MathJax_Preview">s_d</span><script type="math/tex">s_d</script></span> 만큼 이동한 위치는 동차 행렬을 적용하여 다음과 같이 계산 한다.
$$
\dot{\mathbf{p}}</em>{d,\text{new}} = \begin{bmatrix}
\cos \dot{\psi} &amp; -\sin \dot{\psi} &amp; 0 &amp; 0 \
\sin \dot{\psi} &amp; \cos \dot{\psi} &amp; 0 &amp; 0 \
0 &amp; 0 &amp; 1 &amp; 0 \
0 &amp; 0 &amp; 0 &amp; 1 \
\end{bmatrix}
\cdot
\begin{bmatrix}
0 \ l \ s_d \ 1 \
\end{bmatrix}
$$</p>
<p>이제 가상 평면 상의 드론의 국소 좌표계인 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_{d, \text{new}}</span><script type="math/tex">\dot{\mathbf{p}}_{d, \text{new}}</script></span>를 GPS 좌표 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{g}_{d,\text{new}}</span><script type="math/tex">\mathbf{g}_{d,\text{new}}</script></span>로 변환한다.
$$
p = \sqrt{X^2 + Y^2}
\
\hat{\phi} = \tan^{-1}\left( \frac{Z}{p(1 - e^2)} \right)
\
N = \frac{a}{\sqrt{1 - e^2 \sin^2(\hat{\phi})}}
\
h = \frac{p}{\cos(\hat{\phi})} - N
\
\phi = \tan^{-1}\left( \frac{Z}{p(1 - e^2 \frac{N}{N + h})} \right)
\
\lambda = \tan^{-1}\left( \frac{Y}{X} \right)
$$</p>
<p>점 P의 위치를 데카르트 좌표계에서 GPS 좌표(위도, 경도, 고도)로 변환하는 과정은 다음과 같다.</p>
<h3 id="1">1. 필요한 변수들</h3>
<ul>
<li>지구는 타원체 모델로 가정한다. 일반적으로 <strong>WGS84</strong> 모델을 사용한다.</li>
<li>지구 장반경(a): 6378137.0 m</li>
<li>지구 편평률(f): 1/298.257223563</li>
<li>
<p>지구 단반경(b): <span class="arithmatex"><span class="MathJax_Preview">b = a(1 - f)</span><script type="math/tex">b = a(1 - f)</script></span></p>
</li>
<li>
<p>O는 원점(GPS 좌표계)으로, O에서 P까지의 데카르트 좌표는 (X, Y, Z)로 주어진다.</p>
</li>
</ul>
<h3 id="2-gps">2. GPS 좌표로 변환하는 절차</h3>
<h4 id="21_1">2.1. 편평률 계산</h4>
<p>먼저 지구의 편평률에 따른 이심률 <span class="arithmatex"><span class="MathJax_Preview">e^2</span><script type="math/tex">e^2</script></span>을 계산해야 한다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
e^2 = \frac{a^2 - b^2}{a^2}
</div>
<script type="math/tex; mode=display">
e^2 = \frac{a^2 - b^2}{a^2}
</script>
</div>
<h4 id="22_1">2.2. 초기 추정</h4>
<p>처음에는 위도를 계산하기 위해 <span class="arithmatex"><span class="MathJax_Preview">p = \sqrt{X^2 + Y^2}</span><script type="math/tex">p = \sqrt{X^2 + Y^2}</script></span>를 계산한다.</p>
<p>위도의 첫 추정 값 <span class="arithmatex"><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span>는 다음과 같이 주어진다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\phi_0 = \tan^{-1}\left( \frac{Z}{p(1 - e^2)} \right)
</div>
<script type="math/tex; mode=display">
\phi_0 = \tan^{-1}\left( \frac{Z}{p(1 - e^2)} \right)
</script>
</div>
<h4 id="23">2.3. 반복 계산</h4>
<p>이제 다음 반복 과정을 통해 정확한 위도와 고도를 계산할 수 있다.</p>
<ol>
<li>첫 번째 근사치를 바탕으로 반경 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>을 계산한다:</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
N = \frac{a}{\sqrt{1 - e^2 \sin^2(\phi)}}
</div>
<script type="math/tex; mode=display">
N = \frac{a}{\sqrt{1 - e^2 \sin^2(\phi)}}
</script>
</div>
<ol>
<li>고도 <span class="arithmatex"><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>를 계산한다:</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
h = \frac{p}{\cos(\phi)} - N
</div>
<script type="math/tex; mode=display">
h = \frac{p}{\cos(\phi)} - N
</script>
</div>
<ol>
<li>새로운 위도 <span class="arithmatex"><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span> 값을 계산한다:</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
\phi = \tan^{-1}\left( \frac{Z}{p(1 - e^2 \frac{N}{N + h})} \right)
</div>
<script type="math/tex; mode=display">
\phi = \tan^{-1}\left( \frac{Z}{p(1 - e^2 \frac{N}{N + h})} \right)
</script>
</div>
<p>이 과정은 위도의 값이 수렴할 때까지 반복한다.</p>
<h4 id="24">2.4. 경도 계산</h4>
<p>경도 <span class="arithmatex"><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>는 다음과 같이 계산된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\lambda = \tan^{-1}\left( \frac{Y}{X} \right)
</div>
<script type="math/tex; mode=display">
\lambda = \tan^{-1}\left( \frac{Y}{X} \right)
</script>
</div>
<h3 id="3">3. 결과</h3>
<p>최종적으로 점 P의 GPS 좌표는 위도 <span class="arithmatex"><span class="MathJax_Preview">\phi</span><script type="math/tex">\phi</script></span>, 경도 <span class="arithmatex"><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span>, 고도 <span class="arithmatex"><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>로 주어진다.</p>
<h4 id="228">2.2.8 가상 평면상에서 드론의 위치와 이동</h4>
<p>가상 평면은 위치 벡터와 노름 벡터로 정의 될 수 있다. 식 <span class="arithmatex"><span class="MathJax_Preview">(2)</span><script type="math/tex">(2)</script></span>에서 가상 평면은 국소 좌표계 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_o</span><script type="math/tex">\dot{\mathbf{p}}_o</script></span>이며, </p>
<div class="arithmatex">
<div class="MathJax_Preview">
</div>
<script type="math/tex; mode=display">
</script>
</div>
<p>두 드론의 국소 좌표인 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_1 = (\dot{x}_1, \dot{y}_1, \dot{z}_1)</span><script type="math/tex">\dot{\mathbf{p}}_1 = (\dot{x}_1, \dot{y}_1, \dot{z}_1)</script></span>와 <span class="arithmatex"><span class="MathJax_Preview">\dot{\mathbf{p}}_2 = (\dot{x}_2, \dot{y}_2, \dot{z}_2)</span><script type="math/tex">\dot{\mathbf{p}}_2 = (\dot{x}_2, \dot{y}_2, \dot{z}_2)</script></span>, 그리고 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_o = (x_o, y_o, z_o)</span><script type="math/tex">\mathbf{p}_o = (x_o, y_o, z_o)</script></span>와 <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>를 기반으로 가상 평면과 두 드론의 국소 좌표를 이은 선의 교점을 구한다.</p>
<p>가상 평면의 위치는 $$</p>
<p><strong>평면 방정식</strong>: 가상 평면의 방위각이 <span class="arithmatex"><span class="MathJax_Preview">\dot{\alpha}</span><script type="math/tex">\dot{\alpha}</script></span>로 주어졌다면, 방위각을 사용해 평면의 법선 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{n}</span><script type="math/tex">\mathbf{n}</script></span>을 구할 수 있다. 방위각 <span class="arithmatex"><span class="MathJax_Preview">\dot{\alpha}</span><script type="math/tex">\dot{\alpha}</script></span>가 주어졌다면, 법선 벡터는 다음과 같이 정의된다:
$$
\mathbf{n} = (\cos(\dot{\alpha}), \sin(\dot{\alpha}), 0)
$$</p>
<p>이 법선 벡터를 이용해, 평면의 방정식은 다음과 같이 나타낼 수 있다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{n} \cdot (\hat{\mathbf{p}}_d - \dot{\mathbf{p}}_o) = 0
</div>
<script type="math/tex; mode=display">
\mathbf{n} \cdot (\hat{\mathbf{p}}_d - \dot{\mathbf{p}}_o) = 0
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\cos(\dot{\alpha})(x - x_o) + \sin(\dot{\alpha})(y - y_o) = 0
</div>
<script type="math/tex; mode=display">
\cos(\dot{\alpha})(x - x_o) + \sin(\dot{\alpha})(y - y_o) = 0
</script>
</div>
<p>이를 확장하면 평면 방정식은 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\cos(\dot{\alpha}) x + \sin(\dot{\alpha}) y = \cos(\dot{\alpha}) x_o + \sin(\dot{\alpha}) y_o
</div>
<script type="math/tex; mode=display">
\cos(\dot{\alpha}) x + \sin(\dot{\alpha}) y = \cos(\dot{\alpha}) x_o + \sin(\dot{\alpha}) y_o
</script>
</div>
<p><strong>선 방정식</strong>: 두 드론을 이은 선의 방정식을 구하려면, 매개변수 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span>에 따라 두 점을 연결하는 선을 정의할 수 있다. 선의 방정식은 다음과 같다:
$$
\mathbf{p}(t) = \dot{\mathbf{p}}_1 + t(\dot{\mathbf{p}}_2 - \dot{\mathbf{p}}_1)
$$</p>
<p>이것을 좌표 형태로 나타내면:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{p}(t) = (\dot{x}_1 + t(\dot{x}_2 - \dot{x}_1), \dot{y}_1 + t(\dot{y}_2 - \dot{y}_1), \dot{z}_1 + t(\dot{z}_2 - \dot{z}_1))
</div>
<script type="math/tex; mode=display">
\mathbf{p}(t) = (\dot{x}_1 + t(\dot{x}_2 - \dot{x}_1), \dot{y}_1 + t(\dot{y}_2 - \dot{y}_1), \dot{z}_1 + t(\dot{z}_2 - \dot{z}_1))
</script>
</div>
<p><strong>교점 구하기</strong>: 이제 평면 방정식과 선 방정식을 결합하여 교점을 구할 수 있다. 선 방정식에서 <span class="arithmatex"><span class="MathJax_Preview">x(t)</span><script type="math/tex">x(t)</script></span>와 <span class="arithmatex"><span class="MathJax_Preview">y(t)</span><script type="math/tex">y(t)</script></span>를 평면 방정식에 대입하면:
$$
\cos(\dot{\alpha})(\dot{x}_1 + t(\dot{x}_2 - \dot{x}_1)) + \sin(\dot{\alpha})(\dot{y}_1 + t(\dot{y}_2 - \dot{y}_1)) = \cos(\dot{\alpha}) x_o + \sin(\dot{\alpha}) y_o
$$</p>
<p>위 식에서 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span>를 풀면, 교점에서의 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 값을 구할 수 있다.</p>
<p><span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 값 구하기:
$$
t = \frac{\cos(\dot{\alpha})(x_o - \dot{x}_1) + \sin(\dot{\alpha})(y_o - \dot{y}_1)}{\cos(\dot{\alpha})(\dot{x}_2 - \dot{x}_1) + \sin(\dot{\alpha})(\dot{y}_2 - \dot{y}_1)}
$$</p>
<p>여기서, <span class="arithmatex"><span class="MathJax_Preview">\cos(\dot{\alpha})(\dot{x}_2 - \dot{x}_1) + \sin(\dot{\alpha})(\dot{y}_2 - \dot{y}_1) \ne 0</span><script type="math/tex">\cos(\dot{\alpha})(\dot{x}_2 - \dot{x}_1) + \sin(\dot{\alpha})(\dot{y}_2 - \dot{y}_1) \ne 0</script></span>이다.</p>
<p>구한 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> 값을 선 방정식 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}(t)</span><script type="math/tex">\mathbf{p}(t)</script></span>에 대입하면 교점의 좌표가 나온다:
$$
\mathbf{p}_\text{intersection} = (\dot{x}_1 + t(\dot{x}_2 - \dot{x}_1), \dot{y}_1 + t(\dot{y}_2 - \dot{y}_1), \dot{z}_1 + t(\dot{z}_2 - \dot{z}_1))
$$</p>
<p>이렇게 해서 두 드론을 연결하는 선과 가상 평면의 교점을 구할 수 있다.</p>
<p>먼저, 각 드론 <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>의 로컬 좌표 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{q}_d = (x_d, y_d, z_d)</span><script type="math/tex">\mathbf{q}_d = (x_d, y_d, z_d)</script></span>를 얻는다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
R(\dot{\phi}) = \frac{a (1 - e^2)}{(1 - e^2 \sin^2(\dot{\phi}))^{3/2}}
\\
x_d = (\dot{\lambda}_2 - \dot{\lambda}_1) \cdot \cos(\dot{\phi}) \cdot R(\dot{\phi})
\\
y_d = R_{\dot{\phi}} \cdot | \dot{\phi}_2 - \dot{\phi}_1|
\\
z_d = \text{각 드론의 상대 고도. 가상 평면은 군집 위치의 상대 고도 기준}
</div>
<script type="math/tex; mode=display">
R(\dot{\phi}) = \frac{a (1 - e^2)}{(1 - e^2 \sin^2(\dot{\phi}))^{3/2}}
\\
x_d = (\dot{\lambda}_2 - \dot{\lambda}_1) \cdot \cos(\dot{\phi}) \cdot R(\dot{\phi})
\\
y_d = R_{\dot{\phi}} \cdot | \dot{\phi}_2 - \dot{\phi}_1|
\\
z_d = \text{각 드론의 상대 고도. 가상 평면은 군집 위치의 상대 고도 기준}
</script>
</div>
<p>여기서, <span class="arithmatex"><span class="MathJax_Preview">R(\phi)</span><script type="math/tex">R(\phi)</script></span>은 위도에 따른 지구의 반경, <span class="arithmatex"><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>는 적도 반지름(지구의 반지름, 약 6,378,137m), <span class="arithmatex"><span class="MathJax_Preview">e</span><script type="math/tex">e</script></span>는 이심률(eccentricity, 약 0818191908426) 이다.</p>
<p>군집은 가상 평면의 현재 위치에서 지정한 방향으로 지정한 거리만큼 이동하며 비파괴 검사를 수행하므로 먼저 군집의 가상 평면상 위치를 구한다 [Vincenty1975].</p>
<p>가상평면은 로컬 좌표계에서 <span class="arithmatex"><span class="MathJax_Preview">(0, 0)</span><script type="math/tex">(0, 0)</script></span> 위치하고, 방위각 <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>만큼 회전되어 있는 상태이며 </p>
<p>두 드론의 로컬 위치와 가상 평면상 교점을 구한다.</p>
<p>방위각 <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>으로부터 가상평면의 노름 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{s}</span><script type="math/tex">\mathbf{s}</script></span>을 구한다: TODO 노름
$$
\mathbf{s} = \begin{bmatrix}
-\cos \dot{\alpha} &amp; \sin \dot{\alpha} &amp; 0 \
-\sin \dot{\alpha} &amp; -\cos \dot{\alpha} &amp; 0 \
0 &amp; 0 &amp; 1 \
\end{bmatrix}
\cdot
\begin{bmatrix}
0 \
0 \
-1
\end{bmatrix}
$$</p>
<h3 id="334">3.3.4 가상 평면 적용</h3>
<p>가상 평면은 피사체를 중심으로 설정되며, 두 드론은 이 평면을 기준으로 일정한 거리와 각도를 유지하면서 검사 작업을 수행한다. 관제 소프트웨어는 피사체의 위치와 방위각, 기울기를 실시간으로 계산하고, 이를 바탕으로 드론의 비행 경로를 조정하여 피사체에 대한 정확한 비파괴 검사를 가능하게 한다. 이 가상 평면을 통해 드론 간 상호 조준이 이루어지며, 피사체에 대한 검사는 일정한 거리를 유지하며 효율적으로 진행된다.</p>
<h3 id="335">3.3.5 향후 과제</h3>
<p>본 연구에서 제안한 가상 평면 생성 방법은 두 드론 간의 상대적인 위치와 자세를 정확하게 조정할 수 있는 기반을 제공한다. 향후 연구에서는 더 정밀한 센서 데이터를 활용하여 피사체의 3차원 형상을 보다 정확하게 추정하고, 더욱 복잡한 검사 경로 계획을 수립하는 방법에 대해 연구할 예정이다.</p>
<p>[끝]</p>
<ol>
<li><strong>경로 계획 및 가상 평면 생성</strong></li>
</ol>
<p>관제 소프트웨어는 두 대의 드론이 비파괴 검사를 수행할 피사체를 기준으로 경로를 설정하고, 이 경로를 따라 군집 비행을 수행하도록 한다. 이때, 소프트웨어는 두 드론 사이에 <strong>가상의 평면</strong>을 생성하여 피사체를 중심으로 대칭적인 위치를 유지하도록 조정한다.</p>
<ul>
<li><strong>가상 평면</strong>은 두 드론이 피사체를 기준으로 일정 거리를 유지하며, 동기화된 경로를 따라 이동할 수 있도록 가이드라인 역할을 한다.</li>
<li>
<p><strong>경로 계획</strong>은 조종자의 설정에 따라 이루어지며, 검사 구역의 크기와 드론 간의 이동 속도 등을 고려하여 설정한다. 드론은 이 경로를 따라 이동하면서, 비파괴 검사 장비를 통해 영상 데이터를 취득한다.</p>
</li>
<li>
<p><strong>실시간 상태 모니터링 및 데이터 처리</strong></p>
</li>
</ul>
<p>관제 소프트웨어는 MAVLink 프로토콜을 통해 드론으로부터 실시간 상태 데이터를 수신한다. 이러한 데이터는 드론의 위치, 고도, 속도, 배터리 상태, 각종 센서 데이터(IMU, GPS 등) 등을 포함하며, 실시간으로 조종자에게 피드백을 제공한다. 또한, 조종자는 이를 통해 즉각적인 제어 명령을 내릴 수 있다.</p>
<ul>
<li><strong>드론 상태 시각화</strong>: 소프트웨어는 드론의 실시간 위치 및 상태를 시각적으로 모니터링할 수 있도록 화면에 표시한다. 이를 통해 조종자는 각 드론이 정확하게 임무를 수행하고 있는지 확인할 수 있다.</li>
<li><strong>임무 중 데이터 분석</strong>: 임무 수행 중 관제 소프트웨어는 드론이 획득한 데이터를 실시간으로 처리하여 비파괴 검사 결과를 분석한다. 만약 결함이 감지될 경우, 조종자는 즉시 해당 구역을 재검사할 수 있도록 드론을 제어할 수 있다.</li>
</ul>
<p>관제 소프트웨어는 이러한 다양한 기능을 통해 두 대의 드론이 비파괴 검사를 효과적으로 수행할 수 있도록 지원하며, 군집 비행과 개별 제어를 모두 가능하게 한다.</p>
<h3 id="23_1">2.3 군집 비행 제어</h3>
<p>두 대의 드론이 동시에 비파괴 검사를 수행하기 위해서는 군집 비행 제어가 필요하다. 군집 비행 제어는 두 대의 드론이 상호 위치를 조정하면서 피사체로부터 일정한 거리를 유지하는 것을 목표로 한다. 이를 위해 다음과 같은 절차가 진행된다.</p>
<ol>
<li>
<p><strong>피사체 위치 설정</strong>: 관제 소프트웨어는 피사체의 위치를 설정하고, 두 대의 드론이 피사체를 중심으로 대칭적인 위치에 위치하도록 명령을 내린다.</p>
</li>
<li>
<p><strong>가상 평면 생성</strong>: 두 대의 드론 사이에 가상의 평면을 생성하여 피사체와의 거리를 유지하며, 이 평면을 기준으로 드론 간 상대 위치를 조정한다.</p>
</li>
<li>
<p><strong>경로 계획</strong>: 조종자는 두 드론이 검사할 경로를 설정하며, 드론들은 이 경로를 따라 이동하며 지정된 간격으로 영상을 취득한다. 드론이 경로를 따라 이동하는 동안, 두 드론의 상대적 위치가 계속 조정되며 피사체를 중심으로 대칭적인 비행을 유지한다.</p>
</li>
</ol>
<h3 id="24_1">2.4 검사 절차</h3>
<p>드론이 피사체 주위를 비행하며 비파괴 검사를 수행하는 절차는 다음과 같다.</p>
<ol>
<li>
<p><strong>이륙 및 초기 위치 설정</strong>: 두 대의 드론은 동시에 이륙하여 피사체로부터 일정 거리에 도달한다. 이 과정에서 GPS 및 IMU 데이터를 사용하여 드론 간 상대적 위치와 피사체로부터의 거리를 정확히 측정한다.</p>
</li>
<li>
<p><strong>검사 장비 조준</strong>: 두 대의 드론은 상호 위치를 추정하여 비파괴 검사 장비를 피사체에 정확히 조준한다. 이 과정에서 드론 간 통신을 통해 상대 드론의 위치를 실시간으로 추적하며, 검사 장비가 피사체의 동일한 부분을 검사하도록 조정한다.</p>
</li>
<li>
<p><strong>영상 취득</strong>: 두 대의 드론이 지정된 경로를 따라 이동하면서, 비파괴 검사 장비를 이용해 연속적으로 영상을 취득한다. 관제 소프트웨어는 실시간으로 영상을 모니터링하며 결함 여부를 분석한다.</p>
</li>
<li>
<p><strong>착륙 및 데이터 분석</strong>: 임무가 완료되면 드론은 안전하게 착륙하며, 취득한 데이터를 분석하여 최종적인 결함 여부를 판단한다.</p>
</li>
</ol>
<p>본 시스템 개요는 두 대의 드론을 이용한 비파괴 검사의 원리를 상세히 설명하며, 시스템의 하드웨어 및 소프트웨어 구성을 포함한 전체적인 동작 방식을 기술한다.</p>
<h2 id="3_1">3. 군집 제어 시스템</h2>
<h3 id="31">3.1 군집 상태 전이</h3>
<p>군집 관제는 조종자의 명령에 따라 절차적으로 전이된다. 군집 상태는 <strong>idle</strong>에서 시작하며, 조종자의 지시에 따라 <strong>takeoff</strong> 상태로 전이된다. 군집이 상승한 후에는 <strong>aim</strong> 모드로 진입하여 피사체를 중심으로 지정된 위치를 유지하며 상호 조준한다. 이후 <strong>auto</strong> 모드로 전이하여 지정된 경로를 따라 이동하면서 비파괴 검사를 수행한다.</p>
<h3 id="32">3.2 개별 드론 상태 전이</h3>
<p>각 드론은 개별적으로 <strong>idle</strong> 상태에서 출발하며, 조종자의 명령에 따라 <strong>arm</strong>하여 준비 상태에 진입한다. 이후 <strong>takeoff</strong> 명령이 내려지면 이륙하여 지정된 고도로 상승하며, <strong>aim</strong> 상태에서 상대 드론과 피사체의 위치를 추정하여 정확히 조준한다. 임무가 완료되면 <strong>land</strong> 상태로 전이하여 착륙한다.</p>
<h2 id="4">4. 관제 소프트웨어</h2>
<h3 id="41-mavlink">4.1 MAVLink 통신</h3>
<p>드론과 관제 소프트웨어는 MAVLink 프로토콜을 사용하여 통신한다. 관제 소프트웨어는 두 대의 드론에 대해 개별적으로 명령을 전달할 수 있으며, 드론 간 상호 위치 정보를 수집하여 군집 제어를 수행한다.</p>
<h3 id="42">4.2 가상 평면 생성</h3>
<p>비파괴 검사를 위해 두 대의 드론은 피사체를 사이에 두고 가상의 평면을 생성한다. 이 평면을 기준으로 드론은 지정된 거리를 유지하며, 조종자의 명령에 따라 일정 간격으로 이동한다.</p>
<h2 id="5">5. 결론</h2>
<p>본 논문에서는 두 대의 드론을 이용한 군집 비파괴 검사 시스템을 제안하였다. 각 드론은 서로의 위치를 실시간으로 추정하며 피사체를 조준하고, 지정된 경로를 따라 검사 영상을 취득한다. 제안된 시스템은 MAVLink 기반 통신을 통해 효율적으로 작동하며, 향후 연구에서는 검사 장비의 정밀도를 향상시키고, 다양한 피사체에 대한 적용 가능성을 검토할 예정이다.</p>
<h2 id="_1">참조</h2>
<p>[Ardupilot] https://ardupilot.org/</p>
<p>[MAVLink] https://mavlink.io/en/</p>
<p>[MAVLink2] https://mavlink.io/en/guide/mavlink_2.html</p>
<hr/>
<p>[Vincenty1975]</p>
<p><strong>Thaddeus Vincenty</strong>가 1975년에 발표한 타원체 거리 계산법은 논문으로 다음과 같은 제목으로 출판되었다:</p>
<p><strong>"Direct and Inverse Solutions of Geodesics on the Ellipsoid with Application of Nested Equations"</strong></p>
<p>이 논문은 <strong>Survey Review</strong> 저널의 1975년판에 게재되었으며, 타원체 상에서의 두 지점 간의 거리를 계산하는 방법을 제시한 매우 중요한 연구이다. 논문에서는 두 주요 문제를 다룬다:</p>
<ol>
<li><strong>직접 문제 (Direct problem)</strong>: 한 지점에서 특정 방위각과 거리를 주어졌을 때, 목표 지점의 좌표를 계산하는 방법.</li>
<li><strong>역문제 (Inverse problem)</strong>: 두 지점의 좌표가 주어졌을 때, 그 사이의 대지 거리와 방위각을 계산하는 방법.</li>
</ol>
<p>Vincenty의 계산법은 매우 정확하며, GPS나 지리 정보 시스템(GIS)에서 타원체 모델을 사용할 때 거리 계산에 자주 사용된다.</p>
<p>참고로, 이 논문은 타원체 모델을 사용한 지리적 계산에서 여전히 중요한 기여를 하고 있으며, 타원체의 편평도와 이심률을 고려한 매우 정밀한 계산을 가능하게 한다.</p>
<br/>
<div aria-label="navigation" class="row wm-article-nav-buttons" role="navigation">
<div class="wm-article-nav pull-right">
<a class="btn btn-xs btn-default pull-right" href="../../artificial_intelligent/01_preface_ko/">
        Next
        <i aria-hidden="true" class="fa fa-chevron-right"></i>
</a>
<a class="btn btn-xs btn-link" href="../../artificial_intelligent/01_preface_ko/">
        소개
      </a>
</div>
<div class="wm-article-nav">
<a class="btn btn-xs btn-default pull-left" href="../collision_detection/triangle_vs_triangle/">
<i aria-hidden="true" class="fa fa-chevron-left"></i>
        Previous</a><a class="btn btn-xs btn-link" href="../collision_detection/triangle_vs_triangle/">
        삼각형과 삼각형의 충돌 검사
      </a>
</div>
</div>
<br/>
</div>
<footer class="container-fluid wm-page-content">
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>