<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://booiljung.github.io/robot/autonomous_robot_with_humble_fastlivo_mid360/chapter_01/0106/" rel="canonical"/>
<link href="../../../../img/favicon.ico" rel="shortcut icon"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<title>ROS2 네임스페이스와 런치 시스템 - 소프트웨어 융합</title>
<link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet"/>
<link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet"/>
<link href="../../../../css/base.css" rel="stylesheet"/>
<link href="../../../../css/highlight.css" rel="stylesheet"/>
<link href="../../../../css/custom.css" rel="stylesheet"/>
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<script src="../../../../js/jquery-3.2.1.min.js"></script>
<script src="../../../../js/bootstrap-3.3.7.min.js"></script>
<script src="../../../../js/highlight.pack.js"></script>
<base target="_top"/>
<script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4(Namespace)", url: "#_top", children: [
              {title: "\uc608\uc2dc", url: "#_1" },
          ]},
          {title: "\ub7f0\uce58 \uc2dc\uc2a4\ud15c(Launch System)", url: "#launch-system", children: [
              {title: "\uae30\ubcf8 \ub7f0\uce58 \ud30c\uc77c \uc608\uc2dc", url: "#_2" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc801\uc6a9", url: "#_3", children: [
              {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc640 \ub178\ub4dc \uac04\uc758 \uc0c1\ud638\uc791\uc6a9", url: "#_4" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \uc870\uac74\ubd80 \uc2e4\ud589", url: "#_5", children: [
              {title: "\uc870\uac74\ubd80 \uc2e4\ud589 \uc608\uc2dc", url: "#_6" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc758 \ud30c\ub77c\ubbf8\ud130 \uc804\ub2ec", url: "#_7", children: [
              {title: "\ud30c\ub77c\ubbf8\ud130 \uc804\ub2ec \uc608\uc2dc", url: "#_8" },
          ]},
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc640 \ud30c\ub77c\ubbf8\ud130\uc758 \uad00\uacc4", url: "#_9", children: [
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \uadf8\ub8f9\ud654\ub41c \ub124\uc784\uc2a4\ud398\uc774\uc2a4", url: "#_10", children: [
              {title: "\uadf8\ub8f9\ud654\ub41c \ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc608\uc2dc", url: "#_11" },
          ]},
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4 \ucda9\ub3cc \ud574\uacb0", url: "#_12", children: [
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ud658\uacbd \ubcc0\uc218 \uc124\uc815", url: "#_13", children: [
              {title: "\ud658\uacbd \ubcc0\uc218 \uc124\uc815 \uc608\uc2dc", url: "#_14" },
          ]},
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc640 \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c\uc758 \ub2e4\uc911 \ub85c\ubd07 \uc9c0\uc6d0", url: "#_15", children: [
              {title: "\ub2e4\uc911 \ub85c\ubd07 \uc2dc\uc2a4\ud15c\uc5d0\uc11c\uc758 \ub7f0\uce58 \ud30c\uc77c \uc608\uc2dc", url: "#_16" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c \uc0ac\uc6a9", url: "#_17", children: [
              {title: "\ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c \uc0ac\uc6a9 \uc608\uc2dc", url: "#_18" },
          ]},
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc640 \uc0c1\uc704-\ud558\uc704 \uad6c\uc870\uc758 \ud45c\ud604", url: "#-", children: [
              {title: "\uc0c1\uc704-\ud558\uc704 \uad6c\uc870 \uc608\uc2dc", url: "#-_1" },
          ]},
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4 \uc0ac\uc6a9\uc758 \uc218\ud559\uc801 \ubaa8\ub378", url: "#_19", children: [
          ]},
          {title: "\ub7f0\uce58 \uc2dc\uc2a4\ud15c\uc5d0\uc11c \ub9ac\uc2a4\ud3f0(Respawn) \uc124\uc815", url: "#respawn", children: [
              {title: "\ub9ac\uc2a4\ud3f0 \uc124\uc815 \uc608\uc2dc", url: "#_20" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \uadf8\ub8f9(Group) \uae30\ub2a5", url: "#group", children: [
              {title: "\uadf8\ub8f9 \uae30\ub2a5 \uc608\uc2dc", url: "#_21" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ub9e4\uac1c\ubcc0\uc218 \uc124\uc815 \uc2dc \uace0\uae09 \uae30\ub2a5", url: "#_22", children: [
              {title: "\ub3d9\uc801 \ud30c\ub77c\ubbf8\ud130 \uc124\uc815 \uc608\uc2dc", url: "#_23" },
          ]},
          {title: "\ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ub178\ub4dc \uac04\uc758 \uc758\uc874\uc131 \uc124\uc815", url: "#_24", children: [
              {title: "\ub178\ub4dc \uc758\uc874\uc131 \uc124\uc815 \uc608\uc2dc", url: "#_25" },
          ]},
          {title: "\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc640 \ub7f0\uce58 \uc2dc\uc2a4\ud15c\uc758 \uacb0\ud569: \ub3d9\uc801 \uad6c\uc131\uacfc \uc720\uc5f0\uc131", url: "#_26", children: [
          ]},
        ];

    </script>
<script src="../../../../js/base.js"></script>
<script src="../../../../js/google_analytics.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script>
</meta></head>
<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>
<div class="container-fluid wm-page-content">
<a name="_top"></a>
<div aria-label="navigation" class="row wm-article-nav-buttons" role="navigation">
<div class="wm-article-nav pull-right">
<a class="btn btn-xs btn-default pull-right" href="../0107/">
        Next
        <i aria-hidden="true" class="fa fa-chevron-right"></i>
</a>
<a class="btn btn-xs btn-link" href="../0107/">
        ROS2 매니지먼트 툴 (ros2cli, rviz2 등)
      </a>
</div>
<div class="wm-article-nav">
<a class="btn btn-xs btn-default pull-left" href="../0105/">
<i aria-hidden="true" class="fa fa-chevron-left"></i>
        Previous</a><a class="btn btn-xs btn-link" href="../0105/">
        ROS2 통신 메커니즘 (토픽, 서비스, 액션)
      </a>
</div>
</div>
<h3 id="namespace">네임스페이스(Namespace)</h3>
<p>ROS2에서 네임스페이스는 시스템의 계층 구조와 모듈화를 가능하게 하는 중요한 개념 중 하나이다. 네임스페이스를 통해 동일한 이름을 가진 여러 노드를 서로 구분할 수 있으며, 이를 통해 복잡한 로봇 시스템을 보다 효율적으로 구성할 수 있다. 네임스페이스는 주로 다음과 같은 목적을 가진다:</p>
<ul>
<li><strong>네임 충돌 방지</strong>: 여러 노드가 동일한 주제(topic), 서비스(service), 액션(action)을 사용할 때, 각각을 서로 다른 네임스페이스에 할당함으로써 이름 충돌을 피할 수 있다.</li>
<li><strong>로봇의 모듈화</strong>: 복잡한 로봇 시스템에서 각 모듈(예: 센서, 액추에이터)을 별도의 네임스페이스에 할당하여 구분할 수 있다. 예를 들어, 여러 개의 로봇이 하나의 시스템에서 동작할 때, 각각의 로봇에 별도의 네임스페이스를 할당함으로써 독립적으로 관리할 수 있다.</li>
<li><strong>코드 재사용성</strong>: 네임스페이스를 사용하면 동일한 코드베이스를 다양한 로봇에 적용할 수 있다. 예를 들어, 다수의 로봇이 동일한 센서와 제어 알고리즘을 사용할 때, 네임스페이스만 다르게 설정하면 같은 코드를 쉽게 재사용할 수 있다.</li>
</ul>
<p>ROS2에서 네임스페이스는 <code>node_name</code>, <code>topic_name</code>, <code>service_name</code>과 같은 이름 앞에 추가된다. 예를 들어, <code>/robot1/laser_scan</code>과 같은 형식이 된다. 네임스페이스는 슬래시(<code>/</code>)를 사용하여 구분되며, 전역 네임스페이스는 <code>/</code>로 시작한다.</p>
<h4 id="_1">예시</h4>
<pre><code class="language-cpp">rclcpp::NodeOptions options;
options.namespace_("/robot1");
auto node = rclcpp::Node::make_shared("laser_node", options);
</code></pre>
<p>위 코드에서는 <code>laser_node</code>가 <code>/robot1</code>이라는 네임스페이스 하에서 생성되었다. 이 노드는 <code>/robot1/laser_node</code>로 접근할 수 있다. </p>
<h3 id="launch-system">런치 시스템(Launch System)</h3>
<p>ROS2에서 런치 시스템은 여러 노드와 관련된 설정을 동시에 실행하고, 시스템 전체를 통합적으로 관리하기 위한 도구이다. 특히 복잡한 로봇 시스템에서 여러 노드를 효과적으로 관리하기 위해 런치 파일을 사용한다. 런치 파일은 ROS1에 비해 ROS2에서 더욱 유연하게 설계되었으며, Python 기반의 DSL(Domain Specific Language)을 사용하여 작성된다.</p>
<p>런치 파일의 주요 기능은 다음과 같다:</p>
<ul>
<li><strong>여러 노드 실행</strong>: 하나의 런치 파일에서 여러 노드를 동시에 실행할 수 있으며, 각 노드의 파라미터와 설정을 독립적으로 관리할 수 있다.</li>
<li><strong>파라미터 설정</strong>: 노드의 파라미터를 런치 파일에서 직접 설정할 수 있어, 실행 시 동적으로 변경이 가능하다.</li>
<li><strong>네임스페이스 적용</strong>: 런치 파일에서 네임스페이스를 적용함으로써 각 노드와 관련된 네임스페이스를 중앙에서 제어할 수 있다.</li>
<li><strong>조건부 실행</strong>: 특정 조건에 따라 노드의 실행을 제어할 수 있는 기능이 있으며, 시스템 상태나 외부 변수에 따라 노드를 동적으로 관리할 수 있다.</li>
</ul>
<h4 id="_2">기본 런치 파일 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen'
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            namespace='robot1',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 런치 파일은 <code>demo_nodes_cpp</code> 패키지의 <code>talker</code>와 <code>listener</code> 노드를 <code>/robot1</code> 네임스페이스 하에서 실행한다. 이처럼 ROS2의 런치 시스템은 각 노드에 네임스페이스를 할당하여 로봇의 모듈성을 높인다.</p>
<h3 id="_3">런치 파일에서 네임스페이스 적용</h3>
<p>런치 파일을 사용하여 노드를 실행할 때 네임스페이스를 설정하면, 해당 네임스페이스는 노드가 생성하는 모든 토픽, 서비스, 액션에 자동으로 적용된다. 예를 들어, <code>robot1</code> 네임스페이스에 속한 노드가 <code>scan</code>이라는 토픽을 발행한다면, 실제 토픽 이름은 <code>/robot1/scan</code>이 된다. 이를 통해 복잡한 네트워크를 간소화할 수 있다.</p>
<h4 id="_4">네임스페이스와 노드 간의 상호작용</h4>
<p>여러 노드를 사용할 때, 각 노드에 네임스페이스를 어떻게 설정하느냐에 따라 노드 간의 통신 구조가 달라진다. 예를 들어, 동일한 네임스페이스를 사용하는 노드들은 자연스럽게 서로의 토픽을 구독하고 발행할 수 있지만, 다른 네임스페이스에 있는 노드와의 통신은 더 복잡한 설정을 필요로 할 수 있다.</p>
<div class="mermaid">graph LR
    A[robot1/talker] --&gt; B[robot1/listener]
    C[robot2/talker] --&gt; D[robot2/listener]
</div>
<p>위와 같은 구조에서, <code>/robot1/talker</code>와 <code>/robot1/listener</code>는 동일한 네임스페이스 내에 있기 때문에 자동으로 통신이 이루어지지만, <code>/robot1</code>과 <code>/robot2</code> 네임스페이스 간의 통신을 설정하려면 추가적인 설정이 필요하다.</p>
<h3 id="_5">런치 파일에서 조건부 실행</h3>
<p>런치 파일에서는 특정 조건에 따라 노드를 실행하거나 제외할 수 있는 기능을 제공한다. 이를 통해 로봇의 상태나 외부 입력에 따라 런치 파일을 동적으로 제어할 수 있다. 조건부 실행을 구현하는 방법은 주로 <code>IfCondition</code>이나 <code>UnlessCondition</code>을 사용하는 것이다. 이를 통해 조건부로 네임스페이스를 설정하거나 노드 실행을 조정할 수 있다.</p>
<h4 id="_6">조건부 실행 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch.conditions import IfCondition
from launch.substitutions import LaunchConfiguration

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen',
            condition=IfCondition(LaunchConfiguration('enable_talker'))
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            namespace='robot1',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 코드에서는 <code>enable_talker</code>라는 런치 설정에 따라 <code>talker</code> 노드가 실행될지 여부를 결정할 수 있다. 이렇게 조건부 실행을 설정하면, 로봇이 특정 상황에서만 필요한 노드를 실행하도록 할 수 있으며, 이를 통해 시스템 자원의 효율적 사용이 가능해진다.</p>
<h3 id="_7">런치 파일의 파라미터 전달</h3>
<p>런치 파일을 통해 각 노드에 파라미터를 전달하는 것은 ROS2 시스템의 중요한 특징 중 하나이다. 이를 통해 런타임에 노드의 동작을 변경할 수 있으며, 이는 로봇의 환경 설정이나 작업 특성에 맞춰 유연하게 변경할 수 있다.</p>
<p>파라미터는 노드 실행 시 전달되며, YAML 파일을 사용하여 대규모 파라미터를 관리할 수 있다. 파라미터 전달은 노드의 <code>parameters</code> 옵션을 통해 설정된다.</p>
<h4 id="_8">파라미터 전달 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen',
            parameters=[{'publish_rate': 10}]
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            namespace='robot1',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 예시에서는 <code>talker</code> 노드에 <code>publish_rate</code>라는 파라미터를 전달하여 초당 10회의 메시지를 발행하도록 설정하고 있다. 이처럼 런치 파일을 사용하여 노드의 동작을 유연하게 변경할 수 있다.</p>
<h3 id="_9">네임스페이스와 파라미터의 관계</h3>
<p>네임스페이스는 파라미터에도 영향을 미칠 수 있다. 특정 네임스페이스에서 실행된 노드가 가지는 파라미터는 해당 네임스페이스 내에서만 유효하다. 이를 통해 동일한 노드가 다른 네임스페이스에서 서로 다른 파라미터를 가지고 실행될 수 있다. 예를 들어, 동일한 노드를 여러 로봇에서 사용하지만, 각 로봇의 특성에 맞는 파라미터를 적용하고자 할 때 유용하다.</p>
<p>수학적으로는 네임스페이스 내에서의 파라미터 전달을 다음과 같이 표현할 수 있다. 어떤 노드 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>이 파라미터 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>를 가지며, 네임스페이스 <span class="arithmatex"><span class="MathJax_Preview">\mathcal{N}_1</span><script type="math/tex">\mathcal{N}_1</script></span>과 <span class="arithmatex"><span class="MathJax_Preview">\mathcal{N}_2</span><script type="math/tex">\mathcal{N}_2</script></span>에서 각각 다른 파라미터 값을 설정한 경우:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
N_{\mathcal{N}_1}(p_1), \quad N_{\mathcal{N}_2}(p_2)
</div>
<script type="math/tex; mode=display">
N_{\mathcal{N}_1}(p_1), \quad N_{\mathcal{N}_2}(p_2)
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">p_1 \neq p_2</span><script type="math/tex">p_1 \neq p_2</script></span>인 경우, 각 네임스페이스에서 노드는 서로 다른 파라미터 값을 가지게 된다. 이를 통해 시스템의 유연성을 높일 수 있다.</p>
<h3 id="_10">런치 파일에서 그룹화된 네임스페이스</h3>
<p>런치 파일에서는 여러 노드를 하나의 네임스페이스 하에 그룹화할 수 있다. 이를 통해 관련된 노드들을 논리적으로 묶고, 동일한 네임스페이스 안에서 효율적으로 관리할 수 있다. 그룹화를 통해 여러 노드가 동일한 환경에서 동작하도록 설정할 수 있으며, 네임스페이스 충돌을 방지할 수 있다.</p>
<h4 id="_11">그룹화된 네임스페이스 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch_ros.actions import PushRosNamespace

def generate_launch_description():
    return LaunchDescription([
        PushRosNamespace('robot1'),
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            name='talker',
            output='screen'
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 코드에서는 <code>PushRosNamespace</code>를 사용하여 <code>talker</code>와 <code>listener</code> 노드를 <code>robot1</code> 네임스페이스 하에 그룹화하였다. 이를 통해 동일한 네임스페이스에서 노드가 실행되며, 관련된 노드들의 네임스페이스 관리가 용이해진다.</p>
<h3 id="_12">네임스페이스 충돌 해결</h3>
<p>여러 노드를 실행할 때 네임스페이스 충돌이 발생할 수 있다. 특히, 다수의 로봇이 동일한 토픽이나 서비스를 사용하는 경우, 네임스페이스를 적절히 설정하지 않으면 의도하지 않은 통신이 이루어질 수 있다. 이를 방지하기 위해 각 로봇이나 모듈에 별도의 네임스페이스를 할당하여 충돌을 방지해야 한다.</p>
<p>네임스페이스 충돌 문제는 특히 여러 로봇이 동일한 환경에서 동작할 때 빈번하게 발생한다. 예를 들어, 두 로봇이 동일한 주제를 발행하거나 구독하려고 할 때, 다음과 같은 상황이 발생할 수 있다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\text{robot1}/\text{scan} \quad \text{vs} \quad \text{robot2}/\text{scan}
</div>
<script type="math/tex; mode=display">
\text{robot1}/\text{scan} \quad \text{vs} \quad \text{robot2}/\text{scan}
</script>
</div>
<p>두 로봇이 모두 <code>scan</code>이라는 주제를 사용할 경우, 네임스페이스가 적절히 설정되지 않으면 주제 충돌이 발생하게 된다. 이를 방지하기 위해 각 로봇에 고유한 네임스페이스를 할당하여 관리해야 한다.</p>
<h3 id="_13">런치 파일에서 환경 변수 설정</h3>
<p>ROS2 런치 시스템은 환경 변수를 사용하여 노드 실행 시 다양한 설정을 동적으로 조정할 수 있다. 환경 변수는 시스템의 특정 설정을 제어하거나 조건부 실행을 제어하는 데 유용하다. 예를 들어, 로봇이 구동되는 환경에 따라 다르게 동작해야 하는 경우 환경 변수를 사용하면, 런타임에서 쉽게 설정을 변경할 수 있다.</p>
<p>환경 변수는 런치 파일에서 <code>env</code> 옵션을 통해 설정할 수 있으며, 특정 환경 변수를 참조하여 노드가 실행되도록 할 수 있다. 이를 통해 로봇의 센서 구성, 통신 설정, 또는 시뮬레이션과 실제 환경을 구분하는 등의 유연한 구성이 가능하다.</p>
<h4 id="_14">환경 변수 설정 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen',
            env={'ROS_LOG_LEVEL': 'DEBUG'}
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            namespace='robot1',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 예시에서는 <code>ROS_LOG_LEVEL</code>이라는 환경 변수를 설정하여, <code>talker</code> 노드가 디버그 모드로 실행되도록 하였다. 이를 통해 런타임에서 시스템의 로그 레벨을 동적으로 제어할 수 있다.</p>
<h3 id="_15">네임스페이스와 런치 파일에서의 다중 로봇 지원</h3>
<p>다수의 로봇을 ROS2 시스템에서 동시에 제어할 때, 각각의 로봇에 대해 독립적인 네임스페이스를 설정하는 것이 중요하다. 이를 통해 각 로봇은 자신만의 고유한 주제, 서비스, 액션을 사용할 수 있으며, 다른 로봇과의 통신 충돌을 방지할 수 있다.</p>
<p>다중 로봇 시스템을 설정할 때는 각 로봇에 네임스페이스를 부여하고, 해당 네임스페이스 내에서 모든 노드가 실행되도록 해야 한다. 이 경우, 로봇의 구성 요소가 서로 독립적으로 동작하며, 각 로봇의 동작을 보다 쉽게 모니터링하고 제어할 수 있다.</p>
<h4 id="_16">다중 로봇 시스템에서의 런치 파일 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch_ros.actions import PushRosNamespace

def generate_launch_description():
    return LaunchDescription([
        # 첫 번째 로봇
        PushRosNamespace('robot1'),
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            name='talker',
            output='screen'
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            name='listener',
            output='screen'
        ),

        # 두 번째 로봇
        PushRosNamespace('robot2'),
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            name='talker',
            output='screen'
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 코드에서는 두 개의 로봇, <code>robot1</code>과 <code>robot2</code>에 대해 각각의 네임스페이스가 설정되어 있으며, 각 로봇에서 <code>talker</code>와 <code>listener</code> 노드가 독립적으로 실행된다. 이처럼 다중 로봇 환경에서는 네임스페이스를 통해 각 로봇의 동작을 분리하여 관리할 수 있다.</p>
<h3 id="_17">런치 파일에서 파라미터 파일 사용</h3>
<p>런치 파일을 통해 파라미터를 설정할 때, 개별 파라미터를 직접 설정하는 방법 외에도 파라미터 파일을 사용하여 대규모 설정을 한번에 적용할 수 있다. 파라미터 파일은 YAML 형식으로 작성되며, 각 노드에 필요한 여러 파라미터를 미리 정의할 수 있다.</p>
<p>파라미터 파일은 런치 파일에서 <code>parameters</code> 옵션을 사용하여 적용된다. 이를 통해 로봇 시스템의 구성 요소들이 복잡한 설정을 요구할 때, 해당 설정을 YAML 파일로 관리함으로써 일관된 설정 적용이 가능해진다.</p>
<h4 id="_18">파라미터 파일 사용 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen',
            parameters=['config/talker_params.yaml']
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            namespace='robot1',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>여기서는 <code>talker</code> 노드에 <code>talker_params.yaml</code> 파일을 파라미터로 전달하였다. 해당 YAML 파일에는 노드에 필요한 다양한 설정값이 포함될 수 있다.</p>
<h3 id="-">네임스페이스와 상위-하위 구조의 표현</h3>
<p>ROS2 네임스페이스는 계층 구조를 형성할 수 있으며, 상위-하위 구조를 통해 시스템의 복잡한 계층을 쉽게 표현할 수 있다. 예를 들어, 각 로봇이 여러 센서와 액추에이터를 가지고 있을 때, 이러한 센서와 액추에이터에 각각의 하위 네임스페이스를 할당할 수 있다.</p>
<p>상위 네임스페이스는 일반적으로 로봇 전체를 대표하고, 하위 네임스페이스는 로봇 내의 특정 모듈이나 센서를 나타낸다. 이때 상위 네임스페이스는 하위 네임스페이스의 이름 앞에 추가되어 전체 계층 구조를 명확히 표현한다.</p>
<h4 id="-_1">상위-하위 구조 예시</h4>
<pre><code>/robot1/camera/image_raw
/robot1/lidar/scan
/robot2/camera/image_raw
/robot2/lidar/scan
</code></pre>
<p>여기서 <code>robot1</code>과 <code>robot2</code>는 각각 로봇의 상위 네임스페이스이며, <code>camera</code>와 <code>lidar</code>는 각 로봇에 설치된 센서들의 하위 네임스페이스이다. 이를 통해 각 로봇의 센서 데이터를 구분하여 처리할 수 있다.</p>
<h3 id="_19">네임스페이스 사용의 수학적 모델</h3>
<p>ROS2의 네임스페이스는 이름 충돌을 방지하고 시스템을 계층적으로 구성하기 위한 일종의 함수적 매핑 역할을 한다. 이를 수학적으로 나타내면, 각 노드의 이름은 네임스페이스 함수 <span class="arithmatex"><span class="MathJax_Preview">\mathcal{N}</span><script type="math/tex">\mathcal{N}</script></span>에 의해 정의될 수 있다. </p>
<p>노드 <span class="arithmatex"><span class="MathJax_Preview">n_i</span><script type="math/tex">n_i</script></span>가 네임스페이스 <span class="arithmatex"><span class="MathJax_Preview">\mathcal{N}</span><script type="math/tex">\mathcal{N}</script></span> 내에 있을 때, 그 전체 이름은 다음과 같이 정의된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\text{FullName}(n_i) = \mathcal{N}(n_i)
</div>
<script type="math/tex; mode=display">
\text{FullName}(n_i) = \mathcal{N}(n_i)
</script>
</div>
<p>예를 들어, 노드 <code>talker</code>가 <code>robot1</code>이라는 네임스페이스 내에 있을 경우, 다음과 같이 표현된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\text{FullName}(\text{talker}) = \mathcal{N}_{\text{robot1}}(\text{talker}) = /robot1/talker
</div>
<script type="math/tex; mode=display">
\text{FullName}(\text{talker}) = \mathcal{N}_{\text{robot1}}(\text{talker}) = /robot1/talker
</script>
</div>
<p>이를 통해 네임스페이스는 노드의 이름을 유일하게 식별할 수 있게 하며, 계층적인 구조를 유지하게 한다.</p>
<h3 id="respawn">런치 시스템에서 리스폰(Respawn) 설정</h3>
<p>ROS2 런치 시스템에서는 특정 노드가 비정상 종료되었을 때, 자동으로 다시 실행(리스폰)하도록 설정할 수 있다. 이는 시스템의 안정성을 보장하기 위한 중요한 기능 중 하나이다. 특히 자율 주행 로봇이나 장시간 동작하는 시스템에서, 노드가 예기치 않게 종료되었을 경우 해당 노드를 다시 실행시킴으로써 시스템이 지속적으로 동작하도록 유지할 수 있다.</p>
<p>리스폰 설정은 노드의 <code>respawn</code> 옵션을 통해 제어되며, 필요한 경우 지연 시간을 두고 리스폰을 설정할 수도 있다.</p>
<h4 id="_20">리스폰 설정 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen',
            respawn=True,
            respawn_delay=2.0
        ),
        Node(
            package='demo_nodes_cpp',
            executable='listener',
            namespace='robot1',
            name='listener',
            output='screen'
        )
    ])
</code></pre>
<p>위 예시에서는 <code>talker</code> 노드에 대해 <code>respawn=True</code>로 설정하여, 노드가 비정상 종료되었을 때 2초 후에 자동으로 다시 실행되도록 설정하였다. 이를 통해 로봇의 핵심 기능이 중단 없이 유지될 수 있다.</p>
<h3 id="group">런치 파일에서 그룹(Group) 기능</h3>
<p>런치 파일에서는 여러 노드를 그룹화하여 하나의 논리적 단위로 처리할 수 있다. 그룹 기능을 사용하면 여러 노드를 함께 실행하거나, 특정 설정(예: 네임스페이스)을 그룹 내 노드 전체에 일괄 적용할 수 있다. 이 기능은 복잡한 시스템에서 관련된 노드들을 묶어 관리할 때 매우 유용하다.</p>
<p>그룹화된 노드들은 공통의 설정을 공유할 수 있으며, 그룹 단위로 조건부 실행, 네임스페이스 설정, 파라미터 전달 등을 할 수 있다.</p>
<h4 id="_21">그룹 기능 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch_ros.actions import PushRosNamespace
from launch.actions import GroupAction

def generate_launch_description():
    return LaunchDescription([
        GroupAction([
            PushRosNamespace('robot1'),
            Node(
                package='demo_nodes_cpp',
                executable='talker',
                name='talker',
                output='screen'
            ),
            Node(
                package='demo_nodes_cpp',
                executable='listener',
                name='listener',
                output='screen'
            )
        ]),
        GroupAction([
            PushRosNamespace('robot2'),
            Node(
                package='demo_nodes_cpp',
                executable='talker',
                name='talker',
                output='screen'
            ),
            Node(
                package='demo_nodes_cpp',
                executable='listener',
                name='listener',
                output='screen'
            )
        ])
    ])
</code></pre>
<p>위 코드에서는 <code>GroupAction</code>을 사용하여 <code>robot1</code>과 <code>robot2</code> 네임스페이스 내의 노드를 각각 그룹화하였다. 이처럼 그룹 기능을 사용하면 관련 노드들을 모아 일관된 설정을 적용할 수 있으며, 시스템의 유지보수성과 가독성을 높일 수 있다.</p>
<h3 id="_22">런치 파일에서 매개변수 설정 시 고급 기능</h3>
<p>ROS2 런치 파일에서 파라미터를 전달하는 기본적인 방법 외에도, 고급 설정 기능을 사용하여 보다 복잡한 설정을 적용할 수 있다. 이를 통해 파라미터를 동적으로 변경하거나, 외부 환경에 따라 설정을 달리할 수 있다.</p>
<p>특히, 런치 시스템의 <code>LaunchConfiguration</code>을 사용하면 실행 중 파라미터 값을 동적으로 설정할 수 있으며, 시스템의 상태나 입력 값에 따라 노드의 동작을 변화시킬 수 있다. 또한, 파라미터를 런치 파일의 명령줄 인수로 전달하여, 런타임 시 사용자가 직접 값을 변경할 수 있도록 할 수도 있다.</p>
<h4 id="_23">동적 파라미터 설정 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch.substitutions import LaunchConfiguration

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='demo_nodes_cpp',
            executable='talker',
            namespace='robot1',
            name='talker',
            output='screen',
            parameters=[{'publish_rate': LaunchConfiguration('publish_rate')}]
        )
    ])
</code></pre>
<p>위 예시에서는 <code>publish_rate</code> 파라미터를 런타임 시 설정할 수 있도록 하였다. 런치 파일 실행 시 다음과 같이 명령줄 인수를 통해 값을 전달할 수 있다.</p>
<pre><code class="language-bash">ros2 launch my_launch_file.py publish_rate:=10
</code></pre>
<p>이렇게 설정된 값은 런타임에서 동적으로 적용되어 노드의 동작에 영향을 미치게 된다.</p>
<h3 id="_24">런치 파일에서 노드 간의 의존성 설정</h3>
<p>노드 간의 의존성 관계를 설정하는 것은 자율 주행 로봇과 같은 복잡한 시스템에서 중요한 기능이다. 일부 노드가 다른 노드의 실행 상태에 의존하는 경우, 특정 노드가 정상적으로 실행된 이후에만 다른 노드를 실행해야 한다. 이러한 의존성은 런치 파일을 통해 설정할 수 있다.</p>
<h4 id="_25">노드 의존성 설정 예시</h4>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch.actions import RegisterEventHandler
from launch.event_handlers import OnProcessExit

def generate_launch_description():
    talker_node = Node(
        package='demo_nodes_cpp',
        executable='talker',
        namespace='robot1',
        name='talker',
        output='screen'
    )

    listener_node = Node(
        package='demo_nodes_cpp',
        executable='listener',
        namespace='robot1',
        name='listener',
        output='screen'
    )

    return LaunchDescription([
        talker_node,
        RegisterEventHandler(
            OnProcessExit(
                target_action=talker_node,
                on_exit=[listener_node]
            )
        )
    ])
</code></pre>
<p>위 코드에서는 <code>talker</code> 노드가 종료된 이후에만 <code>listener</code> 노드가 실행되도록 설정하였다. 이는 노드 간의 실행 순서를 제어하거나, 특정 노드가 정상 종료된 후에 다른 노드를 실행해야 할 때 유용하다.</p>
<h3 id="_26">네임스페이스와 런치 시스템의 결합: 동적 구성과 유연성</h3>
<p>ROS2 네임스페이스와 런치 시스템의 결합은 자율 주행 로봇과 같은 복잡한 시스템에서 매우 중요한 역할을 한다. 네임스페이스를 사용하면 로봇의 모듈성을 강화할 수 있으며, 런치 시스템을 통해 여러 모듈을 중앙에서 관리할 수 있다. 특히, 동적 파라미터 설정, 리스폰 기능, 그룹화된 네임스페이스, 환경 변수 설정 등 다양한 기능을 통해 로봇 시스템의 유연성을 극대화할 수 있다.</p>
<p>수학적으로, 네임스페이스와 런치 시스템의 동작을 함수로 모델링할 수 있다. 노드 <span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>이 파라미터 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>, 네임스페이스 <span class="arithmatex"><span class="MathJax_Preview">\mathcal{N}</span><script type="math/tex">\mathcal{N}</script></span>, 런치 설정 <span class="arithmatex"><span class="MathJax_Preview">L</span><script type="math/tex">L</script></span>에 의해 제어되는 시스템에서, 노드의 전체 실행 상태는 다음과 같이 나타낼 수 있다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
S(N) = f(\mathcal{N}(N), p, L)
</div>
<script type="math/tex; mode=display">
S(N) = f(\mathcal{N}(N), p, L)
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">f</span><script type="math/tex">f</script></span>는 노드 실행에 대한 전반적인 함수로, 네임스페이스와 파라미터, 런치 설정의 조합에 의해 노드의 최종 동작이 결정된다. 이를 통해 다수의 로봇 시스템을 효과적으로 관리할 수 있으며, 복잡한 시스템의 확장성을 높일 수 있다.</p>
<br/>
<div aria-label="navigation" class="row wm-article-nav-buttons" role="navigation">
<div class="wm-article-nav pull-right">
<a class="btn btn-xs btn-default pull-right" href="../0107/">
        Next
        <i aria-hidden="true" class="fa fa-chevron-right"></i>
</a>
<a class="btn btn-xs btn-link" href="../0107/">
        ROS2 매니지먼트 툴 (ros2cli, rviz2 등)
      </a>
</div>
<div class="wm-article-nav">
<a class="btn btn-xs btn-default pull-left" href="../0105/">
<i aria-hidden="true" class="fa fa-chevron-left"></i>
        Previous</a><a class="btn btn-xs btn-link" href="../0105/">
        ROS2 통신 메커니즘 (토픽, 서비스, 액션)
      </a>
</div>
</div>
<br/>
</div>
<footer class="container-fluid wm-page-content">
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>