<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/ros2_humble/chapter_10/1002/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>노드 시작 및 파라미터 전달 - 소프트웨어 융합</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "1. \ub178\ub4dc \uc2dc\uc791 \uae30\ubcf8 \uac1c\ub150", url: "#_top", children: [
          ]},
          {title: "2. \ud30c\ub77c\ubbf8\ud130 \uc804\ub2ec", url: "#2", children: [
              {title: "2.1. \uc815\uc801 \ud30c\ub77c\ubbf8\ud130 \uc124\uc815", url: "#21" },
              {title: "2.2. \ub3d9\uc801 \ud30c\ub77c\ubbf8\ud130 \uc804\ub2ec", url: "#22" },
              {title: "2.3. \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c \uc0ac\uc6a9", url: "#23" },
          ]},
          {title: "3. \ub7f0\ud0c0\uc784 \ud30c\ub77c\ubbf8\ud130 \uc218\uc815", url: "#3", children: [
          ]},
          {title: "4. launch \ud30c\uc77c\uc5d0\uc11c \ud30c\ub77c\ubbf8\ud130 \uad00\ub828 \ub3d9\uc791 \uad00\ub9ac", url: "#4-launch", children: [
          ]},
          {title: "5. \ud30c\ub77c\ubbf8\ud130\uc640 \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c\uc758 \uc870\uac74\ubd80 \uc2e4\ud589", url: "#5", children: [
              {title: "5.1. \uc870\uac74\ubd80 \uc2e4\ud589 \uc608\uc81c", url: "#51" },
              {title: "5.2. \ud30c\ub77c\ubbf8\ud130 \uac12\uc5d0 \ub530\ub978 \uc2e4\ud589 \uc870\uac74", url: "#52" },
          ]},
          {title: "6. \ud30c\ub77c\ubbf8\ud130 \uc124\uc815\uc744 \uc704\ud55c \ub7f0\uce58 \uc635\uc158 \ud65c\uc6a9", url: "#6", children: [
              {title: "6.1. \ub7f0\uce58 \ud30c\uc77c \uc778\uc790 \uc124\uc815 \uc608\uc2dc", url: "#61" },
          ]},
          {title: "7. \ud30c\ub77c\ubbf8\ud130 \uc720\ud6a8\uc131 \uac80\uc99d", url: "#7", children: [
              {title: "7.1. \ud30c\ub77c\ubbf8\ud130 \uc720\ud6a8\uc131 \uac80\uc99d \uc608\uc2dc", url: "#71" },
          ]},
          {title: "8. \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c\uc744 \ud1b5\ud55c \ubcf5\uc7a1\ud55c \uc124\uc815 \uad00\ub9ac", url: "#8", children: [
              {title: "8.1. YAML \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c\uc758 \uad6c\uc870", url: "#81-yaml" },
              {title: "8.2. \ud30c\ub77c\ubbf8\ud130 \ud30c\uc77c\uc758 \ud65c\uc6a9", url: "#82" },
              {title: "8.3. \ub2e4\uc911 \ub178\ub4dc \ud30c\ub77c\ubbf8\ud130 \uad00\ub9ac", url: "#83" },
          ]},
          {title: "9. \ub3d9\uc801 \ud30c\ub77c\ubbf8\ud130 \uc7ac\uad6c\uc131", url: "#9", children: [
              {title: "9.1. \ub3d9\uc801 \ud30c\ub77c\ubbf8\ud130 \ubcc0\uacbd", url: "#91" },
              {title: "9.2. \ud30c\ub77c\ubbf8\ud130 \ubcc0\uacbd \uc774\ubca4\ud2b8 \ucc98\ub9ac", url: "#92" },
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1003/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1003/" class="btn btn-xs btn-link">
        다중 노드 실행 및 그룹 실행
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1001/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1001/" class="btn btn-xs btn-link">
        launch 파일 생성과 실행
      </a>
    </div>
    
  </div>

    

    <h3 id="1">1. 노드 시작 기본 개념</h3>
<p>ROS2에서 노드는 독립적인 실행 단위로, 각각의 노드는 퍼블리셔, 서브스크라이버, 서비스, 액션 등의 역할을 담당한다. ROS2의 launch 파일은 노드 시작을 자동화하고, 여러 노드를 동시에 실행하거나 서로 다른 파라미터를 전달할 수 있는 편리한 방법을 제공한다.</p>
<p><strong>노드 실행을 위한 launch 파일의 기본 구조</strong>는 다음과 같다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<h3 id="2">2. 파라미터 전달</h3>
<p>노드에 파라미터를 전달하기 위해서는 <code>launch</code> 파일에서 <code>param</code> 태그를 사용하여 노드 실행 시 필요한 파라미터를 정의할 수 있다. ROS2의 파라미터는 노드의 동작을 동적으로 설정하고 조정할 수 있는 중요한 수단이다.</p>
<h4 id="21">2.1. 정적 파라미터 설정</h4>
<p>정적 파라미터는 노드가 시작될 때 한 번 설정되며, 실행 중에는 변경되지 않는다. 이러한 파라미터는 <code>launch</code> 파일 내에서 <code>param</code> 태그로 정의할 수 있다. 예시:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param name=&quot;파라미터_이름&quot; value=&quot;값&quot; /&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>이 방식으로 설정된 파라미터는 노드가 실행되는 동안 유지되며, 프로그램이 종료될 때까지 동일한 값을 갖는다.</p>
<h4 id="22">2.2. 동적 파라미터 전달</h4>
<p>동적 파라미터는 노드 실행 중에도 변경될 수 있다. 이를 통해 런타임 중에도 노드의 동작을 조정할 수 있다. ROS2는 <code>rclcpp::ParameterEvent</code>를 사용하여 이러한 동적 파라미터 변경을 처리하며, 노드는 특정 이벤트가 발생할 때 파라미터를 업데이트할 수 있다.</p>
<p>노드의 동적 파라미터는 다음과 같이 설정할 수 있다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param name=&quot;파라미터_이름&quot; value=&quot;값&quot; /&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>또한, 노드에서 동적으로 파라미터를 받아들이기 위해서는 <code>set_parameters_callback</code> 함수를 사용하여 파라미터 변경을 처리해야 한다.</p>
<pre><code class="language-cpp">this-&gt;set_parameters_callback([this](const std::vector&lt;rclcpp::Parameter&gt; &amp; parameters) {
    for (const auto &amp; parameter : parameters) {
        if (parameter.get_name() == &quot;파라미터_이름&quot;) {
            // 파라미터 변경 처리 로직
        }
    }
});
</code></pre>
<h4 id="23">2.3. 파라미터 파일 사용</h4>
<p>파라미터를 파일로 관리할 수도 있다. ROS2는 YAML 파일 형식을 사용하여 여러 파라미터를 한꺼번에 정의하고, 이 파일을 <code>launch</code> 파일에서 불러와 사용할 수 있다. 예시 YAML 파일은 다음과 같다:</p>
<pre><code class="language-yaml">노드_이름:
    ros__parameters:
        파라미터_이름1: 값1
        파라미터_이름2: 값2
</code></pre>
<p>YAML 파일을 사용하는 <code>launch</code> 파일은 다음과 같다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param file=&quot;파라미터파일.yaml&quot; /&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>이 방식은 여러 노드가 동일한 파라미터 파일을 공유해야 할 때 유용하며, 각 노드의 파라미터 설정을 한 번에 관리할 수 있는 장점을 제공한다.</p>
<h3 id="3">3. 런타임 파라미터 수정</h3>
<p>실시간으로 파라미터를 수정하려면 <code>ros2 param</code> 명령을 사용하여 변경할 수 있다. 예를 들어, 실행 중인 노드의 특정 파라미터를 수정하려면 다음과 같은 명령을 입력한다:</p>
<pre><code class="language-bash">ros2 param set /노드_이름 파라미터_이름 새_값
</code></pre>
<p>이 명령은 노드가 실행 중일 때 해당 파라미터 값을 즉시 변경하며, 노드에서 설정된 파라미터 콜백 함수를 통해 그에 맞는 처리를 수행할 수 있다.</p>
<h3 id="4-launch">4. launch 파일에서 파라미터 관련 동작 관리</h3>
<p><code>launch</code> 파일에서 파라미터의 유효성 검증이나 조건부 실행 등의 동작을 추가로 설정할 수 있다. 예를 들어, 특정 조건에 따라 노드를 실행할지 말지를 결정하는 구조를 <code>launch</code> 파일에 추가할 수 있다. 이는 복잡한 시스템을 구성할 때 매우 유용하며, 시스템의 유연성을 높여준다.</p>
<h3 id="5">5. 파라미터와 런치 파일에서의 조건부 실행</h3>
<p>파라미터를 이용하여 특정 조건에 따라 노드의 실행을 제어할 수 있다. <code>launch</code> 파일에서는 다양한 조건문을 활용해 파라미터 값에 따라 노드를 실행하거나 특정 동작을 수행하도록 설정할 수 있다.</p>
<h4 id="51">5.1. 조건부 실행 예제</h4>
<p>다음은 파라미터 값을 기준으로 노드의 실행 여부를 결정하는 간단한 예제다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;arg name=&quot;use_node&quot; default_value=&quot;true&quot; /&gt;
    &lt;node
        if=&quot;$(arg use_node)&quot;
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>위 예제에서는 <code>use_node</code>라는 인자를 통해 노드의 실행 여부를 제어할 수 있다. <code>launch</code> 파일을 실행할 때, <code>use_node</code> 인자의 값을 <code>true</code> 또는 <code>false</code>로 설정하여 해당 노드를 실행할지 말지를 결정할 수 있다.</p>
<h4 id="52">5.2. 파라미터 값에 따른 실행 조건</h4>
<p>특정 파라미터 값에 따라 실행 조건을 다르게 설정할 수 있다. 예를 들어, <code>launch</code> 파일에서 파라미터 값을 기준으로 노드의 실행 여부를 제어하는 방식은 다음과 같다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param name=&quot;파라미터_이름&quot; value=&quot;1&quot; /&gt;
        &lt;node_if value=&quot;$(eval 파라미터_이름 == 1)&quot;&gt;
            &lt;!-- 파라미터 값이 1일 때만 실행 --&gt;
        &lt;/node_if&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>이 예제는 노드의 파라미터가 특정 값일 때만 실행하는 조건부 논리를 적용한다. 이를 통해 노드의 실행을 더 세밀하게 제어할 수 있으며, 복잡한 시스템에서도 유용하다.</p>
<h3 id="6">6. 파라미터 설정을 위한 런치 옵션 활용</h3>
<p>ROS2에서는 파라미터를 <code>launch</code> 파일에 인자로 전달하여 다양한 설정을 미리 정의할 수 있다. 예를 들어, 특정 값에 따라 다른 파라미터를 적용하거나, 파라미터를 사용자 정의 인자로 설정하여 <code>launch</code> 파일을 더욱 유연하게 만들 수 있다.</p>
<h4 id="61">6.1. 런치 파일 인자 설정 예시</h4>
<p>다음은 <code>launch</code> 파일에서 인자를 통해 파라미터 값을 설정하는 예시다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;arg name=&quot;파라미터_이름&quot; default_value=&quot;5&quot; /&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param name=&quot;파라미터_이름&quot; value=&quot;$(arg 파라미터_이름)&quot; /&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>이 예제에서는 <code>파라미터_이름</code>이라는 인자를 통해 노드가 시작될 때 파라미터 값을 지정할 수 있다. <code>launch</code> 파일 실행 시 인자의 값을 전달하여, 노드가 사용하는 파라미터 값을 동적으로 설정할 수 있게 된다.</p>
<h3 id="7">7. 파라미터 유효성 검증</h3>
<p><code>launch</code> 파일에서 파라미터를 설정할 때, 입력된 파라미터가 유효한 값인지 검증하는 것이 필요할 수 있다. 이를 위해 <code>launch</code> 파일 내에서 파라미터의 값 범위를 지정하거나, 특정 값에 대한 예외 처리를 설정할 수 있다.</p>
<h4 id="71">7.1. 파라미터 유효성 검증 예시</h4>
<p>파라미터의 값이 지정된 범위를 벗어났을 때 노드를 실행하지 않도록 설정할 수 있다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;arg name=&quot;파라미터_이름&quot; default_value=&quot;5&quot; /&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param name=&quot;파라미터_이름&quot; value=&quot;$(arg 파라미터_이름)&quot; /&gt;
        &lt;node_if value=&quot;$(eval 파라미터_이름 &gt;= 1 and 파라미터_이름 &lt;= 10)&quot;&gt;
            &lt;!-- 파라미터 값이 1과 10 사이일 때만 실행 --&gt;
        &lt;/node_if&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>이 구조는 파라미터가 유효한 값일 때에만 노드를 실행할 수 있게 해주며, 잘못된 값이 입력되었을 때 시스템이 오작동하지 않도록 예방할 수 있다.</p>
<h3 id="8">8. 파라미터 파일을 통한 복잡한 설정 관리</h3>
<p>ROS2에서는 복잡한 시스템 구성을 관리하기 위해 파라미터 파일을 사용하여 다양한 설정을 중앙에서 관리할 수 있다. 파라미터 파일은 YAML 형식으로 작성되며, 여러 노드에 공통적인 설정이나 각각의 노드에 필요한 고유한 설정을 명확하게 구분할 수 있다.</p>
<h4 id="81-yaml">8.1. YAML 파라미터 파일의 구조</h4>
<p>파라미터 파일은 노드 이름을 키로 하여 해당 노드가 사용할 파라미터들을 정의한다. 기본 구조는 다음과 같다:</p>
<pre><code class="language-yaml">노드_이름:
  ros__parameters:
    파라미터_이름1: 값1
    파라미터_이름2: 값2
</code></pre>
<p>이 예시는 특정 노드가 두 개의 파라미터를 사용할 수 있도록 설정한 YAML 파일이다. 각 파라미터는 <code>ros__parameters</code> 섹션 아래에 위치하며, 해당 노드의 설정을 관리한다.</p>
<h4 id="82">8.2. 파라미터 파일의 활용</h4>
<p><code>launch</code> 파일에서 이 YAML 파일을 불러와 노드에 파라미터를 적용하는 방법은 다음과 같다:</p>
<pre><code class="language-xml">&lt;launch&gt;
    &lt;node
        name=&quot;노드_이름&quot;
        pkg=&quot;패키지_이름&quot;
        exec=&quot;실행파일_이름&quot;
        output=&quot;screen&quot;&gt;
        &lt;param file=&quot;path/to/파라미터파일.yaml&quot; /&gt;
    &lt;/node&gt;
&lt;/launch&gt;
</code></pre>
<p>이렇게 하면, 노드가 시작될 때 <code>path/to/파라미터파일.yaml</code> 경로에 있는 YAML 파일을 참조하여 파라미터가 자동으로 설정된다. 이를 통해 복잡한 시스템에서도 중앙 관리 방식으로 파라미터 설정을 용이하게 할 수 있다.</p>
<h4 id="83">8.3. 다중 노드 파라미터 관리</h4>
<p>YAML 파일은 하나 이상의 노드에 대한 설정을 한꺼번에 관리할 수 있다. 예를 들어, 여러 노드가 존재할 때 각 노드의 파라미터를 다음과 같이 정의할 수 있다:</p>
<pre><code class="language-yaml">노드_이름1:
  ros__parameters:
    파라미터_이름1: 값1
    파라미터_이름2: 값2

노드_이름2:
  ros__parameters:
    파라미터_이름1: 값3
    파라미터_이름2: 값4
</code></pre>
<p>이 방식은 여러 노드가 같은 파라미터를 공유하거나, 노드마다 다른 파라미터를 적용해야 할 때 유용하다. <code>launch</code> 파일에서 이 YAML 파일을 불러와서 노드에 필요한 파라미터를 한 번에 설정할 수 있다.</p>
<h3 id="9">9. 동적 파라미터 재구성</h3>
<p>ROS2는 런타임 중에도 파라미터 값을 동적으로 재구성할 수 있는 기능을 제공한다. 이는 시스템이 동작 중일 때 환경 변화나 요구 사항에 맞춰 파라미터를 수정하여 노드의 동작을 조정하는 데 유용하다.</p>
<h4 id="91">9.1. 동적 파라미터 변경</h4>
<p>노드가 실행 중일 때, <code>ros2 param</code> 명령어를 사용하여 파라미터를 수정할 수 있다. 예를 들어, 노드의 특정 파라미터를 실시간으로 변경하려면 다음과 같은 명령어를 사용할 수 있다:</p>
<pre><code class="language-bash">ros2 param set /노드_이름 파라미터_이름 새_값
</code></pre>
<p>이 명령어는 노드가 실행되는 동안 <code>파라미터_이름</code>의 값을 <code>새_값</code>으로 즉시 변경한다. 이를 통해 시스템의 동작을 실시간으로 조정할 수 있으며, 이 과정은 ROS2 노드가 설정한 파라미터 콜백을 통해 처리된다.</p>
<h4 id="92">9.2. 파라미터 변경 이벤트 처리</h4>
<p>파라미터 변경 이벤트는 노드 내부에서 콜백 함수로 처리된다. 이를 위해 <code>set_parameters_callback</code> 함수를 사용하여 파라미터 변경 시 발생하는 이벤트를 처리할 수 있다. 다음은 파라미터 이벤트 처리의 예시다:</p>
<pre><code class="language-cpp">this-&gt;set_parameters_callback([this](const std::vector&lt;rclcpp::Parameter&gt; &amp; parameters) {
    for (const auto &amp; parameter : parameters) {
        if (parameter.get_name() == &quot;파라미터_이름&quot;) {
            // 파라미터 변경에 대한 처리 로직
        }
    }
});
</code></pre>
<p>이 코드는 파라미터가 변경될 때마다 해당 이벤트를 감지하고, 노드의 동작을 수정하는 데 사용된다. 특히 실시간 시스템에서는 파라미터 변경을 통해 노드의 동작을 즉각적으로 조정할 수 있어 매우 유용하다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1003/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1003/" class="btn btn-xs btn-link">
        다중 노드 실행 및 그룹 실행
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1001/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1001/" class="btn btn-xs btn-link">
        launch 파일 생성과 실행
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>