<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/robot_simulation_with_urdf_sdf/chapter_17/1703/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>변수와 조건문 사용 - 실험 도서관</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\ubcc0\uc218 \uc0ac\uc6a9\ud558\uae30", url: "#_top", children: [
          ]},
          {title: "\uc870\uac74\ubb38 \uc0ac\uc6a9\ud558\uae30", url: "#_2", children: [
          ]},
          {title: "\uc870\uac74\ubb38 \ub0b4\uc5d0\uc11c \ubcc0\uc218 \uc0ac\uc6a9\ud558\uae30", url: "#_3", children: [
              {title: "\uc608\uc2dc: \ub9c1\ud06c \uae38\uc774\uc5d0 \ub530\ub77c \uc870\uc778\ud2b8 \uc120\ud0dd", url: "#_4" },
          ]},
          {title: "\uc218\ud559\uc801 \uacc4\uc0b0\uacfc \ubcc0\uc218 \ud65c\uc6a9", url: "#_5", children: [
              {title: "\uc608\uc2dc: \uad00\uc131 \ud150\uc11c \uc815\uc758", url: "#_6" },
          ]},
          {title: "\uc870\uac74\ubb38\uacfc \ub9e4\uac1c\ubcc0\uc218\ud654\ub41c \ubaa8\ub378 \ud65c\uc6a9", url: "#_7", children: [
              {title: "\uc608\uc2dc: \ub85c\ubd07\uc758 \ud314 \uae38\uc774 \uc124\uc815", url: "#_8" },
          ]},
          {title: "\uc218\uc2dd \uc801\uc6a9 \ubc0f \uc870\uac74 \uae30\ubc18 \uacc4\uc0b0", url: "#_9", children: [
              {title: "\uc608\uc2dc: \ub9c1\ud06c\uc758 \uc704\uce58 \uacc4\uc0b0", url: "#_10" },
          ]},
          {title: "\uc870\uac74\ubb38\uc744 \ud1b5\ud55c \ub85c\ubd07 \uad6c\uc131 \uc120\ud0dd", url: "#_11", children: [
              {title: "\uc608\uc2dc: \ub2e4\uc911 \uc870\uac74\ubb38\uc744 \uc0ac\uc6a9\ud55c \uad6c\uc131 \uc120\ud0dd", url: "#_12" },
          ]},
          {title: "\ubcf5\uc7a1\ud55c \uc218\uc2dd\uacfc \uc870\uac74\ubb38\uc744 \ud568\uaed8 \uc0ac\uc6a9\ud558\uae30", url: "#_13", children: [
              {title: "\uc608\uc2dc: \ud1a0\ud06c \uacc4\uc0b0\uacfc \uc870\uac74\ubb38", url: "#_14" },
          ]},
          {title: "\ubcf5\uc7a1\ud55c \ubcc0\uc218 \uc5f0\uc0b0\uc744 \ud1b5\ud55c \ucd5c\uc801\ud654", url: "#_15", children: [
              {title: "\uc608\uc2dc: \ubb34\uac8c \uc911\uc2ec \uacc4\uc0b0", url: "#_16" },
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../chapter_18/1801/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../chapter_18/1801/" class="btn btn-xs btn-link">
        반복적인 구조 간소화
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1702/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1702/" class="btn btn-xs btn-link">
        매크로 정의 및 활용
      </a>
    </div>
    
  </div>

    

    <h3 id="_1">변수 사용하기</h3>
<p>xacro 파일에서는 로봇 모델을 더욱 유연하게 만들기 위해 변수를 정의하고 사용할 수 있다. 이를 통해 URDF 파일을 생성할 때 반복적인 작업을 줄이고, 매개변수화를 통해 하나의 모델을 다양한 구성으로 재사용할 수 있다.</p>
<p>변수는 <code>xacro</code> 태그를 사용하여 선언한다. 예를 들어, 링크의 길이와 같은 값을 변수로 정의하고, 이를 URDF 파일에서 참조할 수 있다. 다음은 기본적인 변수 정의의 예시이다:</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;link_length&quot; value=&quot;1.0&quot;/&gt;
</code></pre>
<p>이렇게 정의된 변수 <code>link_length</code>는 이후 URDF 파일의 필요한 부분에서 사용할 수 있다. 예를 들어, 링크의 길이를 정의하는 부분에서 이를 참조할 수 있다:</p>
<pre><code class="language-xml">&lt;link name=&quot;example_link&quot;&gt;
  &lt;visual&gt;
    &lt;geometry&gt;
      &lt;box size=&quot;${link_length} 0.1 0.1&quot;/&gt;
    &lt;/geometry&gt;
  &lt;/visual&gt;
&lt;/link&gt;
</code></pre>
<p>이와 같이 변수는 <code>${}</code>로 감싸서 참조한다. 이를 통해 링크의 크기를 변수로 쉽게 제어할 수 있다.</p>
<h3 id="_2">조건문 사용하기</h3>
<p><code>xacro</code>에서는 조건문을 사용하여 모델의 구성 요소를 조건에 따라 선택적으로 포함할 수 있다. 조건문은 주로 <code>if</code>와 <code>unless</code>를 사용하여 구현된다. 이를 통해 특정 조건이 만족될 때만 로봇 모델의 특정 부분을 포함하거나 제외할 수 있다.</p>
<p>조건문의 구조는 다음과 같다:</p>
<pre><code class="language-xml">&lt;xacro:if value=&quot;${condition}&quot;&gt;
  &lt;!-- 조건이 참일 때 포함될 내용 --&gt;
&lt;/xacro:if&gt;

&lt;xacro:unless value=&quot;${condition}&quot;&gt;
  &lt;!-- 조건이 거짓일 때 포함될 내용 --&gt;
&lt;/xacro:unless&gt;
</code></pre>
<p>예를 들어, 로봇의 바퀴가 있는 경우와 없는 경우를 구분하여 모델링할 수 있다. 바퀴의 존재 여부를 변수로 정의하고, 이 변수의 값에 따라 바퀴를 포함할지 결정할 수 있다:</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;has_wheels&quot; value=&quot;true&quot;/&gt;

&lt;xacro:if value=&quot;${has_wheels}&quot;&gt;
  &lt;link name=&quot;wheel_link&quot;&gt;
    &lt;visual&gt;
      &lt;geometry&gt;
        &lt;cylinder radius=&quot;0.1&quot; length=&quot;0.05&quot;/&gt;
      &lt;/geometry&gt;
    &lt;/visual&gt;
  &lt;/link&gt;
&lt;/xacro:if&gt;
</code></pre>
<p>위 코드는 <code>has_wheels</code> 변수가 <code>true</code>일 때만 바퀴 링크를 포함하게 된다.</p>
<p>조건문은 로봇 모델의 복잡성을 줄이고, 다양한 시뮬레이션 환경에 맞춰 모델을 동적으로 구성하는 데 유용하다. 예를 들어, 센서의 유무, 로봇의 크기 및 형태에 따라 조건문을 사용하여 유연하게 대처할 수 있다.</p>
<h3 id="_3">조건문 내에서 변수 사용하기</h3>
<p><code>xacro</code>에서는 조건문 내에서 변수의 값을 기반으로 다양한 설정을 할 수 있다. 변수와 조건문을 결합하면 로봇의 특정 부분을 더욱 세밀하게 제어할 수 있다. 예를 들어, 변수의 값이 특정 범위에 있을 때만 동작하는 코드를 작성할 수 있다.</p>
<h4 id="_4">예시: 링크 길이에 따라 조인트 선택</h4>
<p>다음 예제에서는 링크의 길이가 일정 값 이상일 경우에만 특정 조인트를 추가하는 방식으로 조건문을 사용할 수 있다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;link_length&quot; value=&quot;1.2&quot;/&gt;

&lt;xacro:if value=&quot;${link_length &gt; 1.0}&quot;&gt;
  &lt;joint name=&quot;extra_joint&quot; type=&quot;fixed&quot;&gt;
    &lt;parent link=&quot;base_link&quot;/&gt;
    &lt;child link=&quot;extended_link&quot;/&gt;
    &lt;origin xyz=&quot;0 0 ${link_length}&quot; rpy=&quot;0 0 0&quot;/&gt;
  &lt;/joint&gt;
&lt;/xacro:if&gt;
</code></pre>
<p>위 예제에서는 링크의 길이(<code>link_length</code>)가 1.0보다 클 때만 <code>extra_joint</code>가 생성된다. 이는 로봇의 특정 구성이 값에 따라 달라질 수 있음을 보여주는 대표적인 사례이다.</p>
<h3 id="_5">수학적 계산과 변수 활용</h3>
<p><code>xacro</code>에서는 간단한 수학적 연산도 지원하여 변수 간의 계산을 수행할 수 있다. 이를 통해 더 복잡한 모델링 작업을 자동화할 수 있다. 다음은 변수 간의 곱셈을 통해 새로운 값을 정의하는 예시이다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;base_length&quot; value=&quot;1.0&quot;/&gt;
&lt;xacro:property name=&quot;scale_factor&quot; value=&quot;2.0&quot;/&gt;
&lt;xacro:property name=&quot;scaled_length&quot; value=&quot;${base_length * scale_factor}&quot;/&gt;
</code></pre>
<p>위 코드에서 <code>base_length</code>와 <code>scale_factor</code>를 곱하여 새로운 변수 <code>scaled_length</code>를 정의하였다. 이를 통해 크기 조정, 비율 계산 등 다양한 상황에서 수학적 계산을 자동으로 처리할 수 있다.</p>
<p>또한, 수식 내에서 벡터 및 행렬 연산을 활용할 수 있다. 예를 들어, 좌표 변환이나 로봇의 관성 모멘트 계산 등을 자동화할 수 있다.</p>
<h4 id="_6">예시: 관성 텐서 정의</h4>
<p>로봇의 링크에 대한 관성 텐서를 정의할 때, 링크의 질량과 크기를 변수로 설정하고 이를 통해 관성 텐서를 계산할 수 있다. 다음은 단순한 직육면체의 관성 텐서를 계산하는 예시이다.</p>
<p>직육면체의 관성 텐서는 다음과 같이 계산된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{I} = \begin{bmatrix} 
  \frac{1}{12}m(b^2 + c^2) &amp; 0 &amp; 0 \\
  0 &amp; \frac{1}{12}m(a^2 + c^2) &amp; 0 \\
  0 &amp; 0 &amp; \frac{1}{12}m(a^2 + b^2)
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{I} = \begin{bmatrix} 
  \frac{1}{12}m(b^2 + c^2) & 0 & 0 \\
  0 & \frac{1}{12}m(a^2 + c^2) & 0 \\
  0 & 0 & \frac{1}{12}m(a^2 + b^2)
\end{bmatrix}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>은 링크의 질량이고, <span class="arithmatex"><span class="MathJax_Preview">a, b, c</span><script type="math/tex">a, b, c</script></span>는 각각 링크의 길이, 너비, 높이이다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;mass&quot; value=&quot;2.0&quot;/&gt;
&lt;xacro:property name=&quot;length&quot; value=&quot;1.0&quot;/&gt;
&lt;xacro:property name=&quot;width&quot; value=&quot;0.2&quot;/&gt;
&lt;xacro:property name=&quot;height&quot; value=&quot;0.1&quot;/&gt;

&lt;inertia ixx=&quot;${mass * (width^2 + height^2) / 12.0}&quot; 
         iyy=&quot;${mass * (length^2 + height^2) / 12.0}&quot; 
         izz=&quot;${mass * (length^2 + width^2) / 12.0}&quot; 
         ixy=&quot;0.0&quot; ixz=&quot;0.0&quot; iyz=&quot;0.0&quot;/&gt;
</code></pre>
<p>위 예시에서는 <code>xacro</code>를 통해 관성 모멘트를 자동으로 계산하고, 이를 URDF 파일에 포함시킬 수 있다.</p>
<h3 id="_7">조건문과 매개변수화된 모델 활용</h3>
<p>xacro에서 조건문과 변수를 활용하면 로봇 모델을 매개변수화하여 다양한 설정에 따라 유연하게 변형할 수 있다. 이를 통해 사용자는 하나의 xacro 파일을 여러 상황에 맞게 재사용할 수 있으며, 로봇 모델의 복잡성을 줄일 수 있다.</p>
<h4 id="_8">예시: 로봇의 팔 길이 설정</h4>
<p>로봇의 팔 길이를 매개변수로 설정하고, 그 길이에 따라 다른 부품을 추가하는 방법을 설명하겠다. 로봇의 팔 길이가 일정 값 이상일 경우 추가적인 링크나 조인트를 생성하고, 그렇지 않으면 기본적인 설정만 유지할 수 있다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;arm_length&quot; value=&quot;1.5&quot;/&gt;

&lt;link name=&quot;arm_base&quot;&gt;
  &lt;visual&gt;
    &lt;geometry&gt;
      &lt;box size=&quot;0.05 0.05 ${arm_length}&quot;/&gt;
    &lt;/geometry&gt;
  &lt;/visual&gt;
&lt;/link&gt;

&lt;xacro:if value=&quot;${arm_length &gt; 1.0}&quot;&gt;
  &lt;link name=&quot;extension_link&quot;&gt;
    &lt;visual&gt;
      &lt;geometry&gt;
        &lt;box size=&quot;0.05 0.05 0.5&quot;/&gt;
      &lt;/geometry&gt;
    &lt;/visual&gt;
  &lt;/link&gt;
  &lt;joint name=&quot;extension_joint&quot; type=&quot;fixed&quot;&gt;
    &lt;parent link=&quot;arm_base&quot;/&gt;
    &lt;child link=&quot;extension_link&quot;/&gt;
    &lt;origin xyz=&quot;0 0 ${arm_length}&quot; rpy=&quot;0 0 0&quot;/&gt;
  &lt;/joint&gt;
&lt;/xacro:if&gt;
</code></pre>
<p>위 코드는 로봇 팔의 길이가 1.0보다 크면 <code>extension_link</code>와 <code>extension_joint</code>가 추가되도록 조건문을 사용한 예이다. 이렇게 매개변수를 기반으로 모델을 유동적으로 수정할 수 있으며, 복잡한 구조의 로봇을 설계할 때 매우 유용하다.</p>
<h3 id="_9">수식 적용 및 조건 기반 계산</h3>
<p>복잡한 수학적 계산이 필요한 경우에도 <code>xacro</code>는 간단한 수식을 활용하여 동적인 값 생성을 지원한다. 예를 들어, 로봇의 구조를 구성하는 각 링크의 위치를 변수화하고, 이를 계산하여 조건에 따라 값을 설정할 수 있다.</p>
<h4 id="_10">예시: 링크의 위치 계산</h4>
<p>다음은 링크의 위치를 계산하고, 이를 조건문과 결합하여 위치에 따른 조인트를 정의하는 예시이다. 링크의 길이에 따라 그 다음 링크의 위치를 결정할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{p}_{\text{next}} = \mathbf{p}_{\text{prev}} + \mathbf{l}
</div>
<script type="math/tex; mode=display">
\mathbf{p}_{\text{next}} = \mathbf{p}_{\text{prev}} + \mathbf{l}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_{\text{next}}</span><script type="math/tex">\mathbf{p}_{\text{next}}</script></span>는 다음 링크의 위치, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_{\text{prev}}</span><script type="math/tex">\mathbf{p}_{\text{prev}}</script></span>는 이전 링크의 위치, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{l}</span><script type="math/tex">\mathbf{l}</script></span>은 링크의 길이이다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;link_length&quot; value=&quot;1.0&quot;/&gt;
&lt;xacro:property name=&quot;prev_position&quot; value=&quot;0.0&quot;/&gt;

&lt;xacro:property name=&quot;next_position&quot; value=&quot;${prev_position + link_length}&quot;/&gt;

&lt;link name=&quot;next_link&quot;&gt;
  &lt;visual&gt;
    &lt;geometry&gt;
      &lt;box size=&quot;0.1 0.1 ${link_length}&quot;/&gt;
    &lt;/geometry&gt;
  &lt;/visual&gt;
  &lt;origin xyz=&quot;0 0 ${next_position}&quot; rpy=&quot;0 0 0&quot;/&gt;
&lt;/link&gt;
</code></pre>
<p>이와 같이 수식을 통해 링크 간의 관계를 정의하고, 이를 자동으로 계산하여 로봇 모델에 적용할 수 있다. 각 링크의 길이에 따라 그 위치가 결정되며, 로봇 모델의 크기나 형태를 다양한 구성으로 매개변수화할 수 있다.</p>
<h3 id="_11">조건문을 통한 로봇 구성 선택</h3>
<p>복잡한 로봇 모델에서는 각 부품이 상황에 따라 존재하거나 없어야 할 수 있다. 이때 <code>xacro</code>의 조건문을 사용하면 유연하게 모델을 구성할 수 있다. 조건문은 단순한 <code>if</code>, <code>unless</code> 외에도 변수 값을 기반으로 하여 여러 가지 구성을 선택하는 방식으로 확장할 수 있다.</p>
<h4 id="_12">예시: 다중 조건문을 사용한 구성 선택</h4>
<p>다음 예제에서는 로봇의 두 가지 구성을 제어하는 변수를 정의하고, 그 값에 따라 다른 로봇 부품을 선택적으로 추가하는 방식을 보여준다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;robot_version&quot; value=&quot;2&quot;/&gt;

&lt;xacro:if value=&quot;${robot_version == 1}&quot;&gt;
  &lt;link name=&quot;simple_arm&quot;&gt;
    &lt;visual&gt;
      &lt;geometry&gt;
        &lt;box size=&quot;0.05 0.05 1.0&quot;/&gt;
      &lt;/geometry&gt;
    &lt;/visual&gt;
  &lt;/link&gt;
  &lt;joint name=&quot;simple_arm_joint&quot; type=&quot;fixed&quot;&gt;
    &lt;parent link=&quot;base_link&quot;/&gt;
    &lt;child link=&quot;simple_arm&quot;/&gt;
    &lt;origin xyz=&quot;0 0 1.0&quot; rpy=&quot;0 0 0&quot;/&gt;
  &lt;/joint&gt;
&lt;/xacro:if&gt;

&lt;xacro:if value=&quot;${robot_version == 2}&quot;&gt;
  &lt;link name=&quot;advanced_arm&quot;&gt;
    &lt;visual&gt;
      &lt;geometry&gt;
        &lt;cylinder radius=&quot;0.1&quot; length=&quot;1.0&quot;/&gt;
      &lt;/geometry&gt;
    &lt;/visual&gt;
  &lt;/link&gt;
  &lt;joint name=&quot;advanced_arm_joint&quot; type=&quot;continuous&quot;&gt;
    &lt;parent link=&quot;base_link&quot;/&gt;
    &lt;child link=&quot;advanced_arm&quot;/&gt;
    &lt;origin xyz=&quot;0 0 1.0&quot; rpy=&quot;0 0 0&quot;/&gt;
  &lt;/joint&gt;
&lt;/xacro:if&gt;
</code></pre>
<p>위 코드에서는 <code>robot_version</code> 변수를 통해 두 가지 다른 로봇 팔을 선택적으로 추가하는 구조를 보여준다. <code>robot_version</code>이 1이면 간단한 팔(<code>simple_arm</code>)이 추가되고, 2일 경우 더 복잡한 팔(<code>advanced_arm</code>)이 추가된다. 이를 통해 로봇 모델의 구성 요소를 유연하게 선택할 수 있다.</p>
<h3 id="_13">복잡한 수식과 조건문을 함께 사용하기</h3>
<p>변수와 조건문을 함께 사용하면 복잡한 수식을 포함하는 로봇 모델의 특정 부분을 제어할 수 있다. 특히 운동학적 구조에서 링크 간의 관계를 정의하거나, 동역학 모델에서 힘과 토크를 계산하는 데 유용하다.</p>
<h4 id="_14">예시: 토크 계산과 조건문</h4>
<p>다음은 로봇의 조인트에 적용되는 토크를 계산하고, 그 값에 따라 조인트의 동작 방식을 조건부로 변경하는 예시이다. 조인트에 적용되는 토크는 다음과 같은 수식으로 계산할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\tau = r \times F
</div>
<script type="math/tex; mode=display">
\tau = r \times F
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\tau</span><script type="math/tex">\tau</script></span>는 토크, <span class="arithmatex"><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span>은 조인트의 회전 반경, <span class="arithmatex"><span class="MathJax_Preview">F</span><script type="math/tex">F</script></span>는 적용된 힘이다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;force&quot; value=&quot;10.0&quot;/&gt;
&lt;xacro:property name=&quot;radius&quot; value=&quot;0.5&quot;/&gt;
&lt;xacro:property name=&quot;torque&quot; value=&quot;${radius * force}&quot;/&gt;

&lt;xacro:if value=&quot;${torque &gt; 5.0}&quot;&gt;
  &lt;joint name=&quot;high_torque_joint&quot; type=&quot;continuous&quot;&gt;
    &lt;parent link=&quot;base_link&quot;/&gt;
    &lt;child link=&quot;arm_link&quot;/&gt;
    &lt;origin xyz=&quot;0 0 1.0&quot; rpy=&quot;0 0 0&quot;/&gt;
    &lt;limit effort=&quot;${torque}&quot; velocity=&quot;2.0&quot;/&gt;
  &lt;/joint&gt;
&lt;/xacro:if&gt;

&lt;xacro:unless value=&quot;${torque &gt; 5.0}&quot;&gt;
  &lt;joint name=&quot;low_torque_joint&quot; type=&quot;revolute&quot;&gt;
    &lt;parent link=&quot;base_link&quot;/&gt;
    &lt;child link=&quot;arm_link&quot;/&gt;
    &lt;origin xyz=&quot;0 0 1.0&quot; rpy=&quot;0 0 0&quot;/&gt;
    &lt;limit effort=&quot;${torque}&quot; velocity=&quot;1.0&quot;/&gt;
  &lt;/joint&gt;
&lt;/xacro:unless&gt;
</code></pre>
<p>이 예시에서는 토크 값이 5.0보다 클 때와 작을 때 다른 종류의 조인트를 생성한다. 조건문을 사용하여 계산된 토크 값에 따라 로봇의 동작을 다르게 설정할 수 있으며, 복잡한 운동학적 구조에서도 이러한 방식을 사용할 수 있다.</p>
<h3 id="_15">복잡한 변수 연산을 통한 최적화</h3>
<p>xacro에서 변수를 활용하여 복잡한 계산을 처리하고, 이를 통해 모델의 다양한 요소를 최적화할 수 있다. 예를 들어, 로봇의 전체적인 무게 중심을 계산하여 각 링크의 위치를 조정하거나, 로봇의 각 부분의 크기와 무게를 동적으로 할당할 수 있다.</p>
<h4 id="_16">예시: 무게 중심 계산</h4>
<p>로봇의 각 링크의 질량과 위치를 매개변수화하여 무게 중심을 계산할 수 있다. 로봇의 전체 무게 중심은 다음과 같은 수식으로 계산된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{r}_{\text{cm}} = \frac{1}{M} \sum_{i} m_i \mathbf{r}_i
</div>
<script type="math/tex; mode=display">
\mathbf{r}_{\text{cm}} = \frac{1}{M} \sum_{i} m_i \mathbf{r}_i
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>은 전체 질량, <span class="arithmatex"><span class="MathJax_Preview">m_i</span><script type="math/tex">m_i</script></span>는 각 링크의 질량, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{r}_i</span><script type="math/tex">\mathbf{r}_i</script></span>는 각 링크의 위치이다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;mass_link1&quot; value=&quot;2.0&quot;/&gt;
&lt;xacro:property name=&quot;mass_link2&quot; value=&quot;3.0&quot;/&gt;
&lt;xacro:property name=&quot;position_link1&quot; value=&quot;1.0&quot;/&gt;
&lt;xacro:property name=&quot;position_link2&quot; value=&quot;2.0&quot;/&gt;
&lt;xacro:property name=&quot;total_mass&quot; value=&quot;${mass_link1 + mass_link2}&quot;/&gt;
&lt;xacro:property name=&quot;center_of_mass&quot; value=&quot;${(mass_link1 * position_link1 + mass_link2 * position_link2) / total_mass}&quot;/&gt;

&lt;link name=&quot;robot_body&quot;&gt;
  &lt;visual&gt;
    &lt;geometry&gt;
      &lt;box size=&quot;1.0 0.5 0.2&quot;/&gt;
    &lt;/geometry&gt;
  &lt;/visual&gt;
  &lt;origin xyz=&quot;0 0 ${center_of_mass}&quot; rpy=&quot;0 0 0&quot;/&gt;
&lt;/link&gt;
</code></pre>
<p>위 예시에서는 두 링크의 질량과 위치를 바탕으로 로봇의 전체 무게 중심을 계산한다. 이를 통해 로봇의 동작이 더 안정적이고, 무게 중심에 따른 동적 제어가 가능해진다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../chapter_18/1801/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../chapter_18/1801/" class="btn btn-xs btn-link">
        반복적인 구조 간소화
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1702/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1702/" class="btn btn-xs btn-link">
        매크로 정의 및 활용
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>