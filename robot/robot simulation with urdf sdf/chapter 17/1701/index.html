<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/robot%20simulation%20with%20urdf%20sdf/chapter%2017/1701/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>xacro의 기본 구조 - 실험 도서관</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "xacro \ud30c\uc77c\uc758 \uc2dc\uc791\uacfc \uc120\uc5b8", url: "#_top", children: [
          ]},
          {title: "\ub9e4\ud06c\ub85c \uc815\uc758", url: "#_1", children: [
          ]},
          {title: "\ub9e4\ud06c\ub85c \ud638\ucd9c", url: "#_2", children: [
          ]},
          {title: "\ubcc0\uc218 \uc0ac\uc6a9", url: "#_3", children: [
          ]},
          {title: "\uc218\uc2dd \uacc4\uc0b0", url: "#_4", children: [
          ]},
          {title: "\uc870\uac74\ubb38", url: "#_5", children: [
          ]},
          {title: "\ubc18\ubcf5\ubb38", url: "#_6", children: [
          ]},
          {title: "include\ub97c \ud1b5\ud55c \ud30c\uc77c \uc7ac\uc0ac\uc6a9", url: "#include", children: [
          ]},
          {title: "\ub9e4\uac1c\ubcc0\uc218\ub97c \ud1b5\ud55c \uc720\uc5f0\ud55c \ubaa8\ub378\ub9c1", url: "#_7", children: [
          ]},
          {title: "URDF\uc5d0\uc11c xacro \ud30c\uc77c \ud638\ucd9c", url: "#urdf-xacro", children: [
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1702/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1702/" class="btn btn-xs btn-link">
        매크로 정의 및 활용
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter%2016/1603/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter%2016/1603/" class="btn btn-xs btn-link">
        매크로와 파라미터화
      </a>
    </div>
    
  </div>

    

    <p>xacro(XML Macros)는 XML 문서를 매크로화하여 반복되는 구조를 간소화할 수 있게 도와준다. 주로 복잡한 URDF 파일을 쉽게 관리하고, 파라미터를 이용해 로봇 모델을 유연하게 정의하는 데 사용된다. 이 섹션에서는 xacro 파일의 기본 구조를 설명한다.</p>
<h3 id="xacro">xacro 파일의 시작과 선언</h3>
<p>xacro 파일은 일반적인 XML 파일과 마찬가지로 XML 선언으로 시작된다. 파일의 최상단에는 <code>&lt;?xml version="1.0"?&gt;</code>와 같은 XML 선언이 들어가며, 이어서 xacro 태그들이 정의된다. xacro 파일은 주로 <code>.xacro</code> 확장자를 가지며, URDF 파일의 대체 형태로 사용된다.</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;robot xmlns:xacro=&quot;http://www.ros.org/wiki/xacro&quot; name=&quot;my_robot&quot;&gt;
  &lt;!-- 매크로와 변수 정의 --&gt;
&lt;/robot&gt;
</code></pre>
<p>위 예시에서 <code>xmlns:xacro</code>는 xacro 매크로를 사용하기 위한 네임스페이스를 선언하는 부분이다. 이 선언을 통해 xacro 명령을 사용하여 로봇 모델의 매크로 및 변수화를 지원할 수 있다.</p>
<h3 id="_1">매크로 정의</h3>
<p>xacro 파일의 핵심 기능 중 하나는 매크로이다. 매크로는 여러 번 반복해서 사용할 수 있는 코드 블록을 정의하고 이를 호출할 수 있게 해준다. 매크로는 <code>&lt;xacro:macro&gt;</code> 태그를 통해 정의된다.</p>
<pre><code class="language-xml">&lt;xacro:macro name=&quot;wheel&quot; params=&quot;radius width&quot;&gt;
  &lt;link name=&quot;wheel_link&quot;&gt;
    &lt;visual&gt;
      &lt;geometry&gt;
        &lt;cylinder radius=&quot;${radius}&quot; length=&quot;${width}&quot; /&gt;
      &lt;/geometry&gt;
    &lt;/visual&gt;
  &lt;/link&gt;
&lt;/xacro:macro&gt;
</code></pre>
<p>위 예제에서 <code>wheel</code>이라는 매크로가 정의되었고, 매개변수로 <code>radius</code>와 <code>width</code>를 받는다. 매크로 내부에서 이 변수들은 <code>${}</code>를 통해 참조된다. 이러한 매크로를 여러 곳에서 재사용할 수 있어 코드의 중복을 줄이고 유지보수를 쉽게 한다.</p>
<h3 id="_2">매크로 호출</h3>
<p>정의된 매크로는 파일 내에서 여러 번 호출될 수 있다. 매크로를 호출할 때는 <code>&lt;xacro:call&gt;</code> 태그를 사용하여 호출하고, 필요에 따라 매개변수를 전달한다.</p>
<pre><code class="language-xml">&lt;xacro:wheel radius=&quot;0.1&quot; width=&quot;0.05&quot; /&gt;
</code></pre>
<p>이 호출은 <code>wheel</code> 매크로를 호출하며, 매개변수 <code>radius</code>에 0.1, <code>width</code>에 0.05를 전달한다. 이로 인해 매크로 내에서 지정된 값에 따라 해당 로봇 구성 요소가 생성된다.</p>
<h3 id="_3">변수 사용</h3>
<p>xacro에서는 매크로뿐만 아니라 변수를 정의하여 파일 내에서 다양한 값들을 동적으로 설정할 수 있다. 변수를 정의할 때는 <code>&lt;xacro:property&gt;</code> 태그를 사용한다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;wheel_radius&quot; value=&quot;0.1&quot; /&gt;
&lt;xacro:property name=&quot;wheel_width&quot; value=&quot;0.05&quot; /&gt;
</code></pre>
<p>위의 예시에서는 <code>wheel_radius</code>와 <code>wheel_width</code>라는 변수가 정의되었다. 각 변수는 파일 내 어디에서든 <code>${}</code> 표기법을 통해 참조할 수 있다. 이렇게 정의된 변수는 여러 곳에서 재사용 가능하므로 코드의 가독성과 관리가 용이해진다.</p>
<pre><code class="language-xml">&lt;xacro:wheel radius=&quot;${wheel_radius}&quot; width=&quot;${wheel_width}&quot; /&gt;
</code></pre>
<p>이 예시에서 <code>wheel_radius</code>와 <code>wheel_width</code> 변수를 사용하여 매크로를 호출하고 있다. 이를 통해, 파일 내에서 해당 값들을 쉽게 변경할 수 있고, 이를 바탕으로 로봇 모델을 유연하게 조정할 수 있다.</p>
<h3 id="_4">수식 계산</h3>
<p>xacro는 단순 변수 참조뿐만 아니라, 수식 계산도 지원한다. 수식 계산은 <code>${}</code> 내부에서 <code>*</code>, <code>+</code>, <code>-</code>, <code>/</code> 등의 연산자를 이용해 수행할 수 있다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;body_length&quot; value=&quot;1.0&quot; /&gt;
&lt;xacro:property name=&quot;half_length&quot; value=&quot;${body_length / 2.0}&quot; /&gt;
</code></pre>
<p>위 예시에서는 <code>body_length</code> 값을 기반으로 <code>half_length</code> 변수를 계산하고 있다. 이처럼 수식을 이용하여 동적으로 변수를 계산할 수 있으며, 이를 통해 더 복잡한 로봇 모델링이 가능한다.</p>
<pre><code class="language-xml">&lt;xacro:wheel radius=&quot;${body_length / 4.0}&quot; width=&quot;${half_length}&quot; /&gt;
</code></pre>
<p>위와 같은 방식으로, 수식을 사용하여 매크로에 전달할 값을 동적으로 계산할 수 있다. </p>
<h3 id="_5">조건문</h3>
<p>xacro는 조건문을 통해 특정 상황에 따라 다른 코드를 실행할 수 있다. <code>&lt;xacro:if&gt;</code> 태그를 사용하여 조건을 정의하며, 조건이 참일 때만 그 안의 코드가 실행된다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;use_large_wheel&quot; value=&quot;true&quot; /&gt;

&lt;xacro:if value=&quot;${use_large_wheel}&quot;&gt;
  &lt;xacro:wheel radius=&quot;0.2&quot; width=&quot;0.1&quot; /&gt;
&lt;/xacro:if&gt;
</code></pre>
<p>이 예시에서는 <code>use_large_wheel</code>이라는 변수가 <code>true</code>일 경우에만 <code>wheel</code> 매크로를 호출한다. 이를 통해, 상황에 따라 다른 모델링 요소를 선택적으로 생성할 수 있다.</p>
<h3 id="_6">반복문</h3>
<p>xacro는 반복문을 지원하여 동일한 구조를 여러 번 생성할 수 있다. 반복문은 <code>&lt;xacro:for-each&gt;</code> 태그를 사용하여 정의하며, 배열이나 리스트와 같은 값을 반복 처리할 수 있다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;wheel_positions&quot; value=&quot;[0.5, 1.0, 1.5]&quot; /&gt;

&lt;xacro:for-each item=&quot;position&quot; value=&quot;${wheel_positions}&quot;&gt;
  &lt;link name=&quot;wheel_${position}&quot;&gt;
    &lt;visual&gt;
      &lt;geometry&gt;
        &lt;cylinder radius=&quot;0.1&quot; length=&quot;0.05&quot; /&gt;
      &lt;/geometry&gt;
      &lt;origin xyz=&quot;${position} 0 0&quot; /&gt;
    &lt;/visual&gt;
  &lt;/link&gt;
&lt;/xacro:for-each&gt;
</code></pre>
<p>위 예시에서는 <code>wheel_positions</code>라는 배열을 정의하고, 각 배열 요소를 <code>position</code>으로 참조하여 반복문을 수행하고 있다. 반복문 내에서 각 바퀴는 <code>position</code> 값에 따라 다른 위치에 생성된다.</p>
<h3 id="include">include를 통한 파일 재사용</h3>
<p>xacro는 다른 파일을 포함할 수 있는 기능을 제공하여 복잡한 URDF 모델을 여러 파일로 분리하고 재사용할 수 있다. 이 기능은 <code>&lt;xacro:include&gt;</code> 태그를 사용하여 구현된다.</p>
<pre><code class="language-xml">&lt;xacro:include filename=&quot;wheel.xacro&quot; /&gt;
</code></pre>
<p>위 코드는 <code>wheel.xacro</code> 파일을 현재 xacro 파일에 포함시킨다. 이를 통해 여러 파일에 걸쳐 있는 로봇 모델을 관리할 수 있으며, 재사용 가능한 매크로나 변수들을 별도의 파일로 분리할 수 있다.</p>
<h3 id="_7">매개변수를 통한 유연한 모델링</h3>
<p>xacro는 파일 내에서 파라미터를 사용하여 로봇 모델의 유연성을 극대화할 수 있다. 매개변수는 명령행이나 launch 파일에서 전달될 수 있으며, 이를 통해 파일 외부에서 로봇 모델의 특성을 동적으로 설정할 수 있다.</p>
<pre><code class="language-xml">&lt;xacro:property name=&quot;wheel_radius&quot; value=&quot;$(arg wheel_radius)&quot; /&gt;
&lt;xacro:property name=&quot;wheel_width&quot; value=&quot;$(arg wheel_width)&quot; /&gt;
</code></pre>
<p>위 코드에서 <code>$(arg)</code>를 사용하여 외부로부터 값을 전달받고 있다. 이를 통해, 동일한 URDF/xacro 파일을 다양한 매개변수 값으로 유연하게 사용할 수 있다.</p>
<h3 id="urdf-xacro">URDF에서 xacro 파일 호출</h3>
<p>xacro 파일을 URDF와 연동하려면, xacro 파일을 실행 가능한 URDF 파일로 변환해야 한다. ROS에서는 이를 위해 <code>xacro</code> 명령을 사용하며, ROS launch 파일에서도 손쉽게 사용할 수 있다.</p>
<pre><code class="language-xml">&lt;param name=&quot;robot_description&quot; command=&quot;$(find xacro)$(find my_robot)/urdf/my_robot.xacro&quot; /&gt;
</code></pre>
<p>위 예시는 <code>robot_description</code>이라는 파라미터에 xacro 파일을 실행하여 생성된 URDF 파일을 저장하는 방법이다. 이 설정은 ROS와의 통합을 통해 시뮬레이션이나 실제 로봇에서 사용할 수 있다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1702/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1702/" class="btn btn-xs btn-link">
        매크로 정의 및 활용
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter%2016/1603/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter%2016/1603/" class="btn btn-xs btn-link">
        매크로와 파라미터화
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>