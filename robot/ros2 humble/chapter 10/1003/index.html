<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/ros2%20humble/chapter%2010/1003/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>다중 노드 실행 및 그룹 실행 - 실험 도서관</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "1. \ub2e4\uc911 \ub178\ub4dc \uc2e4\ud589 \uac1c\uc694", url: "#_top", children: [
          ]},
          {title: "2. \ub7f0\uce58 \ud30c\uc77c\uc744 \ud1b5\ud55c \ub2e4\uc911 \ub178\ub4dc \uc2e4\ud589", url: "#2", children: [
          ]},
          {title: "3. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c\uc758 \ub178\ub4dc \ud30c\ub77c\ubbf8\ud130 \uc124\uc815", url: "#3", children: [
          ]},
          {title: "4. \uadf8\ub8f9 \uc2e4\ud589 \uac1c\uc694", url: "#4", children: [
          ]},
          {title: "5. \uadf8\ub8f9 \uc2e4\ud589\uc5d0\uc11c \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc758 \uc5ed\ud560", url: "#5", children: [
          ]},
          {title: "6. \uc870\uac74\ubd80 \uc2e4\ud589", url: "#6", children: [
          ]},
          {title: "7. \uadf8\ub8f9 \uc2e4\ud589\uc758 \ud65c\uc6a9 \uc608\uc2dc", url: "#7", children: [
          ]},
          {title: "8. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ub9e4\uac1c\ubcc0\uc218 \uc804\ub2ec", url: "#8", children: [
          ]},
          {title: "9. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ud658\uacbd \ubcc0\uc218 \uc124\uc815", url: "#9", children: [
          ]},
          {title: "10. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \uc870\uac74\ubd80 \uadf8\ub8f9 \uc2e4\ud589", url: "#10", children: [
          ]},
          {title: "11. \uadf8\ub8f9 \uc2e4\ud589\uc758 \ub3d9\uae30\ud654", url: "#11", children: [
          ]},
          {title: "12. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \uc870\uac74\ubd80 \uc2e4\ud589\uc744 \ud1b5\ud55c \ub2e4\uc911 \ub178\ub4dc \uadf8\ub8f9 \uc81c\uc5b4", url: "#12", children: [
          ]},
          {title: "13. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \uadf8\ub8f9\ud654\ub41c \ub178\ub4dc\uc758 \uc21c\ucc28\uc801 \uc2e4\ud589", url: "#13", children: [
          ]},
          {title: "14. \ub7f0\uce58 \ud30c\uc77c\uc5d0\uc11c \ub178\ub4dc \uac04 \uc758\uc874\uc131 \uc124\uc815", url: "#14", children: [
          ]},
          {title: "15. \ub2e4\uc911 \ub178\ub4dc \uadf8\ub8f9\ud654\uc758 \ud6a8\uc728\uc801 \uc0ac\uc6a9", url: "#15", children: [
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1004/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1004/" class="btn btn-xs btn-link">
        런치 파일을 통한 조건부 실행
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1002/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1002/" class="btn btn-xs btn-link">
        노드 시작 및 파라미터 전달
      </a>
    </div>
    
  </div>

    

    <h3 id="1">1. 다중 노드 실행 개요</h3>
<p>ROS2에서 여러 노드를 동시에 실행할 때, 런치 파일을 활용하여 다중 노드를 실행할 수 있다. 런치 파일을 통해 각 노드의 실행 순서를 정의하고, 실행 환경 및 파라미터를 설정할 수 있다. 여러 노드를 동시에 실행하는 것은 분산된 로봇 시스템이나 복잡한 작업을 처리하는 데 필수적이다.</p>
<h3 id="2">2. 런치 파일을 통한 다중 노드 실행</h3>
<p>런치 파일에서 다중 노드를 실행하기 위해서는 각각의 노드에 대한 정보를 명시적으로 정의해야 한다. 노드를 정의할 때는 노드 이름, 실행 파일 경로, 파라미터, 네임스페이스 등을 지정할 수 있다.</p>
<p>다음은 간단한 예시이다:</p>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='package_name',
            executable='node1_executable',
            name='node1',
            output='screen'
        ),
        Node(
            package='package_name',
            executable='node2_executable',
            name='node2',
            output='screen'
        ),
    ])
</code></pre>
<p>이 예시에서는 <code>package_name</code> 패키지에 속한 <code>node1_executable</code>과 <code>node2_executable</code> 두 개의 노드를 런치 파일에서 동시에 실행하고 있다. 노드의 출력은 <code>screen</code>으로 지정되어 터미널에 출력된다.</p>
<h3 id="3">3. 런치 파일에서의 노드 파라미터 설정</h3>
<p>다중 노드를 실행할 때 각 노드마다 고유의 파라미터를 설정할 수 있다. 파라미터는 런치 파일에서 정의할 수 있으며, 각 노드에 대해 별도로 지정된다.</p>
<pre><code class="language-python">Node(
    package='package_name',
    executable='node_executable',
    name='node_name',
    parameters=[
        {'param1': 'value1'},
        {'param2': 'value2'}
    ]
)
</code></pre>
<p>위 코드에서 <code>param1</code>과 <code>param2</code>는 해당 노드에서 사용할 파라미터로 설정되며, 실행 중에 동적으로 사용할 수 있다.</p>
<h3 id="4">4. 그룹 실행 개요</h3>
<p>그룹 실행은 여러 노드를 한 그룹으로 묶어 실행하는 방법이다. 이를 통해 노드 간 네임스페이스, 파라미터 공유, 실행 조건을 더욱 효율적으로 관리할 수 있다. 그룹 실행은 주로 네임스페이스나 특정 조건 하에 묶여야 하는 노드를 다룰 때 유용하다.</p>
<p>그룹을 정의하는 기본 구조는 다음과 같다:</p>
<pre><code class="language-python">from launch_ros.actions import PushRosNamespace

group = GroupAction([
    PushRosNamespace('group_namespace'),
    Node(
        package='package_name',
        executable='node1_executable',
        name='node1',
    ),
    Node(
        package='package_name',
        executable='node2_executable',
        name='node2',
    ),
])
</code></pre>
<p>이 예시에서는 <code>group_namespace</code>라는 네임스페이스 내에서 <code>node1</code>과 <code>node2</code>를 그룹화하여 실행하고 있다.</p>
<h3 id="5">5. 그룹 실행에서 네임스페이스의 역할</h3>
<p>그룹 실행에서 네임스페이스는 중요하다. 각각의 노드를 네임스페이스로 묶으면 노드 이름 충돌을 피할 수 있으며, 논리적인 구조를 제공하여 노드 간 통신을 더 체계적으로 관리할 수 있다.</p>
<p>노드의 네임스페이스를 설정할 때는 <code>PushRosNamespace</code> 클래스를 사용한다. 각 그룹 내에서 동일한 네임스페이스를 공유하는 노드들은 통신 시 네임스페이스가 자동으로 포함된다.</p>
<p>다음과 같은 방식으로 네임스페이스를 설정할 수 있다:</p>
<pre><code class="language-python">PushRosNamespace('namespace_name')
</code></pre>
<p>여기에서 <code>namespace_name</code>은 그룹 내의 모든 노드에 적용되는 네임스페이스이다.</p>
<h3 id="6">6. 조건부 실행</h3>
<p>다중 노드 실행이나 그룹 실행 시, 특정 조건에 따라 노드를 실행하거나 실행하지 않을 수 있다. 이를 위해 ROS2 런치 파일에서 조건문을 활용할 수 있다. 주로 <code>IfCondition</code>과 <code>UnlessCondition</code>을 사용하여 특정 조건에 따라 노드 실행 여부를 결정할 수 있다.</p>
<pre><code class="language-python">from launch.conditions import IfCondition
from launch_ros.actions import Node

Node(
    package='package_name',
    executable='node_executable',
    name='node_name',
    condition=IfCondition('condition_expression')
)
</code></pre>
<p>위 예시에서는 <code>condition_expression</code>이 참일 경우에만 해당 노드를 실행한다. <code>IfCondition</code> 외에도 반대로 조건이 거짓일 때 실행하는 <code>UnlessCondition</code>도 사용할 수 있다.</p>
<h3 id="7">7. 그룹 실행의 활용 예시</h3>
<p>그룹 실행은 복잡한 시스템에서 자주 사용된다. 예를 들어, 다중 로봇 시스템을 구성할 때 각 로봇마다 동일한 노드를 실행해야 하지만, 로봇 간의 충돌을 피하기 위해 서로 다른 네임스페이스를 사용하는 경우가 있다. 이를 런치 파일에서 그룹을 통해 간단히 구현할 수 있다.</p>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import PushRosNamespace, Node

def generate_launch_description():
    return LaunchDescription([
        PushRosNamespace('robot1'),
        Node(
            package='robot_control',
            executable='control_node',
            name='controller',
        ),
        PushRosNamespace('robot2'),
        Node(
            package='robot_control',
            executable='control_node',
            name='controller',
        ),
    ])
</code></pre>
<p>이 예시에서는 두 개의 로봇(<code>robot1</code>, <code>robot2</code>) 각각에 동일한 <code>control_node</code> 노드를 실행하지만, 서로 다른 네임스페이스를 사용하여 실행된다. 이를 통해 두 로봇 간의 노드 이름 충돌을 방지할 수 있다.</p>
<h3 id="8">8. 런치 파일에서 매개변수 전달</h3>
<p>다중 노드를 실행할 때, 각 노드에 공통적인 파라미터를 전달하거나 그룹별로 다른 파라미터를 설정할 수 있다. 이를 통해 더욱 유연한 노드 실행 환경을 구성할 수 있다.</p>
<p>다음은 그룹 내에서 파라미터를 전달하는 예시이다:</p>
<pre><code class="language-python">from launch_ros.actions import Node
from launch.actions import GroupAction
from launch_ros.actions import PushRosNamespace

def generate_launch_description():
    return LaunchDescription([
        GroupAction([
            PushRosNamespace('robot_group'),
            Node(
                package='robot_package',
                executable='robot_node',
                name='robot1',
                parameters=[
                    {'robot_speed': '1.0'},
                    {'robot_size': 'large'}
                ]
            ),
            Node(
                package='robot_package',
                executable='robot_node',
                name='robot2',
                parameters=[
                    {'robot_speed': '0.5'},
                    {'robot_size': 'small'}
                ]
            )
        ])
    ])
</code></pre>
<p>위 예시에서 두 개의 로봇 노드 <code>robot1</code>과 <code>robot2</code>는 각각 다른 파라미터(<code>robot_speed</code>, <code>robot_size</code>)를 전달받아 실행된다.</p>
<h3 id="9">9. 런치 파일에서 환경 변수 설정</h3>
<p>다중 노드를 실행할 때 환경 변수를 설정하여 노드의 동작을 제어할 수 있다. 환경 변수는 런치 파일에서 직접 정의할 수 있으며, 이를 통해 런치 파일이 실행되는 동안의 실행 환경을 동적으로 설정할 수 있다.</p>
<p>환경 변수를 설정하는 기본적인 방법은 다음과 같다:</p>
<pre><code class="language-python">from launch.actions import SetEnvironmentVariable
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        SetEnvironmentVariable('ROS_LOG_LEVEL', 'DEBUG'),
        Node(
            package='package_name',
            executable='node_executable',
            name='node_name'
        )
    ])
</code></pre>
<p>이 예시에서는 <code>ROS_LOG_LEVEL</code> 환경 변수를 <code>DEBUG</code>로 설정하여 노드 실행 중에 디버그 수준의 로그가 출력되도록 한다.</p>
<h3 id="10">10. 런치 파일에서 조건부 그룹 실행</h3>
<p>그룹 실행 역시 조건을 걸어 실행할 수 있다. 예를 들어, 특정 조건에 따라 그룹 전체의 실행을 제어할 수 있다. 조건부 그룹 실행은 시스템의 특정 상태에 따라 그룹 내의 노드를 선택적으로 실행할 때 유용하다.</p>
<p>조건부 그룹 실행은 다음과 같이 구현할 수 있다:</p>
<pre><code class="language-python">from launch.actions import GroupAction
from launch.conditions import IfCondition
from launch_ros.actions import PushRosNamespace, Node

def generate_launch_description():
    return LaunchDescription([
        GroupAction([
            PushRosNamespace('robot1'),
            Node(
                package='robot_control',
                executable='control_node',
                name='controller1',
            ),
            Node(
                package='robot_sensors',
                executable='sensor_node',
                name='sensor1',
            ),
        ], condition=IfCondition('condition_expression'))
    ])
</code></pre>
<p>이 코드에서 <code>condition_expression</code>이 참일 경우에만 그룹 내의 노드들이 실행된다. 이를 통해 다중 노드 실행 시 특정 조건에 따라 그룹 실행을 유연하게 제어할 수 있다.</p>
<h3 id="11">11. 그룹 실행의 동기화</h3>
<p>여러 노드를 그룹화하여 실행할 때, 각 노드의 실행 순서를 제어하거나 동기화할 필요가 있다. 특히 로봇 시스템에서는 센서 노드와 제어 노드가 특정 순서로 실행되어야 할 수 있다. 이를 위해 런치 파일에서 <code>TimerAction</code>을 사용하여 특정 시간 간격을 두고 노드를 실행할 수 있다.</p>
<p>다음은 동기화를 위한 예시이다:</p>
<pre><code class="language-python">from launch.actions import TimerAction
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='package_name',
            executable='sensor_node',
            name='sensor_node'
        ),
        TimerAction(
            period=5.0,
            actions=[Node(
                package='package_name',
                executable='control_node',
                name='control_node'
            )]
        )
    ])
</code></pre>
<p>이 예시에서는 <code>sensor_node</code>가 먼저 실행되고, 5초 후에 <code>control_node</code>가 실행된다. 이를 통해 노드 간 실행 순서를 제어할 수 있다.</p>
<h3 id="12">12. 런치 파일에서 조건부 실행을 통한 다중 노드 그룹 제어</h3>
<p>조건부 실행과 그룹 실행을 결합하여 복잡한 시스템을 구성할 수 있다. 예를 들어, 여러 노드를 그룹으로 묶고, 특정 조건에 따라 해당 그룹을 실행할지 여부를 제어할 수 있다. 이러한 방식은 다양한 환경에서 시스템을 더 유연하게 관리할 수 있게 해준다.</p>
<pre><code class="language-python">from launch.conditions import IfCondition, UnlessCondition
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='package_name',
            executable='node1_executable',
            name='node1',
            condition=IfCondition('use_node1')
        ),
        Node(
            package='package_name',
            executable='node2_executable',
            name='node2',
            condition=UnlessCondition('use_node2')
        ),
    ])
</code></pre>
<p>위 예시에서는 <code>use_node1</code> 조건이 참일 경우 <code>node1_executable</code>이 실행되고, <code>use_node2</code> 조건이 거짓일 경우 <code>node2_executable</code>이 실행된다. 이러한 조건부 실행은 런치 파일에서 노드 실행의 유연성을 크게 향상시킨다.</p>
<h3 id="13">13. 런치 파일에서 그룹화된 노드의 순차적 실행</h3>
<p>런치 파일에서 그룹 내 노드들을 순차적으로 실행하는 방법도 존재한다. 주로 시간 간격이나 실행 조건에 따라 노드를 차례대로 실행할 때 <code>TimerAction</code>을 활용할 수 있다. 이를 통해 각 노드가 실행될 타이밍을 제어하거나, 서로 다른 노드가 의존성을 가지고 실행되어야 하는 경우에 유용하게 사용된다.</p>
<p>예를 들어, 첫 번째 노드가 실행된 후에 두 번째 노드를 실행할 수 있다:</p>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch.actions import TimerAction

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='sensor_package',
            executable='sensor_node',
            name='sensor_node',
        ),
        TimerAction(
            period=3.0,
            actions=[Node(
                package='control_package',
                executable='control_node',
                name='control_node',
            )]
        ),
    ])
</code></pre>
<p>위 예시에서 <code>sensor_node</code>가 먼저 실행되고, 3초 후에 <code>control_node</code>가 실행된다. 이를 통해 특정 작업이 먼저 완료된 후 다음 작업을 실행하도록 노드 간 순서를 제어할 수 있다.</p>
<h3 id="14">14. 런치 파일에서 노드 간 의존성 설정</h3>
<p>노드 간 의존성을 설정하는 것은 로봇 시스템에서 중요한 부분이다. 예를 들어, 센서 데이터를 수집하는 노드가 완전히 실행된 후에 제어 노드가 데이터를 기반으로 작업을 수행해야 할 수 있다. 이를 런치 파일에서 설정할 수 있는 방법 중 하나는 <code>RequiredAction</code>을 사용하는 것이다.</p>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch.actions import RequiredAction

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='sensor_package',
            executable='sensor_node',
            name='sensor_node',
            output='screen',
        ),
        RequiredAction(
            condition=lambda: True,
            actions=[Node(
                package='control_package',
                executable='control_node',
                name='control_node',
                output='screen',
            )]
        )
    ])
</code></pre>
<p>위 코드는 <code>sensor_node</code>가 실행된 후에만 <code>control_node</code>가 실행되는 방식으로 구성된다. 노드 간 의존성이 있을 때 이러한 방법으로 순차적인 실행을 보장할 수 있다.</p>
<h3 id="15">15. 다중 노드 그룹화의 효율적 사용</h3>
<p>다중 노드 그룹화는 로봇 시스템에서 여러 개의 동일한 노드 그룹을 생성하고, 각 그룹이 다른 파라미터나 네임스페이스를 통해 독립적으로 작동하도록 할 때 특히 유용하다. 예를 들어, 여러 대의 로봇이 동일한 제어 노드를 실행하지만 서로 다른 환경에서 작동할 수 있다.</p>
<p>다음은 여러 대의 로봇을 위한 그룹화된 노드 실행 예시이다:</p>
<pre><code class="language-python">from launch import LaunchDescription
from launch_ros.actions import Node
from launch.actions import GroupAction, PushRosNamespace

def generate_launch_description():
    return LaunchDescription([
        GroupAction([
            PushRosNamespace('robot1'),
            Node(
                package='robot_control',
                executable='controller_node',
                name='controller1',
            ),
            Node(
                package='robot_sensors',
                executable='sensor_node',
                name='sensor1',
            ),
        ]),
        GroupAction([
            PushRosNamespace('robot2'),
            Node(
                package='robot_control',
                executable='controller_node',
                name='controller2',
            ),
            Node(
                package='robot_sensors',
                executable='sensor_node',
                name='sensor2',
            ),
        ]),
    ])
</code></pre>
<p>이 코드에서는 <code>robot1</code>과 <code>robot2</code> 네임스페이스 내에서 각각의 제어 및 센서 노드가 독립적으로 실행된다. 그룹화를 통해 여러 노드 간의 충돌을 방지하면서 동일한 구조의 시스템을 반복적으로 구성할 수 있다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../1004/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../1004/" class="btn btn-xs btn-link">
        런치 파일을 통한 조건부 실행
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../1002/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../1002/" class="btn btn-xs btn-link">
        노드 시작 및 파라미터 전달
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>