<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/ros2%20humble/chapter%2005/0505/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>서비스와 액션의 활용 사례 - 실험 도서관</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uc11c\ube44\uc2a4 \ud65c\uc6a9 \uc0ac\ub840", url: "#_top", children: [
              {title: "1. \ub85c\ubd07 \uc81c\uc5b4\uc5d0\uc11c\uc758 \uc11c\ube44\uc2a4 \ud638\ucd9c", url: "#1" },
              {title: "2. \uc13c\uc11c \ub370\uc774\ud130 \uc694\uccad \uc11c\ube44\uc2a4", url: "#2" },
          ]},
          {title: "\uc561\uc158 \ud65c\uc6a9 \uc0ac\ub840", url: "#_4", children: [
              {title: "1. \ub85c\ubd07 \uc774\ub3d9 \uacbd\ub85c \ucd94\uc885\uc5d0\uc11c\uc758 \uc561\uc158 \uc0ac\uc6a9", url: "#1_1" },
              {title: "2. \ub4dc\ub860\uc758 \ucc29\ub959 \ub3d9\uc791\uc5d0\uc11c \uc561\uc158 \uc0ac\uc6a9", url: "#2_1" },
              {title: "3. \ub85c\ubd07\uc758 \ube44\uc804 \uae30\ubc18 \uac1d\uccb4 \uc778\uc2dd\uc5d0\uc11c\uc758 \uc561\uc158 \uc0ac\uc6a9", url: "#3" },
              {title: "4. \ub85c\ubd07 \uc554\uc758 \uc870\ub9bd \uc791\uc5c5\uc5d0\uc11c \uc561\uc158 \uc0ac\uc6a9", url: "#4" },
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../chapter%2006/0601/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../chapter%2006/0601/" class="btn btn-xs btn-link">
        생명주기 노드의 개념 및 상태
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../0504/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../0504/" class="btn btn-xs btn-link">
        서비스와 액션의 개념 및 차이점
      </a>
    </div>
    
  </div>

    

    <h2 id="_1">서비스 활용 사례</h2>
<h3 id="1">1. 로봇 제어에서의 서비스 호출</h3>
<p>로봇 제어 시스템에서 서비스를 이용하여 특정한 작업을 요청하거나 명령을 전달하는 경우가 빈번한다. 예를 들어, 로봇 팔이 특정 위치로 이동해야 하는 상황을 생각해 봅시다. 이때 사용자는 서비스 서버로 목표 위치를 전달하고, 서버는 이 요청을 받아들여 로봇 팔이 해당 위치로 이동할 수 있도록 명령을 실행하게 된다.</p>
<h4 id="_2">서비스 요청 예제</h4>
<p>로봇 팔 제어에서, 목표 좌표를 전달하고 이동 명령을 실행하는 서비스의 인터페이스는 다음과 같이 구성될 수 있다.</p>
<ul>
<li><strong>입력:</strong> 목표 위치 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p} = [x, y, z]</span><script type="math/tex">\mathbf{p} = [x, y, z]</script></span></li>
<li><strong>출력:</strong> 성공 여부와 완료 시간 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span></li>
</ul>
<p>사용자는 서비스 요청을 통해 로봇 팔이 특정 좌표로 이동할 것을 요구할 수 있다. 이때, 목표 좌표 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}</span><script type="math/tex">\mathbf{p}</script></span>는 3차원 벡터로 표현되며, 서비스 호출 시 이를 매개변수로 전달한다.</p>
<pre><code class="language-python">class MoveRobotArmService:
    def __init__(self):
        self.service = create_service(MoveRobot, 'move_robot_arm', self.handle_move_robot_arm)

    def handle_move_robot_arm(self, request, response):
        target_position = request.position  # 목표 좌표 [x, y, z]
        # 로봇 팔 이동 로직 수행
        response.success = move_to_position(target_position)
        response.completion_time = get_current_time()
        return response
</code></pre>
<p>여기서 중요한 점은 서비스가 비동기적으로 동작할 수 있다는 점이다. 즉, 클라이언트는 서비스 요청을 보낸 후 즉시 결과를 기다리는 것이 아니라, 서비스 서버가 응답을 완료할 때까지 다른 작업을 수행할 수 있다.</p>
<h3 id="2">2. 센서 데이터 요청 서비스</h3>
<p>ROS2 시스템에서는 여러 종류의 센서를 통해 데이터를 수집할 수 있다. 센서 데이터는 일반적으로 토픽을 통해 실시간으로 전달되지만, 특정 시점의 데이터를 요청하고자 할 때 서비스가 유용하게 사용될 수 있다.</p>
<h4 id="_3">센서 서비스 요청 예제</h4>
<p>특정 센서 데이터, 예를 들어 로봇의 주변 온도를 조회하는 서비스를 고려해 보겠다. 서비스 요청 시, 현재 온도 <span class="arithmatex"><span class="MathJax_Preview">T(t)</span><script type="math/tex">T(t)</script></span>를 제공하는 서버는 다음과 같은 방식으로 구성된다.</p>
<ul>
<li><strong>입력:</strong> 요청 시간 <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span></li>
<li><strong>출력:</strong> 해당 시점의 온도 <span class="arithmatex"><span class="MathJax_Preview">T(t)</span><script type="math/tex">T(t)</script></span></li>
</ul>
<pre><code class="language-python">class TemperatureService:
    def __init__(self):
        self.service = create_service(GetTemperature, 'get_temperature', self.handle_get_temperature)

    def handle_get_temperature(self, request, response):
        current_temperature = read_temperature_sensor()
        response.temperature = current_temperature
        return response
</code></pre>
<p>이와 같은 방식으로, 서비스 호출을 통해 특정 시점의 센서 데이터를 손쉽게 요청할 수 있으며, 이러한 접근 방식은 특히 실시간 데이터가 필요하지 않은 경우에 유용하다.</p>
<h2 id="_4">액션 활용 사례</h2>
<h3 id="1_1">1. 로봇 이동 경로 추종에서의 액션 사용</h3>
<p>액션 서버는 긴 시간이 소요되는 작업을 처리할 때 매우 유용하다. 예를 들어, 로봇이 지정된 경로를 따라 이동하는 작업을 생각해 봅시다. 경로를 추종하는 동안 주기적으로 현재 상태를 피드백으로 받아보아야 하며, 경로 이동이 완료되었을 때 완료 신호를 받아야 한다.</p>
<h4 id="_5">경로 추종 액션 예제</h4>
<p>로봇의 경로 추종을 위한 액션 서버의 인터페이스는 다음과 같이 구성될 수 있다.</p>
<ul>
<li><strong>목표:</strong> 경로 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{P} = [\mathbf{p}_1, \mathbf{p}_2, \dots, \mathbf{p}_n]</span><script type="math/tex">\mathbf{P} = [\mathbf{p}_1, \mathbf{p}_2, \dots, \mathbf{p}_n]</script></span></li>
<li><strong>피드백:</strong> 현재 위치 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}(t)</span><script type="math/tex">\mathbf{p}(t)</script></span></li>
<li><strong>결과:</strong> 경로 완료 여부</li>
</ul>
<p>경로 추종 중 로봇의 위치 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}(t)</span><script type="math/tex">\mathbf{p}(t)</script></span>는 피드백으로 클라이언트에게 주기적으로 전달된다.</p>
<pre><code class="language-python">class FollowPathActionServer:
    def __init__(self):
        self.action_server = create_action_server(FollowPath, 'follow_path', self.execute_path)

    def execute_path(self, goal_handle):
        path = goal_handle.request.path  # 경로 [p1, p2, ..., pn]
        for waypoint in path:
            # 경로 추종 로직 수행
            move_to_waypoint(waypoint)
            feedback = FollowPath.Feedback()
            feedback.current_position = get_robot_position()
            goal_handle.publish_feedback(feedback)

        goal_handle.succeed()
        result = FollowPath.Result()
        result.success = True
        return result
</code></pre>
<p>액션 서버는 목표 경로를 따라 로봇이 이동하는 동안 지속적으로 현재 위치를 피드백으로 제공하며, 경로를 모두 따라간 후 성공 여부를 클라이언트에 알린다.</p>
<h3 id="2_1">2. 드론의 착륙 동작에서 액션 사용</h3>
<p>드론이나 무인항공기(UAV)의 착륙 과정은 즉시 완료되는 작업이 아니기 때문에, 착륙 동작을 관리하는 액션 서버를 사용하는 것이 효과적이다. 드론이 착륙할 위치에 도달하고 실제로 착륙을 완료하는 과정 동안 실시간 상태 피드백이 필요하다.</p>
<h4 id="_6">착륙 동작 액션 예제</h4>
<p>착륙을 위한 액션 서버의 인터페이스는 다음과 같이 구성될 수 있다.</p>
<ul>
<li><strong>목표:</strong> 착륙 좌표 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_l = [x_l, y_l, z_l]</span><script type="math/tex">\mathbf{p}_l = [x_l, y_l, z_l]</script></span></li>
<li><strong>피드백:</strong> 현재 고도 <span class="arithmatex"><span class="MathJax_Preview">z(t)</span><script type="math/tex">z(t)</script></span></li>
<li><strong>결과:</strong> 착륙 완료 여부</li>
</ul>
<p>드론이 착륙 과정에서 고도 <span class="arithmatex"><span class="MathJax_Preview">z(t)</span><script type="math/tex">z(t)</script></span>를 주기적으로 피드백으로 제공하며, 안전하게 착륙했을 때 착륙 완료 신호를 전송한다.</p>
<pre><code class="language-python">class LandDroneActionServer:
    def __init__(self):
        self.action_server = create_action_server(LandDrone, 'land_drone', self.execute_landing)

    def execute_landing(self, goal_handle):
        landing_position = goal_handle.request.position  # 착륙 좌표 [x_l, y_l, z_l]
        current_altitude = get_current_altitude()

        while current_altitude &gt; landing_position[2]:
            # 착륙 로직 수행
            decrease_altitude()
            feedback = LandDrone.Feedback()
            feedback.current_altitude = get_current_altitude()
            goal_handle.publish_feedback(feedback)
            current_altitude = get_current_altitude()

        goal_handle.succeed()
        result = LandDrone.Result()
        result.success = True
        return result
</code></pre>
<p>이 예제에서 액션 서버는 착륙 중에 드론의 현재 고도를 클라이언트에게 피드백으로 제공하며, 최종적으로 드론이 착륙 완료 상태에 도달했을 때 성공 신호를 보낸다.</p>
<h3 id="3">3. 로봇의 비전 기반 객체 인식에서의 액션 사용</h3>
<p>로봇이 카메라를 통해 객체를 인식하는 작업은 상당히 시간이 걸리며, 지속적인 피드백이 필요한 경우가 많다. 이때 액션 서버를 사용하면, 객체를 찾는 동안 피드백을 받을 수 있고, 객체 인식이 완료되면 결과를 받을 수 있다.</p>
<h4 id="_7">객체 인식 액션 예제</h4>
<p>로봇이 특정 객체를 인식하는 작업을 위한 액션 서버는 다음과 같이 설계될 수 있다.</p>
<ul>
<li><strong>목표:</strong> 인식할 객체의 ID <span class="arithmatex"><span class="MathJax_Preview">\mathbf{id}</span><script type="math/tex">\mathbf{id}</script></span></li>
<li><strong>피드백:</strong> 현재 인식 중인 객체의 상태</li>
<li><strong>결과:</strong> 인식 성공 여부 및 객체 위치 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{p}_o = [x_o, y_o, z_o]</span><script type="math/tex">\mathbf{p}_o = [x_o, y_o, z_o]</script></span></li>
</ul>
<pre><code class="language-python">class ObjectRecognitionActionServer:
    def __init__(self):
        self.action_server = create_action_server(ObjectRecognition, 'recognize_object', self.execute_recognition)

    def execute_recognition(self, goal_handle):
        object_id = goal_handle.request.object_id  # 인식할 객체 ID
        while not object_recognized(object_id):
            # 객체 인식 로직 수행
            feedback = ObjectRecognition.Feedback()
            feedback.recognition_progress = get_recognition_progress()
            goal_handle.publish_feedback(feedback)

        goal_handle.succeed()
        result = ObjectRecognition.Result()
        result.object_position = get_object_position()
        return result
</code></pre>
<p>액션 서버는 객체 인식이 진행되는 동안 인식 상태를 피드백으로 제공하며, 객체 인식이 완료되면 객체의 위치와 함께 성공 여부를 클라이언트에 전달한다.</p>
<h3 id="4">4. 로봇 암의 조립 작업에서 액션 사용</h3>
<p>로봇 암이 여러 부품을 조립하는 작업에서는 각 단계별로 부품을 정확한 위치에 놓아야 하는 경우가 많다. 이러한 작업은 장시간에 걸쳐 수행되며, 각 부품을 놓을 때마다 피드백을 통해 현재 상태를 확인할 수 있다.</p>
<h4 id="_8">조립 작업 액션 예제</h4>
<p>조립 작업의 액션 서버는 다음과 같이 구성될 수 있다.</p>
<ul>
<li><strong>목표:</strong> 조립할 부품들의 위치 리스트 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{P}_a = [\mathbf{p}_1, \mathbf{p}_2, \dots, \mathbf{p}_n]</span><script type="math/tex">\mathbf{P}_a = [\mathbf{p}_1, \mathbf{p}_2, \dots, \mathbf{p}_n]</script></span></li>
<li><strong>피드백:</strong> 현재 조립 단계 <span class="arithmatex"><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span></li>
<li><strong>결과:</strong> 조립 완료 여부</li>
</ul>
<pre><code class="language-python">class AssemblyActionServer:
    def __init__(self):
        self.action_server = create_action_server(Assembly, 'assembly_robot_arm', self.execute_assembly)

    def execute_assembly(self, goal_handle):
        assembly_positions = goal_handle.request.assembly_positions  # 조립할 위치 리스트
        for i, position in enumerate(assembly_positions):
            move_to_position(position)
            feedback = Assembly.Feedback()
            feedback.current_step = i
            goal_handle.publish_feedback(feedback)

        goal_handle.succeed()
        result = Assembly.Result()
        result.success = True
        return result
</code></pre>
<p>이 액션 서버는 로봇이 각 부품을 지정된 위치에 놓는 동안 현재 조립 단계에 대한 피드백을 제공하며, 모든 부품이 조립되었을 때 성공 여부를 클라이언트에 알린다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../chapter%2006/0601/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../chapter%2006/0601/" class="btn btn-xs btn-link">
        생명주기 노드의 개념 및 상태
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../0504/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../0504/" class="btn btn-xs btn-link">
        서비스와 액션의 개념 및 차이점
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>