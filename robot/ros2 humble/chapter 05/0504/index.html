<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/ros2%20humble/chapter%2005/0504/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>서비스와 액션의 개념 및 차이점 - 실험 도서관</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uc11c\ube44\uc2a4\uc758 \uac1c\ub150", url: "#_top", children: [
              {title: "\uc11c\ube44\uc2a4 \uc608\uc2dc", url: "#_2" },
          ]},
          {title: "\uc561\uc158\uc758 \uac1c\ub150", url: "#_3", children: [
              {title: "\uc561\uc158\uc758 \ube44\ub3d9\uae30 \ucc98\ub9ac", url: "#_4" },
              {title: "\uc561\uc158 \uc608\uc2dc", url: "#_5" },
          ]},
          {title: "\uc11c\ube44\uc2a4\uc640 \uc561\uc158\uc758 \ucc28\uc774\uc810", url: "#_6", children: [
          ]},
          {title: "\ud53c\ub4dc\ubc31 \ucc98\ub9ac", url: "#_7", children: [
              {title: "\uc561\uc158\uc758 \ud53c\ub4dc\ubc31 \uc608\uc2dc", url: "#_8" },
          ]},
          {title: "\ucde8\uc18c \uae30\ub2a5", url: "#_9", children: [
              {title: "\uc561\uc158\uc758 \ucde8\uc18c \uc608\uc2dc", url: "#_10" },
          ]},
          {title: "\uc11c\ube44\uc2a4\uc640 \uc561\uc158\uc758 \ube44\uad50", url: "#_11", children: [
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../0505/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../0505/" class="btn btn-xs btn-link">
        서비스와 액션의 활용 사례
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../0503/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../0503/" class="btn btn-xs btn-link">
        퍼블리셔와 서브스크라이버
      </a>
    </div>
    
  </div>

    

    <h3 id="_1">서비스의 개념</h3>
<p>ROS2에서 서비스는 클라이언트-서버 통신 모델을 기반으로 하여 동작한다. 즉, 한 노드가 서비스 서버로 동작하고, 다른 노드가 클라이언트로서 이 서버에 요청을 보낸다. 서비스는 일반적으로 동기식 처리에 사용된다. 서비스는 호출 시 즉각적인 응답을 기대하는 상황에서 유용하다. </p>
<ul>
<li><strong>서비스 서버</strong>: 클라이언트로부터 요청을 받으면 이를 처리하고 응답을 보낸다.</li>
<li><strong>서비스 클라이언트</strong>: 서버에 요청을 보내고 서버로부터의 응답을 대기한다.</li>
</ul>
<p>이 과정에서 서비스는 하나의 요청이 들어오면 서버가 이를 처리한 후 결과를 돌려주는 형태로 동작하며, 이는 RPC(Remote Procedure Call)와 유사한다.</p>
<p>서비스는 주로 짧은 시간 안에 요청-응답이 이루어져야 할 때 사용된다. 예를 들어, 로봇의 특정 센서 값을 요청하거나 간단한 명령을 내릴 때 서비스가 적합한다.</p>
<h4 id="_2">서비스 예시</h4>
<pre><code class="language-cpp">auto client = node-&gt;create_client&lt;std_srvs::srv::Empty&gt;(&quot;example_service&quot;);
auto request = std::make_shared&lt;std_srvs::srv::Empty::Request&gt;();
client-&gt;async_send_request(request);
</code></pre>
<h3 id="_3">액션의 개념</h3>
<p>액션은 서비스와 달리, 보다 긴 시간에 걸쳐 처리되는 작업에 적합한다. 비동기 방식으로 동작하며, 클라이언트는 서버에 작업을 요청하고, 서버는 작업이 완료되기 전까지 중간 상태나 피드백을 보낼 수 있다. </p>
<p>액션은 서버가 시작한 작업을 지속적으로 모니터링하고 피드백을 받을 수 있는 장점이 있다. 특히 긴 시간이 소요되는 작업에서 액션이 유용하다. 예를 들어, 로봇의 팔을 특정 위치로 이동시키는 작업처럼 시간이 많이 걸리는 작업에 액션이 적합한다.</p>
<ul>
<li><strong>액션 서버</strong>: 클라이언트의 요청을 받아들여 작업을 시작하고, 작업의 상태를 관리하며, 피드백을 보낼 수 있다.</li>
<li><strong>액션 클라이언트</strong>: 작업의 완료 여부와 중간 피드백을 받을 수 있으며, 필요 시 작업을 취소할 수도 있다.</li>
</ul>
<h4 id="_4">액션의 비동기 처리</h4>
<p>액션은 여러 단계의 상태를 가질 수 있으며, 클라이언트가 서버로부터 피드백을 받는 도중에도 다른 작업을 수행할 수 있다. 이로 인해 액션은 멀티스레딩 작업에 매우 적합한 구조이다.</p>
<h4 id="_5">액션 예시</h4>
<pre><code class="language-cpp">auto action_client = rclcpp_action::create_client&lt;Fibonacci&gt;(&quot;fibonacci&quot;);
auto goal_msg = Fibonacci::Goal();
goal_msg.order = 10;
auto send_goal_options = rclcpp_action::Client&lt;Fibonacci&gt;::SendGoalOptions();
send_goal_options.feedback_callback = [](auto, auto feedback) {
  std::cout &lt;&lt; &quot;Received feedback: &quot; &lt;&lt; feedback-&gt;sequence.back() &lt;&lt; std::endl;
};
action_client-&gt;async_send_goal(goal_msg, send_goal_options);
</code></pre>
<h3 id="_6">서비스와 액션의 차이점</h3>
<p>서비스와 액션의 가장 큰 차이점은 동기 및 비동기 처리 방식이다. </p>
<ol>
<li>
<p><strong>동기성</strong>:<br />
   서비스는 요청을 보내고, 응답이 올 때까지 기다리는 동기 방식이다. 즉, 서비스 클라이언트는 서버의 응답이 올 때까지 블로킹 상태에 놓이다.</p>
</li>
<li>
<p><strong>비동기성</strong>:<br />
   반면, 액션은 비동기 방식으로 동작하며, 작업을 요청한 후 그 진행 상황에 대한 피드백을 받아볼 수 있다. 작업이 완료되기 전에 중간 피드백을 제공하며, 클라이언트는 피드백을 받으면서도 다른 작업을 수행할 수 있다.</p>
</li>
<li>
<p><strong>작업의 지속 시간</strong>:<br />
   서비스는 일반적으로 빠르게 응답이 가능한 작업에 적합하고, 액션은 시간이 오래 걸리는 작업에 적합한다.</p>
</li>
</ol>
<h3 id="_7">피드백 처리</h3>
<p>서비스와 달리, 액션은 작업의 중간 피드백을 제공한다. 즉, 작업이 진행 중일 때, 클라이언트는 서버로부터 작업 상태를 계속해서 모니터링할 수 있다. 이러한 피드백은 작업이 예상보다 오래 걸리는 경우 매우 유용하다. 이를 통해 사용자는 작업이 어느 정도 진행되었는지 확인할 수 있고, 필요시 작업을 취소할 수 있는 기회를 갖는다.</p>
<h4 id="_8">액션의 피드백 예시</h4>
<pre><code class="language-cpp">auto feedback_callback = [](auto goal_handle, const auto &amp; feedback) {
  RCLCPP_INFO(rclcpp::get_logger(&quot;client&quot;), &quot;Received feedback: %d&quot;, feedback-&gt;progress);
};
auto send_goal_options = rclcpp_action::Client&lt;Action&gt;::SendGoalOptions();
send_goal_options.feedback_callback = feedback_callback;
</code></pre>
<p>위 코드에서 <code>feedback_callback</code>은 서버로부터 피드백을 받을 때 호출되는 함수이다. 피드백의 정보를 토대로 현재 작업의 진행 상황을 확인할 수 있다.</p>
<h3 id="_9">취소 기능</h3>
<p>액션의 또 다른 중요한 특징은 작업을 <strong>취소</strong>할 수 있다는 점이다. 긴 시간 동안 수행되는 작업이 중간에 필요 없어지거나, 상황이 변할 경우 액션 클라이언트에서 작업을 취소할 수 있다. 취소 요청을 보내면 서버는 그에 따라 작업을 중단하게 된다.</p>
<h4 id="_10">액션의 취소 예시</h4>
<pre><code class="language-cpp">auto goal_handle = action_client-&gt;async_send_goal(goal_msg, send_goal_options);
goal_handle-&gt;cancel_goal();
</code></pre>
<p>이처럼 작업이 진행 중인 상태에서 <code>cancel_goal()</code>을 호출하면, 서버가 현재 작업을 취소하고 더 이상 진행하지 않도록 요청할 수 있다.</p>
<h3 id="_11">서비스와 액션의 비교</h3>
<table>
<thead>
<tr>
<th>항목</th>
<th>서비스</th>
<th>액션</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>통신 방식</strong></td>
<td>동기</td>
<td>비동기</td>
</tr>
<tr>
<td><strong>작업 시간</strong></td>
<td>짧은 시간의 작업에 적합</td>
<td>긴 시간의 작업에 적합</td>
</tr>
<tr>
<td><strong>피드백</strong></td>
<td>없음</td>
<td>작업의 중간 피드백 제공</td>
</tr>
<tr>
<td><strong>취소 기능</strong></td>
<td>없음</td>
<td>작업 취소 가능</td>
</tr>
<tr>
<td><strong>사용 사례</strong></td>
<td>즉각적인 센서 값 조회, 간단한 명령</td>
<td>로봇의 복잡한 동작, 시간이 많이 소요되는 작업</td>
</tr>
</tbody>
</table>
<p>이와 같이, 서비스와 액션은 각기 다른 특성과 사용 시나리오를 가지고 있으며, 이를 적절히 활용함으로써 ROS2에서의 다양한 통신 요구를 만족시킬 수 있다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../0505/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../0505/" class="btn btn-xs btn-link">
        서비스와 액션의 활용 사례
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../0503/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../0503/" class="btn btn-xs btn-link">
        퍼블리셔와 서브스크라이버
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>