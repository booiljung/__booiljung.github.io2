<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/robot/ros2%20humble/chapter%2006/0601/">
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>생명주기 노드의 개념 및 상태 - 실험 도서관</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <link href="../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uc0dd\uba85\uc8fc\uae30 \ub178\ub4dc\uc758 \uac1c\ub150", url: "#_top", children: [
          ]},
          {title: "\uc0dd\uba85\uc8fc\uae30 \ub178\ub4dc\uc758 \uc0c1\ud0dc", url: "#_2", children: [
          ]},
          {title: "\uc0c1\ud0dc \uc804\uc774 \uacfc\uc815", url: "#_3", children: [
          ]},
          {title: "\uc0c1\ud0dc \uc804\uc774 \uc2dc\ub098\ub9ac\uc624", url: "#_4", children: [
          ]},
          {title: "\uc0c1\ud0dc \uc804\uc774\uc758 \uc608\uc678 \ucc98\ub9ac", url: "#_5", children: [
          ]},
          {title: "\uc0c1\ud0dc \uc804\uc774\uc640 \uc774\ubca4\ud2b8 \uae30\ubc18 \uad6c\uc870", url: "#_6", children: [
          ]},
          {title: "\uc0c1\ud0dc \uc804\uc774\uc640 \ud0c0\uc774\ubc0d \uc774\uc288", url: "#_7", children: [
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../0602/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../0602/" class="btn btn-xs btn-link">
        상태 전환 및 상태 관리
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter%2005/0505/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter%2005/0505/" class="btn btn-xs btn-link">
        서비스와 액션의 활용 사례
      </a>
    </div>
    
  </div>

    

    <h3 id="_1">생명주기 노드의 개념</h3>
<p>ROS2 생명주기 노드(Lifecycle Node)는 노드의 상태를 명확하게 정의하고 제어할 수 있는 기능을 제공하는 노드 유형이다. 일반적인 노드와 달리 생명주기 노드는 여러 상태를 가질 수 있으며, 각 상태에서 수행할 수 있는 작업이 제한된다. 이를 통해 ROS2 시스템에서 노드의 상태 전이를 관리하고, 필요한 경우 노드를 재구성하거나 다시 시작하는 등의 작업을 할 수 있다.</p>
<p>생명주기 노드의 가장 큰 특징은 상태(state)가 명확하게 정의되어 있다는 것이다. 이러한 상태는 특정 시점에서 노드가 어떤 작업을 수행할 수 있는지 또는 준비가 되었는지를 나타낸다. 예를 들어, 노드가 데이터를 퍼블리싱할 수 있는 상태인지, 아직 초기화되지 않은 상태인지 등을 명확하게 파악할 수 있다.</p>
<h3 id="_2">생명주기 노드의 상태</h3>
<p>생명주기 노드의 상태는 여러 단계로 나뉜다. 각 상태에서 노드는 고유한 동작을 수행할 수 있으며, 상태 전이는 주로 명령을 통해 이루어진다. 상태 전이는 특정 조건이 충족되었을 때 이루어지며, 사용자는 상태 전이를 트리거할 수 있다.</p>
<p>생명주기 노드는 ROS2에서 다음과 같은 기본 상태를 갖는다:</p>
<ol>
<li><strong>unconfigured 상태</strong></li>
<li>
<p>노드가 초기화되지 않은 상태이다. 이 상태에서는 어떤 작업도 수행할 수 없다. 주로 노드가 실행되었으나 아직 모든 종속성이나 리소스가 준비되지 않은 상태를 나타낸다. 이 상태에서 노드는 일반적인 초기화 절차를 수행할 준비가 되어 있다.</p>
</li>
<li>
<p><strong>inactive 상태</strong></p>
</li>
<li>
<p>노드가 기본적인 초기화 절차를 완료했지만, 활성화되지 않은 상태이다. 이 상태에서는 노드가 데이터를 퍼블리싱하거나 구독하지 않으며, 외부와의 상호작용이 차단된다. 노드는 여전히 내부적으로 필요한 리소스를 유지하고 있지만, 다른 노드와의 상호작용을 통해 실제 작업을 수행하지는 않는다.</p>
</li>
<li>
<p><strong>active 상태</strong></p>
</li>
<li>
<p>노드가 활성화되어 모든 작업을 수행할 수 있는 상태이다. 이 상태에서는 퍼블리셔가 데이터를 송신하고, 서브스크라이버가 데이터를 수신하는 등 노드가 완전히 작동하는 상태이다. 주로 노드의 주요 기능이 이 상태에서 수행된다.</p>
</li>
<li>
<p><strong>finalized 상태</strong></p>
</li>
<li>노드가 종료되었거나 비활성화된 상태이다. 이 상태에서는 노드가 어떤 작업도 수행하지 않으며, 다시 활성화되기 위해서는 초기화 과정이 다시 필요할 수 있다.</li>
</ol>
<p>상태 전이를 수학적으로 표현하면 다음과 같다:</p>
<ul>
<li><span class="arithmatex"><span class="MathJax_Preview">\text{unconfigured} \xrightarrow{\text{configure}} \text{inactive}</span><script type="math/tex">\text{unconfigured} \xrightarrow{\text{configure}} \text{inactive}</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">\text{inactive} \xrightarrow{\text{activate}} \text{active}</span><script type="math/tex">\text{inactive} \xrightarrow{\text{activate}} \text{active}</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">\text{active} \xrightarrow{\text{deactivate}} \text{inactive}</span><script type="math/tex">\text{active} \xrightarrow{\text{deactivate}} \text{inactive}</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">\text{inactive} \xrightarrow{\text{cleanup}} \text{unconfigured}</span><script type="math/tex">\text{inactive} \xrightarrow{\text{cleanup}} \text{unconfigured}</script></span></li>
<li><span class="arithmatex"><span class="MathJax_Preview">\text{any state} \xrightarrow{\text{shutdown}} \text{finalized}</span><script type="math/tex">\text{any state} \xrightarrow{\text{shutdown}} \text{finalized}</script></span></li>
</ul>
<p>상태 전이 과정에서 각각의 전이는 특정한 조건과 함수 호출에 의해 제어되며, 사용자가 노드의 상태를 명시적으로 변경할 수 있다. 예를 들어, 노드를 <code>activate</code> 상태로 전환하기 위해서는 노드가 이미 <code>inactive</code> 상태에 있어야 하며, 해당 상태에서 활성화 작업을 명령하는 것이 필요하다.</p>
<h3 id="_3">상태 전이 과정</h3>
<p>생명주기 노드에서 상태 전이는 특정 함수 호출을 통해 이루어진다. 각각의 상태 전이는 조건에 따라 트리거되며, 사용자가 해당 상태로의 전이를 요청할 수 있다. 주요 상태 전이 함수는 다음과 같다:</p>
<ol>
<li><strong>configure()</strong></li>
<li>
<p><code>unconfigured</code> 상태에서 <code>inactive</code> 상태로 전이할 때 호출되는 함수이다. 이 함수는 노드를 준비 상태로 전환시키며, 필요한 리소스를 할당하거나 종속성을 초기화하는 작업을 수행한다. 이 함수가 성공적으로 완료되면, 노드는 <code>inactive</code> 상태로 전환된다.</p>
</li>
<li>
<p><strong>activate()</strong></p>
</li>
<li>
<p><code>inactive</code> 상태에서 <code>active</code> 상태로 전이할 때 호출된다. 이 함수는 노드를 실제로 작업을 수행할 수 있는 상태로 전환하며, 퍼블리셔와 서브스크라이버가 데이터 송수신을 시작할 수 있도록 설정한다. 이 상태에서 노드는 외부와의 상호작용을 통해 본격적인 작업을 수행한다.</p>
</li>
<li>
<p><strong>deactivate()</strong></p>
</li>
<li>
<p><code>active</code> 상태에서 <code>inactive</code> 상태로 전이할 때 호출된다. 이 함수는 노드가 외부와의 상호작용을 중단하고, 퍼블리셔와 서브스크라이버를 비활성화한다. 그러나 노드 내부적으로는 리소스와 상태를 유지하며 언제든지 다시 활성화될 수 있는 상태를 준비한다.</p>
</li>
<li>
<p><strong>cleanup()</strong></p>
</li>
<li>
<p><code>inactive</code> 상태에서 <code>unconfigured</code> 상태로 전이할 때 호출된다. 이 함수는 노드가 할당한 모든 리소스를 해제하고, 노드를 초기 상태로 되돌린다. 이후 노드를 다시 사용할 경우, 다시 <code>configure</code> 과정을 거쳐야 한다.</p>
</li>
<li>
<p><strong>shutdown()</strong></p>
</li>
<li>어떤 상태에서든 <code>finalized</code> 상태로 전이할 때 호출된다. 이 함수는 노드의 모든 활동을 종료하고, 노드를 시스템에서 완전히 제거하는 작업을 수행한다. 노드가 종료된 후에는 다시 활성화될 수 없으며, 노드를 다시 사용하려면 처음부터 다시 생성해야 한다.</li>
</ol>
<h3 id="_4">상태 전이 시나리오</h3>
<p>각 상태 전이는 특정 상황에서 필요하며, 실시간 시스템에서는 노드의 상태를 적절히 관리하는 것이 매우 중요하다. 예를 들어, 노드를 실행 중에 필요한 설정을 변경해야 하는 경우, 노드를 <code>active</code> 상태에서 <code>inactive</code> 상태로 전환한 후 설정을 변경하고 다시 <code>active</code> 상태로 전환하는 식으로 진행할 수 있다. 이를 통해 실시간 시스템의 안전성을 보장하고, 노드의 비정상적인 작동을 방지할 수 있다.</p>
<p>상태 전이 시나리오는 수식으로 표현하면 다음과 같다:</p>
<ul>
<li>상태 전이 중 특정 조건 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{C}_{ij}</span><script type="math/tex">\mathbf{C}_{ij}</script></span>가 충족되면:</li>
</ul>
<p>$$
  \mathbf{S}<em>i \xrightarrow{\mathbf{C}</em>{ij}} \mathbf{S}_j</p>
<p>$$</p>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{S}_i</span><script type="math/tex">\mathbf{S}_i</script></span>는 현재 상태, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{S}_j</span><script type="math/tex">\mathbf{S}_j</script></span>는 전이할 목표 상태, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{C}_{ij}</span><script type="math/tex">\mathbf{C}_{ij}</script></span>는 상태 전이를 위한 조건이다.</p>
<p>예를 들어, 노드가 <code>inactive</code> 상태에 있을 때, 활성화를 위한 조건이 충족되면 다음과 같은 상태 전이가 발생한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{inactive} \xrightarrow{\text{activate}} \mathbf{active}
</div>
<script type="math/tex; mode=display">
\mathbf{inactive} \xrightarrow{\text{activate}} \mathbf{active}
</script>
</div>
<p>이때 <code>activate()</code> 함수가 호출되며, 노드는 외부와의 상호작용을 위한 준비를 완료하게 된다.</p>
<h3 id="_5">상태 전이의 예외 처리</h3>
<p>생명주기 노드에서 상태 전이는 일반적으로 원활하게 진행되지만, 때때로 예외 상황이 발생할 수 있다. 이러한 예외 상황은 주로 다음과 같은 경우에 발생한다:</p>
<ol>
<li><strong>상태 전이 실패</strong></li>
<li>특정 상태에서 다른 상태로 전이할 때, 필요한 조건이 충족되지 않거나 시스템 리소스에 문제가 발생할 경우 상태 전이가 실패할 수 있다. 예를 들어, <code>inactive</code> 상태에서 <code>active</code> 상태로 전이하려 할 때 필요한 하드웨어 리소스가 제대로 연결되지 않았거나 초기화되지 않으면 상태 전이는 실패한다.</li>
</ol>
<p>상태 전이 실패를 수학적으로 표현하면 다음과 같다:</p>
<p>$$
   \mathbf{S}<em>i \xrightarrow{\mathbf{C}</em>{ij} \, \text{실패}} \mathbf{S}_i</p>
<p>$$</p>
<p>즉, 현재 상태 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{S}_i</span><script type="math/tex">\mathbf{S}_i</script></span>에서 다른 상태로의 전이 조건 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{C}_{ij}</span><script type="math/tex">\mathbf{C}_{ij}</script></span>가 충족되지 않으면 상태는 변화하지 않고 그대로 유지된다.</p>
<ol>
<li><strong>상태 전이 도중의 예외 처리</strong></li>
<li>상태 전이 도중 예외가 발생하면, 노드는 전이 중에 멈출 수 있으며, 이를 처리하기 위해서는 롤백(rollback) 메커니즘이 필요하다. 예를 들어, <code>activate</code> 상태로 전이하려는 도중 문제가 발생하면 다시 <code>inactive</code> 상태로 되돌아가도록 시스템에서 처리할 수 있어야 한다.</li>
</ol>
<p>이를 수학적으로 표현하면 다음과 같다:</p>
<p>$$
   \mathbf{S}<em>i \xrightarrow{\mathbf{C}</em>{ij}} \mathbf{S}_j \quad \text{(예외 발생 시)} \quad \mathbf{S}_j \xrightarrow{\mathbf{rollback}} \mathbf{S}_i</p>
<p>$$</p>
<p>즉, 예외가 발생하면 다시 이전 상태로 돌아가서 시스템이 비정상 상태에 빠지지 않도록 처리한다.</p>
<h3 id="_6">상태 전이와 이벤트 기반 구조</h3>
<p>ROS2의 생명주기 노드는 이벤트 기반 구조를 따른다. 즉, 상태 전이는 외부 이벤트나 명령에 의해 트리거되며, 상태 전이는 즉시 이루어지지 않고 해당 명령이 처리되는 동안 적절한 시간을 기다리게 된다. 이러한 이벤트 기반 구조는 실시간 시스템에서 노드가 비정상적으로 작동하지 않도록 도와준다.</p>
<p>노드의 상태 전이는 이벤트 큐를 통해 처리되며, 수식으로 나타내면 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{E}_i \rightarrow \mathbf{S}_i \xrightarrow{\mathbf{C}_{ij}} \mathbf{S}_j
</div>
<script type="math/tex; mode=display">
\mathbf{E}_i \rightarrow \mathbf{S}_i \xrightarrow{\mathbf{C}_{ij}} \mathbf{S}_j
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{E}_i</span><script type="math/tex">\mathbf{E}_i</script></span>는 특정 이벤트를 나타내며, 해당 이벤트가 큐에 들어오면 조건 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{C}_{ij}</span><script type="math/tex">\mathbf{C}_{ij}</script></span>에 따라 상태 전이가 이루어진다. 상태 전이는 즉시 처리되지 않고 순차적으로 진행되므로, 시스템의 안정성을 유지하는 데 도움이 된다.</p>
<h3 id="_7">상태 전이와 타이밍 이슈</h3>
<p>생명주기 노드에서 상태 전이가 발생할 때, 타이밍 이슈를 고려해야 한다. 예를 들어, <code>inactive</code> 상태에서 <code>active</code> 상태로 전이하는 도중 필요한 하드웨어 리소스가 아직 준비되지 않았다면, 상태 전이는 지연되거나 실패할 수 있다. 이러한 타이밍 문제를 해결하기 위해서는 상태 전이가 완료될 때까지 적절한 대기 시간이 필요하다.</p>
<p>상태 전이와 관련된 타이밍 이슈를 수식으로 나타내면 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{S}_i \xrightarrow{\mathbf{C}_{ij} \, \text{(타이밍 이슈)}} \mathbf{S}_j \quad \text{(지연 또는 실패)}
</div>
<script type="math/tex; mode=display">
\mathbf{S}_i \xrightarrow{\mathbf{C}_{ij} \, \text{(타이밍 이슈)}} \mathbf{S}_j \quad \text{(지연 또는 실패)}
</script>
</div>
<p>이와 같은 타이밍 문제는 주로 하드웨어나 네트워크와 상호작용하는 경우 발생할 수 있으며, 이를 방지하기 위해 상태 전이 과정에서 적절한 타임아웃(time-out)을 설정해야 한다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../0602/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../0602/" class="btn btn-xs btn-link">
        상태 전환 및 상태 관리
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter%2005/0505/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter%2005/0505/" class="btn btn-xs btn-link">
        서비스와 액션의 활용 사례
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>