<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://booiljung.github.io/math/linear_algebra/matrix_decompositions/qr_decomposition/chapter_08/081/">
    <link rel="shortcut icon" href="../../../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>QR 분해를 이용한 대표적인 문제 예제 - 소프트웨어 융합</title>
    <link href="../../../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../../../css/highlight.css">
    <link href="../../../../../../css/custom.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\uc120\ud615 \ud68c\uadc0 \ubd84\uc11d\uc5d0\uc11c\uc758 QR \ubd84\ud574", url: "#_top", children: [
          ]},
          {title: "\ucd5c\uc18c \uc81c\uacf1 \ubb38\uc81c \ud574\uacb0\uc758 \uad6c\uccb4\uc801 \uc608\uc81c", url: "#_1", children: [
              {title: "\uc608\uc81c: \ub370\uc774\ud130 \uc810\ub4e4", url: "#_2" },
          ]},
          {title: "QR \ubd84\ud574 \uc218\ud589", url: "#qr_1", children: [
          ]},
          {title: "\uc5ed\ubc29\ud5a5 \ub300\uc785\ubc95 (Back Substitution)", url: "#back-substitution", children: [
          ]},
          {title: "---", url: "#-", children: [
              {title: "QR \uc54c\uace0\ub9ac\uc998\uc744 \uc774\uc6a9\ud55c \uace0\uc720\uac12 \uacc4\uc0b0", url: "#qr_2" },
              {title: "\uc2e0\ud638 \ucc98\ub9ac \ubc0f \ud1b5\uc2e0\uc5d0\uc11c\uc758 QR \ubd84\ud574 \uc751\uc6a9", url: "#qr_4" },
              {title: "\ube14\ub85d QR \ubd84\ud574\ub97c \uc774\uc6a9\ud55c \ubcd1\ub82c \ucc98\ub9ac", url: "#qr_6" },
              {title: "\ucd5c\uc18c \uc81c\uacf1 \ubb38\uc81c\uc758 \ud655\uc7a5: \uac00\uc911 \ucd5c\uc18c \uc81c\uacf1\ubc95", url: "#_8" },
              {title: "QR \ubd84\ud574\ub97c \uc774\uc6a9\ud55c \uc870\uac74\uc218 \uacc4\uc0b0", url: "#qr_9" },
              {title: "QR \ubd84\ud574\ub97c \uc774\uc6a9\ud55c \uc9c1\uad50 \ud22c\uc601", url: "#qr_11" },
              {title: "QR \ubd84\ud574\ub97c \uc774\uc6a9\ud55c \ud589\ub82c\uc758 \uc21c\uc704 \uacb0\uc815", url: "#qr_13" },
              {title: "\uc120\ud615 \ub3c5\ub9bd\uc131 \ud655\uc778", url: "#_17" },
              {title: "2. \ud589\ub82c \uc21c\uc704 \uacc4\uc0b0", url: "#2" },
              {title: "3. \ucd5c\uc18c \uc81c\uacf1 \ubb38\uc81c\uc758 \uc815\uaddc\ubc29\uc815\uc2dd \uc720\ub3c4", url: "#3" },
              {title: "4. \uace0\uc720\uac12 \ubb38\uc81c\uc640 QR \uc54c\uace0\ub9ac\uc998", url: "#4-qr" },
          ]},
        ];

    </script>
    <script src="../../../../../../js/base.js"></script>
      <script src="../../../../../../js/google_analytics.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="https://www.googletagmanager.com/gtag/js?id=G-3F4LHCTF88"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../082/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../082/" class="btn btn-xs btn-link">
        QR 분해의 한계와 문제 해결 전략
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter_07/074/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter_07/074/" class="btn btn-xs btn-link">
        C/C++에서의 QR 분해
      </a>
    </div>
    
  </div>

    

    <p>QR 분해는 수학적 이론뿐만 아니라 다양한 실용적인 문제를 해결하는 데 매우 유용하게 사용된다. 이 섹션에서는 QR 분해를 이용하여 해결할 수 있는 몇 가지 대표적인 문제 예제를 다룬다. 각 문제는 구체적인 예제와 함께 해결 과정을 상세히 설명할 것이다.</p>
<h3 id="qr">선형 회귀 분석에서의 QR 분해</h3>
<p>선형 회귀 분석은 주어진 데이터에 대해 최적의 직선을 찾는 문제로, 데이터 점들 <span class="arithmatex"><span class="MathJax_Preview">(x_1, y_1), (x_2, y_2), \ldots, (x_n, y_n)</span><script type="math/tex">(x_1, y_1), (x_2, y_2), \ldots, (x_n, y_n)</script></span>이 주어졌을 때, 다음과 같은 선형 모델을 가정한다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{y} = \mathbf{X} \mathbf{\beta} + \mathbf{\epsilon}
</div>
<script type="math/tex; mode=display">
\mathbf{y} = \mathbf{X} \mathbf{\beta} + \mathbf{\epsilon}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>차원 벡터로 관측된 결과값을, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">n \times p</span><script type="math/tex">n \times p</script></span> 차원의 설계 행렬(design matrix)을, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>는 추정해야 할 <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>차원 계수 벡터를, 그리고 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\epsilon}</span><script type="math/tex">\mathbf{\epsilon}</script></span>는 잔차(residual) 벡터를 나타낸다.</p>
<p>이 모델에서 계수 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>를 추정하는 방법 중 하나는 최소 제곱법(Least Squares)이다. 최소 제곱 문제는 다음과 같은 목표를 가지며 정의된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\min_{\mathbf{\beta}} \|\mathbf{y} - \mathbf{X} \mathbf{\beta}\|_2^2
</div>
<script type="math/tex; mode=display">
\min_{\mathbf{\beta}} \|\mathbf{y} - \mathbf{X} \mathbf{\beta}\|_2^2
</script>
</div>
<p>이 문제를 해결하기 위해 QR 분해를 사용할 수 있다. 먼저 설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>를 QR 분해하여 다음과 같이 표현한다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{X} = \mathbf{Q} \mathbf{R}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">n \times p</span><script type="math/tex">n \times p</script></span> 차원의 직교 행렬이고, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>은 <span class="arithmatex"><span class="MathJax_Preview">p \times p</span><script type="math/tex">p \times p</script></span> 차원의 상삼각 행렬이다. 그러면 최소 제곱 문제는 다음과 같이 변환된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\min_{\mathbf{\beta}} \|\mathbf{y} - \mathbf{Q} \mathbf{R} \mathbf{\beta}\|_2^2
</div>
<script type="math/tex; mode=display">
\min_{\mathbf{\beta}} \|\mathbf{y} - \mathbf{Q} \mathbf{R} \mathbf{\beta}\|_2^2
</script>
</div>
<p>직교 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>의 성질에 의해 문제는 다음과 같이 간단히 변형된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\min_{\mathbf{\beta}} \|\mathbf{Q}^T \mathbf{y} - \mathbf{R} \mathbf{\beta}\|_2^2
</div>
<script type="math/tex; mode=display">
\min_{\mathbf{\beta}} \|\mathbf{Q}^T \mathbf{y} - \mathbf{R} \mathbf{\beta}\|_2^2
</script>
</div>
<p>이를 통해 최적화 문제는 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>에 대한 선형 시스템으로 변환된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} \mathbf{\beta} = \mathbf{Q}^T \mathbf{y}
</div>
<script type="math/tex; mode=display">
\mathbf{R} \mathbf{\beta} = \mathbf{Q}^T \mathbf{y}
</script>
</div>
<p>이제 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>을 이용하여 역방향 대입법(back substitution)으로 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>를 계산할 수 있다.</p>
<h3 id="_1">최소 제곱 문제 해결의 구체적 예제</h3>
<p>다음은 구체적인 예제를 통해 QR 분해를 이용한 최소 제곱 문제의 해결 과정을 보여준다.</p>
<h4 id="_2">예제: 데이터 점들</h4>
<p>다음과 같은 데이터 점들이 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\{(1, 2), (2, 2.8), (3, 3.6), (4, 4.5)\}
</div>
<script type="math/tex; mode=display">
\{(1, 2), (2, 2.8), (3, 3.6), (4, 4.5)\}
</script>
</div>
<p>이 데이터를 이용하여 <span class="arithmatex"><span class="MathJax_Preview">y = \beta_0 + \beta_1 x</span><script type="math/tex">y = \beta_0 + \beta_1 x</script></span> 형태의 직선을 피팅하는 문제를 QR 분해를 이용하여 해결해 보자.</p>
<p>설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>는 다음과 같이 표현된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X} = 
\begin{bmatrix}
1 &amp; 1 \\
1 &amp; 2 \\
1 &amp; 3 \\
1 &amp; 4
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{X} = 
\begin{bmatrix}
1 & 1 \\
1 & 2 \\
1 & 3 \\
1 & 4
\end{bmatrix}
</script>
</div>
<p>결과 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>는 다음과 같다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{y} = 
\begin{bmatrix}
2 \\
2.8 \\
3.6 \\
4.5
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{y} = 
\begin{bmatrix}
2 \\
2.8 \\
3.6 \\
4.5
\end{bmatrix}
</script>
</div>
<h3 id="qr_1">QR 분해 수행</h3>
<p>먼저 설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>에 대해 QR 분해를 수행한다. 이를 통해 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>를 직교 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>와 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 곱으로 분해할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{X} = \mathbf{Q} \mathbf{R}
</script>
</div>
<p>구체적으로, 설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>의 QR 분해는 다음과 같다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{Q} = 
\begin{bmatrix}
-\frac{1}{\sqrt{10}} &amp; \frac{2}{\sqrt{5}} \\
-\frac{1}{\sqrt{10}} &amp; \frac{1}{\sqrt{5}} \\
-\frac{1}{\sqrt{10}} &amp; 0 \\
-\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{5}}
\end{bmatrix}, 
\quad
\mathbf{R} = 
\begin{bmatrix}
-\sqrt{10} &amp; -5 \\
0 &amp; \sqrt{5}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{Q} = 
\begin{bmatrix}
-\frac{1}{\sqrt{10}} & \frac{2}{\sqrt{5}} \\
-\frac{1}{\sqrt{10}} & \frac{1}{\sqrt{5}} \\
-\frac{1}{\sqrt{10}} & 0 \\
-\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{5}}
\end{bmatrix}, 
\quad
\mathbf{R} = 
\begin{bmatrix}
-\sqrt{10} & -5 \\
0 & \sqrt{5}
\end{bmatrix}
</script>
</div>
<p>이제 직교 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>의 전치행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}^T</span><script type="math/tex">\mathbf{Q}^T</script></span>를 구한다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{Q}^T = 
\begin{bmatrix}
-\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{10}} \\
\frac{2}{\sqrt{5}} &amp; \frac{1}{\sqrt{5}} &amp; 0 &amp; -\frac{1}{\sqrt{5}}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{Q}^T = 
\begin{bmatrix}
-\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{10}} \\
\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}} & 0 & -\frac{1}{\sqrt{5}}
\end{bmatrix}
</script>
</div>
<p>이를 이용하여 다음과 같은 방정식을 얻는다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} \mathbf{\beta} = \mathbf{Q}^T \mathbf{y}
</div>
<script type="math/tex; mode=display">
\mathbf{R} \mathbf{\beta} = \mathbf{Q}^T \mathbf{y}
</script>
</div>
<p>우선, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}^T \mathbf{y}</span><script type="math/tex">\mathbf{Q}^T \mathbf{y}</script></span>를 계산한다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{Q}^T \mathbf{y} = 
\begin{bmatrix}
-\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{10}} &amp; -\frac{1}{\sqrt{10}} \\
\frac{2}{\sqrt{5}} &amp; \frac{1}{\sqrt{5}} &amp; 0 &amp; -\frac{1}{\sqrt{5}}
\end{bmatrix}
\begin{bmatrix}
2 \\
2.8 \\
3.6 \\
4.5
\end{bmatrix}
= 
\begin{bmatrix}
-\sqrt{10} \\
\frac{1}{\sqrt{5}}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{Q}^T \mathbf{y} = 
\begin{bmatrix}
-\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{10}} & -\frac{1}{\sqrt{10}} \\
\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}} & 0 & -\frac{1}{\sqrt{5}}
\end{bmatrix}
\begin{bmatrix}
2 \\
2.8 \\
3.6 \\
4.5
\end{bmatrix}
= 
\begin{bmatrix}
-\sqrt{10} \\
\frac{1}{\sqrt{5}}
\end{bmatrix}
</script>
</div>
<p>따라서, 다음과 같은 선형 시스템이 도출된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} \mathbf{\beta} = 
\begin{bmatrix}
-\sqrt{10} &amp; -5 \\
0 &amp; \sqrt{5}
\end{bmatrix}
\mathbf{\beta} = 
\begin{bmatrix}
-\sqrt{10} \\
\frac{1}{\sqrt{5}}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{R} \mathbf{\beta} = 
\begin{bmatrix}
-\sqrt{10} & -5 \\
0 & \sqrt{5}
\end{bmatrix}
\mathbf{\beta} = 
\begin{bmatrix}
-\sqrt{10} \\
\frac{1}{\sqrt{5}}
\end{bmatrix}
</script>
</div>
<p>이제 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>에 대한 선형 시스템을 풀어서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>를 구할 수 있다.</p>
<h3 id="back-substitution">역방향 대입법 (Back Substitution)</h3>
<p>이제 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>에 대한 선형 시스템을 역방향 대입법을 사용하여 푼다.</p>
<p>먼저 <span class="arithmatex"><span class="MathJax_Preview">\beta_2</span><script type="math/tex">\beta_2</script></span>를 계산한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\sqrt{5} \cdot \beta_2 = \frac{1}{\sqrt{5}} \quad \Rightarrow \quad \beta_2 = \frac{1}{5}
</div>
<script type="math/tex; mode=display">
\sqrt{5} \cdot \beta_2 = \frac{1}{\sqrt{5}} \quad \Rightarrow \quad \beta_2 = \frac{1}{5}
</script>
</div>
<p>그 다음, <span class="arithmatex"><span class="MathJax_Preview">\beta_1</span><script type="math/tex">\beta_1</script></span>을 계산한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
-\sqrt{10} \cdot \beta_1 - 5 \cdot \frac{1}{5} = -\sqrt{10} \quad \Rightarrow \quad -\sqrt{10} \cdot \beta_1 - 1 = -\sqrt{10} \quad \Rightarrow \quad \beta_1 = 1
</div>
<script type="math/tex; mode=display">
-\sqrt{10} \cdot \beta_1 - 5 \cdot \frac{1}{5} = -\sqrt{10} \quad \Rightarrow \quad -\sqrt{10} \cdot \beta_1 - 1 = -\sqrt{10} \quad \Rightarrow \quad \beta_1 = 1
</script>
</div>
<p>따라서, 최종적으로 추정된 계수 벡터는 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{\beta} = 
\begin{bmatrix}
1 \\
\frac{1}{5}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{\beta} = 
\begin{bmatrix}
1 \\
\frac{1}{5}
\end{bmatrix}
</script>
</div>
<p>이 결과는 선형 회귀 문제에서 데이터에 가장 잘 맞는 직선이 <span class="arithmatex"><span class="MathJax_Preview">y = 1 + \frac{1}{5}x</span><script type="math/tex">y = 1 + \frac{1}{5}x</script></span>임을 의미한다.</p>
<h1 id="-">---</h1>
<p>위 예제를 통해 QR 분해가 선형 회귀 분석의 최소 제곱 문제를 효율적으로 해결할 수 있음을 확인할 수 있다. QR 분해는 직접적인 역행렬 계산 없이도 안정적이고 효율적으로 선형 시스템을 풀 수 있는 강력한 도구이다.</p>
<h3 id="qr_2">QR 알고리즘을 이용한 고유값 계산</h3>
<p>QR 분해는 고유값(eigenvalue) 문제를 해결하는 데에도 중요한 역할을 한다. 특히 QR 알고리즘은 행렬의 고유값을 구하는 효율적인 방법으로 널리 사용된다. QR 알고리즘은 반복적인 QR 분해를 통해 행렬을 삼각화하여 고유값을 계산하는 방식이다.</p>
<h4 id="_3">예제: 행렬의 고유값 계산</h4>
<p>다음과 같은 <span class="arithmatex"><span class="MathJax_Preview">3 \times 3</span><script type="math/tex">3 \times 3</script></span> 실수 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = 
\begin{bmatrix}
4 &amp; 1 &amp; 2 \\
1 &amp; 2 &amp; 0 \\
2 &amp; 0 &amp; 3
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{A} = 
\begin{bmatrix}
4 & 1 & 2 \\
1 & 2 & 0 \\
2 & 0 & 3
\end{bmatrix}
</script>
</div>
<p>이 행렬의 고유값을 QR 알고리즘을 사용하여 구해보겠다.</p>
<h4 id="qr_3">초기 단계: QR 분해</h4>
<p>QR 알고리즘의 첫 번째 단계는 주어진 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>에 대해 QR 분해를 수행하는 것이다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = \mathbf{Q}_0 \mathbf{R}_0
</div>
<script type="math/tex; mode=display">
\mathbf{A} = \mathbf{Q}_0 \mathbf{R}_0
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}_0</span><script type="math/tex">\mathbf{Q}_0</script></span>는 직교 행렬이고, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}_0</span><script type="math/tex">\mathbf{R}_0</script></span>은 상삼각 행렬이다.</p>
<h4 id="_4">반복 과정</h4>
<p>QR 알고리즘은 다음과 같은 반복 과정을 통해 행렬을 갱신한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A}_{k+1} = \mathbf{R}_k \mathbf{Q}_k
</div>
<script type="math/tex; mode=display">
\mathbf{A}_{k+1} = \mathbf{R}_k \mathbf{Q}_k
</script>
</div>
<p>이 과정에서 갱신된 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}_{k+1}</span><script type="math/tex">\mathbf{A}_{k+1}</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}_k</span><script type="math/tex">\mathbf{A}_k</script></span>와 유사하므로, 고유값은 변하지 않는다. 반복이 충분히 진행되면 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}_{k+1}</span><script type="math/tex">\mathbf{A}_{k+1}</script></span>는 거의 상삼각 형태로 수렴하며, 대각 성분이 고유값을 나타낸다.</p>
<h4 id="_5">구체적인 반복 예시</h4>
<p>반복을 3회 진행한다고 가정하고, 각각의 단계에서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}_k</span><script type="math/tex">\mathbf{A}_k</script></span> 행렬과 대응하는 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}_k</span><script type="math/tex">\mathbf{Q}_k</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}_k</span><script type="math/tex">\mathbf{R}_k</script></span>를 구한다.</p>
<ol>
<li><strong>1단계</strong>:</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
   \mathbf{A}_1 = \mathbf{R}_0 \mathbf{Q}_0 = \mathbf{Q}_0^T \mathbf{A} \mathbf{Q}_0
</div>
<script type="math/tex; mode=display">
   \mathbf{A}_1 = \mathbf{R}_0 \mathbf{Q}_0 = \mathbf{Q}_0^T \mathbf{A} \mathbf{Q}_0
</script>
</div>
<ol>
<li><strong>2단계</strong>:</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
   \mathbf{A}_2 = \mathbf{R}_1 \mathbf{Q}_1
</div>
<script type="math/tex; mode=display">
   \mathbf{A}_2 = \mathbf{R}_1 \mathbf{Q}_1
</script>
</div>
<ol>
<li><strong>3단계</strong>:</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
   \mathbf{A}_3 = \mathbf{R}_2 \mathbf{Q}_2
</div>
<script type="math/tex; mode=display">
   \mathbf{A}_3 = \mathbf{R}_2 \mathbf{Q}_2
</script>
</div>
<p>반복 과정이 충분히 진행된 후, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}_k</span><script type="math/tex">\mathbf{A}_k</script></span>는 거의 상삼각 행렬이 되며, 이 행렬의 대각 성분이 원래 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 고유값을 근사한다.</p>
<h4 id="_6">결과 해석</h4>
<p>QR 알고리즘을 통해 구한 상삼각 행렬의 대각 성분이 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 고유값을 나타낸다. 이 방법은 반복 횟수에 따라 원하는 정확도로 수렴할 수 있으며, 특히 대칭 행렬의 경우 매우 빠르게 수렴한다.</p>
<h3 id="qr_4">신호 처리 및 통신에서의 QR 분해 응용</h3>
<p>QR 분해는 신호 처리와 통신 분야에서도 중요한 응용을 가지고 있다. 특히 다중 입력 다중 출력(MIMO) 시스템에서의 데이터 전송, 레이더 신호 처리, 그리고 적응형 안테나 시스템에서 QR 분해는 필수적인 도구이다.</p>
<h4 id="mimo-qr">예제: MIMO 시스템에서의 QR 분해</h4>
<p>MIMO 시스템은 여러 송신 안테나와 여러 수신 안테나를 사용하여 데이터 전송 속도를 증가시키고 신호 강도를 향상시키는 기술이다. 이 시스템에서는 다음과 같은 기본적인 수신 모델이 사용된다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{y} = \mathbf{H} \mathbf{x} + \mathbf{n}
</div>
<script type="math/tex; mode=display">
\mathbf{y} = \mathbf{H} \mathbf{x} + \mathbf{n}
</script>
</div>
<p>여기서:</p>
<ul>
<li><span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>는 수신 안테나에서의 수신 신호 벡터이다.</li>
<li><span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">n_r \times n_t</span><script type="math/tex">n_r \times n_t</script></span> 채널 행렬로, <span class="arithmatex"><span class="MathJax_Preview">n_r</span><script type="math/tex">n_r</script></span>개의 수신 안테나와 <span class="arithmatex"><span class="MathJax_Preview">n_t</span><script type="math/tex">n_t</script></span>개의 송신 안테나 간의 채널 상태를 나타낸다.</li>
<li><span class="arithmatex"><span class="MathJax_Preview">\mathbf{x}</span><script type="math/tex">\mathbf{x}</script></span>는 송신 신호 벡터이다.</li>
<li><span class="arithmatex"><span class="MathJax_Preview">\mathbf{n}</span><script type="math/tex">\mathbf{n}</script></span>는 잡음 벡터이다.</li>
</ul>
<p>MIMO 시스템에서 데이터를 복원하기 위해 수신 신호 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>로부터 송신 신호 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{x}</span><script type="math/tex">\mathbf{x}</script></span>를 추정하는 과정에서 QR 분해가 사용된다.</p>
<h4 id="qr_5">QR 분해를 이용한 신호 복원</h4>
<p>채널 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>에 대해 QR 분해를 수행하여 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>를 직교 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>와 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>로 분해한다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{H} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{H} = \mathbf{Q} \mathbf{R}
</script>
</div>
<p>이 분해를 사용하여 수신 신호 모델을 다음과 같이 변환할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{y} = \mathbf{Q} \mathbf{R} \mathbf{x} + \mathbf{n}
</div>
<script type="math/tex; mode=display">
\mathbf{y} = \mathbf{Q} \mathbf{R} \mathbf{x} + \mathbf{n}
</script>
</div>
<p>직교 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>의 특성에 따라 위 식을 다음과 같이 간단히 변형할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{Q}^T \mathbf{y} = \mathbf{R} \mathbf{x} + \mathbf{Q}^T \mathbf{n}
</div>
<script type="math/tex; mode=display">
\mathbf{Q}^T \mathbf{y} = \mathbf{R} \mathbf{x} + \mathbf{Q}^T \mathbf{n}
</script>
</div>
<p>이제 이 선형 시스템에서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>이 상삼각 행렬이므로, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{x}</span><script type="math/tex">\mathbf{x}</script></span>는 역방향 대입법(back substitution)을 통해 쉽게 구할 수 있다. 이는 잡음이 없는 이상적인 상황에서의 송신 신호 복원 과정이다.</p>
<h4 id="mimo">MIMO 시스템에서의 이점</h4>
<p>QR 분해를 사용하면 MIMO 시스템에서의 복호화 과정이 간단해지고, 특히 잡음이 있을 때 신호 복원 과정에서의 계산 효율이 향상된다. 더불어 QR 분해는 각 송신 안테나와 수신 안테나 간의 상호 간섭을 줄이는 데 효과적이다.</p>
<p>QR 분해를 활용한 이러한 방법은 MIMO 시스템에서의 데이터 전송 신뢰성을 높이고 전송 속도를 향상시키는 데 기여한다.</p>
<h3 id="qr_6">블록 QR 분해를 이용한 병렬 처리</h3>
<p>신호 처리와 통신 시스템에서 대규모 행렬 연산이 필요한 경우, 블록 QR 분해를 사용하여 병렬 처리를 수행할 수 있다. 이는 매우 큰 행렬을 여러 작은 블록으로 나누어 각각을 QR 분해하는 방식으로, 전체적인 계산 시간을 크게 줄일 수 있다.</p>
<h4 id="_7">예제: 대규모 안테나 시스템</h4>
<p>대규모 안테나 시스템에서는 수백 개 이상의 안테나가 사용되며, 이에 따른 행렬의 크기도 매우 크다. 이러한 시스템에서의 채널 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>는 매우 큰 크기를 가질 수 있으며, 이로 인해 전통적인 QR 분해 방식은 효율적이지 않을 수 있다.</p>
<p>블록 QR 분해를 사용하면 채널 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>를 여러 블록으로 나누고, 각 블록에 대해 독립적으로 QR 분해를 수행한 후, 결과를 결합하여 최종 QR 분해를 얻을 수 있다.</p>
<h4 id="qr_7">블록 QR 분해의 단계</h4>
<ol>
<li><strong>행렬 분할</strong>: 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>를 적절한 크기의 블록 행렬로 분할한다.</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{H} = 
\begin{bmatrix}
\mathbf{H}_{11} &amp; \mathbf{H}_{12} \\
\mathbf{H}_{21} &amp; \mathbf{H}_{22}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{H} = 
\begin{bmatrix}
\mathbf{H}_{11} & \mathbf{H}_{12} \\
\mathbf{H}_{21} & \mathbf{H}_{22}
\end{bmatrix}
</script>
</div>
<ol>
<li><strong>각 블록에 대한 QR 분해 수행</strong>: 각 블록에 대해 독립적으로 QR 분해를 수행한다.</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{H}_{ij} = \mathbf{Q}_{ij} \mathbf{R}_{ij}
</div>
<script type="math/tex; mode=display">
\mathbf{H}_{ij} = \mathbf{Q}_{ij} \mathbf{R}_{ij}
</script>
</div>
<ol>
<li><strong>결합</strong>: 각 블록에 대한 QR 분해 결과를 결합하여 전체 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{H}</span><script type="math/tex">\mathbf{H}</script></span>에 대한 최종 QR 분해를 구한다.</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{H} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{H} = \mathbf{Q} \mathbf{R}
</script>
</div>
<p>블록 QR 분해는 대규모 신호 처리 시스템에서 병렬 연산을 통해 처리 시간을 크게 단축시킬 수 있으며, 특히 실시간 처리가 요구되는 통신 시스템에서 유용하다.</p>
<h3 id="_8">최소 제곱 문제의 확장: 가중 최소 제곱법</h3>
<p>QR 분해는 가중 최소 제곱 문제(Weighted Least Squares, WLS)에도 적용될 수 있다. 가중 최소 제곱법은 데이터 포인트마다 중요도가 다를 때, 각 데이터 포인트에 가중치를 부여하여 최소 제곱 문제를 해결하는 방법이다.</p>
<h4 id="_9">가중 최소 제곱 문제의 정의</h4>
<p>일반적인 최소 제곱 문제에서 우리는 잔차(residual)의 제곱합을 최소화하려고 한다. 그러나 데이터의 신뢰도가 일정하지 않은 경우, 각 데이터 포인트에 다른 가중치를 부여하여 잔차의 제곱합을 최소화하는 것이 더 합리적일 수 있다. 이때 가중 최소 제곱 문제는 다음과 같이 정의된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\min_{\mathbf{\beta}} \|\mathbf{W}^{\frac{1}{2}}(\mathbf{y} - \mathbf{X} \mathbf{\beta})\|_2^2
</div>
<script type="math/tex; mode=display">
\min_{\mathbf{\beta}} \|\mathbf{W}^{\frac{1}{2}}(\mathbf{y} - \mathbf{X} \mathbf{\beta})\|_2^2
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{W}</span><script type="math/tex">\mathbf{W}</script></span>는 대각 성분이 가중치인 <span class="arithmatex"><span class="MathJax_Preview">n \times n</span><script type="math/tex">n \times n</script></span> 대각 행렬이다. </p>
<h4 id="qr_8">QR 분해를 이용한 가중 최소 제곱 문제 해결</h4>
<p>가중 최소 제곱 문제를 해결하기 위해 설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>와 결과 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>에 가중치를 적용하여 새로운 행렬과 벡터를 정의할 수 있다.</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{X}, \quad \mathbf{y}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{y}
</div>
<script type="math/tex; mode=display">
\mathbf{X}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{X}, \quad \mathbf{y}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{y}
</script>
</div>
<p>이제, 새로운 최소 제곱 문제는 다음과 같이 다시 쓰여진다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\min_{\mathbf{\beta}} \|\mathbf{y}_w - \mathbf{X}_w \mathbf{\beta}\|_2^2
</div>
<script type="math/tex; mode=display">
\min_{\mathbf{\beta}} \|\mathbf{y}_w - \mathbf{X}_w \mathbf{\beta}\|_2^2
</script>
</div>
<p>이 문제는 일반적인 최소 제곱 문제와 동일한 형태이므로, QR 분해를 사용하여 해결할 수 있다. 즉, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}_w</span><script type="math/tex">\mathbf{X}_w</script></span>에 대해 QR 분해를 수행한 후, 동일한 방식으로 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>를 추정한다.</p>
<h4 id="_10">예제: 가중치가 적용된 데이터에 대한 회귀 분석</h4>
<p>다음과 같은 데이터 포인트가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\{(1, 2, 0.5), (2, 2.8, 1.5), (3, 3.6, 2.0), (4, 4.5, 0.8)\}
</div>
<script type="math/tex; mode=display">
\{(1, 2, 0.5), (2, 2.8, 1.5), (3, 3.6, 2.0), (4, 4.5, 0.8)\}
</script>
</div>
<p>여기서 각 데이터 포인트는 <span class="arithmatex"><span class="MathJax_Preview">(x_i, y_i, w_i)</span><script type="math/tex">(x_i, y_i, w_i)</script></span>의 형태를 가지며, <span class="arithmatex"><span class="MathJax_Preview">w_i</span><script type="math/tex">w_i</script></span>는 해당 데이터 포인트의 가중치이다.</p>
<p>설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>는 다음과 같이 정의된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X} = 
\begin{bmatrix}
1 &amp; 1 \\
1 &amp; 2 \\
1 &amp; 3 \\
1 &amp; 4
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{X} = 
\begin{bmatrix}
1 & 1 \\
1 & 2 \\
1 & 3 \\
1 & 4
\end{bmatrix}
</script>
</div>
<p>결과 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>는 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{y} = 
\begin{bmatrix}
2 \\
2.8 \\
3.6 \\
4.5
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{y} = 
\begin{bmatrix}
2 \\
2.8 \\
3.6 \\
4.5
\end{bmatrix}
</script>
</div>
<p>가중치 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{W}</span><script type="math/tex">\mathbf{W}</script></span>는 다음과 같이 정의된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{W} = 
\begin{bmatrix}
0.5 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1.5 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 2.0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0.8
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{W} = 
\begin{bmatrix}
0.5 & 0 & 0 & 0 \\
0 & 1.5 & 0 & 0 \\
0 & 0 & 2.0 & 0 \\
0 & 0 & 0 & 0.8
\end{bmatrix}
</script>
</div>
<p>가중된 설계 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}_w</span><script type="math/tex">\mathbf{X}_w</script></span>와 결과 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}_w</span><script type="math/tex">\mathbf{y}_w</script></span>는 각각 다음과 같이 계산된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{X}, \quad \mathbf{y}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{y}
</div>
<script type="math/tex; mode=display">
\mathbf{X}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{X}, \quad \mathbf{y}_w = \mathbf{W}^{\frac{1}{2}} \mathbf{y}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{W}^{\frac{1}{2}} = 
\begin{bmatrix}
\sqrt{0.5} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \sqrt{1.5} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sqrt{2.0} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sqrt{0.8}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{W}^{\frac{1}{2}} = 
\begin{bmatrix}
\sqrt{0.5} & 0 & 0 & 0 \\
0 & \sqrt{1.5} & 0 & 0 \\
0 & 0 & \sqrt{2.0} & 0 \\
0 & 0 & 0 & \sqrt{0.8}
\end{bmatrix}
</script>
</div>
<p>따라서:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}_w = 
\begin{bmatrix}
\sqrt{0.5} &amp; \sqrt{0.5} \\
\sqrt{1.5} &amp; 2\sqrt{1.5} \\
\sqrt{2.0} &amp; 3\sqrt{2.0} \\
\sqrt{0.8} &amp; 4\sqrt{0.8}
\end{bmatrix}
, \quad \mathbf{y}_w = 
\begin{bmatrix}
\sqrt{0.5} \cdot 2 \\
\sqrt{1.5} \cdot 2.8 \\
\sqrt{2.0} \cdot 3.6 \\
\sqrt{0.8} \cdot 4.5
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{X}_w = 
\begin{bmatrix}
\sqrt{0.5} & \sqrt{0.5} \\
\sqrt{1.5} & 2\sqrt{1.5} \\
\sqrt{2.0} & 3\sqrt{2.0} \\
\sqrt{0.8} & 4\sqrt{0.8}
\end{bmatrix}
, \quad \mathbf{y}_w = 
\begin{bmatrix}
\sqrt{0.5} \cdot 2 \\
\sqrt{1.5} \cdot 2.8 \\
\sqrt{2.0} \cdot 3.6 \\
\sqrt{0.8} \cdot 4.5
\end{bmatrix}
</script>
</div>
<p>이제 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}_w</span><script type="math/tex">\mathbf{X}_w</script></span>에 대해 QR 분해를 수행하여 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>를 계산할 수 있다.</p>
<h3 id="qr_9">QR 분해를 이용한 조건수 계산</h3>
<p>조건수(condition number)는 행렬의 감수성을 측정하는 중요한 지표로, 행렬이 잘못되었을 때 얼마나 큰 오차가 발생할 수 있는지를 나타낸다. 조건수가 큰 행렬은 계산 과정에서 수치적 불안정성을 가질 수 있다. QR 분해를 사용하여 행렬의 조건수를 계산할 수 있다.</p>
<h4 id="_11">조건수의 정의</h4>
<p>행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 조건수 <span class="arithmatex"><span class="MathJax_Preview">\kappa(\mathbf{A})</span><script type="math/tex">\kappa(\mathbf{A})</script></span>는 다음과 같이 정의된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\kappa(\mathbf{A}) = \|\mathbf{A}\| \cdot \|\mathbf{A}^{-1}\|
</div>
<script type="math/tex; mode=display">
\kappa(\mathbf{A}) = \|\mathbf{A}\| \cdot \|\mathbf{A}^{-1}\|
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\|\mathbf{A}\|</span><script type="math/tex">\|\mathbf{A}\|</script></span>는 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 노름(norm)을 나타낸다. 보통 2-노름(또는 스펙트럼 노름)을 사용하며, 이는 행렬의 최대 특이값과 최소 특이값의 비율로도 정의된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\kappa(\mathbf{A}) = \frac{\sigma_{\text{max}}(\mathbf{A})}{\sigma_{\text{min}}(\mathbf{A})}
</div>
<script type="math/tex; mode=display">
\kappa(\mathbf{A}) = \frac{\sigma_{\text{max}}(\mathbf{A})}{\sigma_{\text{min}}(\mathbf{A})}
</script>
</div>
<h4 id="qr_10">QR 분해를 이용한 조건수 계산 방법</h4>
<p>QR 분해를 이용해 조건수를 계산하는 방법은 다음과 같다:</p>
<ol>
<li>
<p><strong>QR 분해 수행</strong>: 주어진 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>에 대해 QR 분해를 수행하여, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A} = \mathbf{Q} \mathbf{R}</span><script type="math/tex">\mathbf{A} = \mathbf{Q} \mathbf{R}</script></span> 형태로 분해한다.</p>
</li>
<li>
<p><strong>상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 조건수 계산</strong>: <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 조건수는 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 조건수와 동일한다. 이는 직교 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{Q}</span><script type="math/tex">\mathbf{Q}</script></span>의 노름이 1이기 때문이다.</p>
</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
   \kappa(\mathbf{A}) = \kappa(\mathbf{R})
</div>
<script type="math/tex; mode=display">
   \kappa(\mathbf{A}) = \kappa(\mathbf{R})
</script>
</div>
<ol>
<li><strong><span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 조건수 계산</strong>: 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 최대 대각 성분과 최소 대각 성분의 비율로 조건수를 계산할 수 있다.</li>
</ol>
<div class="arithmatex">
<div class="MathJax_Preview">
   \kappa(\mathbf{R}) = \frac{\max_i |r_{ii}|}{\min_i |r_{ii}|}
</div>
<script type="math/tex; mode=display">
   \kappa(\mathbf{R}) = \frac{\max_i |r_{ii}|}{\min_i |r_{ii}|}
</script>
</div>
<h4 id="_12">예제: 조건수 계산</h4>
<p>다음과 같은 <span class="arithmatex"><span class="MathJax_Preview">3 \times 3</span><script type="math/tex">3 \times 3</script></span> 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>를 고려해보겠다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = 
\begin{bmatrix}
4 &amp; 2 &amp; 3 \\
3 &amp; 1 &amp; 2 \\
2 &amp; 1 &amp; 3
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{A} = 
\begin{bmatrix}
4 & 2 & 3 \\
3 & 1 & 2 \\
2 & 1 & 3
\end{bmatrix}
</script>
</div>
<p>이 행렬에 대해 QR 분해를 수행하면 다음과 같이 분해된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{A} = \mathbf{Q} \mathbf{R}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>은 다음과 같다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} = 
\begin{bmatrix}
5.3852 &amp; 2.4495 &amp; 4.6833 \\
0 &amp; 1.1547 &amp; 0.5774 \\
0 &amp; 0 &amp; 1.4142
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{R} = 
\begin{bmatrix}
5.3852 & 2.4495 & 4.6833 \\
0 & 1.1547 & 0.5774 \\
0 & 0 & 1.4142
\end{bmatrix}
</script>
</div>
<p>이제 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 대각 성분을 이용하여 조건수를 계산한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\kappa(\mathbf{R}) = \frac{\max(5.3852, 1.1547, 1.4142)}{\min(5.3852, 1.1547, 1.4142)} = \frac{5.3852}{1.1547} \approx 4.6642
</div>
<script type="math/tex; mode=display">
\kappa(\mathbf{R}) = \frac{\max(5.3852, 1.1547, 1.4142)}{\min(5.3852, 1.1547, 1.4142)} = \frac{5.3852}{1.1547} \approx 4.6642
</script>
</div>
<p>따라서 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 조건수는 약 4.6642이다. 이는 행렬이 비교적 잘 조건화되어 있음을 나타내며, 수치 계산에서 큰 불안정성이 발생하지 않을 것을 의미한다.</p>
<h3 id="qr_11">QR 분해를 이용한 직교 투영</h3>
<p>QR 분해는 직교 투영 문제에서도 중요한 역할을 한다. 직교 투영은 데이터의 특정 하위 공간에 대한 투영을 의미하며, QR 분해를 통해 이러한 투영을 효율적으로 계산할 수 있다.</p>
<h4 id="_13">직교 투영 문제의 정의</h4>
<p>주어진 데이터 포인트 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>와 데이터 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>가 있을 때, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>의 열 벡터로 생성된 공간에 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>를 직교 투영하려고 한다. 이를 수학적으로 다음과 같이 표현할 수 있다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\hat{\mathbf{y}} = \mathbf{X} \mathbf{X}^+ \mathbf{y}
</div>
<script type="math/tex; mode=display">
\hat{\mathbf{y}} = \mathbf{X} \mathbf{X}^+ \mathbf{y}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}^+</span><script type="math/tex">\mathbf{X}^+</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>의 의사역행렬(pseudo-inverse)을 나타내며, 이는 다음과 같이 QR 분해를 통해 계산할 수 있다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}^+ = \mathbf{R}^{-1} \mathbf{Q}^T
</div>
<script type="math/tex; mode=display">
\mathbf{X}^+ = \mathbf{R}^{-1} \mathbf{Q}^T
</script>
</div>
<p>따라서 직교 투영 벡터 <span class="arithmatex"><span class="MathJax_Preview">\hat{\mathbf{y}}</span><script type="math/tex">\hat{\mathbf{y}}</script></span>는 다음과 같이 계산된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\hat{\mathbf{y}} = \mathbf{X} \mathbf{R}^{-1} \mathbf{Q}^T \mathbf{y}
</div>
<script type="math/tex; mode=display">
\hat{\mathbf{y}} = \mathbf{X} \mathbf{R}^{-1} \mathbf{Q}^T \mathbf{y}
</script>
</div>
<h4 id="_14">예제: 직교 투영 계산</h4>
<p>다음과 같은 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>와 벡터 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X} = 
\begin{bmatrix}
1 &amp; 0 \\
1 &amp; 1 \\
1 &amp; 2
\end{bmatrix}, \quad \mathbf{y} = 
\begin{bmatrix}
1 \\
2 \\
3
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{X} = 
\begin{bmatrix}
1 & 0 \\
1 & 1 \\
1 & 2
\end{bmatrix}, \quad \mathbf{y} = 
\begin{bmatrix}
1 \\
2 \\
3
\end{bmatrix}
</script>
</div>
<h4 id="qr_12">QR 분해 수행</h4>
<p><span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>에 대해 QR 분해를 수행하면:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{Q} = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} &amp; \frac{2}{\sqrt{6}} \\
-\frac{1}{\sqrt{3}} &amp; -\frac{1}{\sqrt{6}} \\
-\frac{1}{\sqrt{3}} &amp; \frac{1}{\sqrt{6}}
\end{bmatrix}, \quad \mathbf{R} = 
\begin{bmatrix}
-\sqrt{3} &amp; -\sqrt{3} \\
0 &amp; \sqrt{2}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{Q} = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} & \frac{2}{\sqrt{6}} \\
-\frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{6}} \\
-\frac{1}{\sqrt{3}} & \frac{1}{\sqrt{6}}
\end{bmatrix}, \quad \mathbf{R} = 
\begin{bmatrix}
-\sqrt{3} & -\sqrt{3} \\
0 & \sqrt{2}
\end{bmatrix}
</script>
</div>
<h4 id="mathbfxmathbfx"><span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}^+</span><script type="math/tex">\mathbf{X}^+</script></span> 계산</h4>
<p><span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 역행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}^{-1}</span><script type="math/tex">\mathbf{R}^{-1}</script></span>을 구한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R}^{-1} = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} &amp; -\frac{1}{\sqrt{3}} \\
0 &amp; \frac{1}{\sqrt{2}}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{R}^{-1} = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{3}} \\
0 & \frac{1}{\sqrt{2}}
\end{bmatrix}
</script>
</div>
<p>따라서:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}^+ = \mathbf{R}^{-1} \mathbf{Q}^T = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} &amp; -\frac{1}{\sqrt{3}} &amp; -\frac{1}{\sqrt{3}} \\
0 &amp; \frac{1}{\sqrt{2}} &amp; \frac{2}{\sqrt{6}}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{X}^+ = \mathbf{R}^{-1} \mathbf{Q}^T = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{3}} \\
0 & \frac{1}{\sqrt{2}} & \frac{2}{\sqrt{6}}
\end{bmatrix}
</script>
</div>
<h4 id="hatmathbfyhatmathbfy">직교 투영 <span class="arithmatex"><span class="MathJax_Preview">\hat{\mathbf{y}}</span><script type="math/tex">\hat{\mathbf{y}}</script></span> 계산</h4>
<p><span class="arithmatex"><span class="MathJax_Preview">\hat{\mathbf{y}} = \mathbf{X} \mathbf{X}^+ \mathbf{y}</span><script type="math/tex">\hat{\mathbf{y}} = \mathbf{X} \mathbf{X}^+ \mathbf{y}</script></span>를 계산한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}^+ \mathbf{y} = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} &amp; -\frac{1}{\sqrt{3}} &amp; -\frac{1}{\sqrt{3}} \\
0 &amp; \frac{1}{\sqrt{2}} &amp; \frac{2}{\sqrt{6}}
\end{bmatrix}
\begin{bmatrix}
1 \\
2 \\
3
\end{bmatrix}
= 
\begin{bmatrix}
-\frac{6}{\sqrt{3}} \\
\frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}}
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{X}^+ \mathbf{y} = 
\begin{bmatrix}
-\frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{3}} \\
0 & \frac{1}{\sqrt{2}} & \frac{2}{\sqrt{6}}
\end{bmatrix}
\begin{bmatrix}
1 \\
2 \\
3
\end{bmatrix}
= 
\begin{bmatrix}
-\frac{6}{\sqrt{3}} \\
\frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}}
\end{bmatrix}
</script>
</div>
<p>이제 <span class="arithmatex"><span class="MathJax_Preview">\hat{\mathbf{y}} = \mathbf{X} \mathbf{X}^+ \mathbf{y}</span><script type="math/tex">\hat{\mathbf{y}} = \mathbf{X} \mathbf{X}^+ \mathbf{y}</script></span>를 계산하면:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\hat{\mathbf{y}} = 
\begin{bmatrix}
1 &amp; 0 \\
1 &amp; 1 \\
1 &amp; 2
\end{bmatrix}
\begin{bmatrix}
-\frac{6}{\sqrt{3}} \\
\frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}}
\end{bmatrix}
=
\begin{bmatrix}
-\frac{6}{\sqrt{3}} \\
-\frac{6}{\sqrt{3}} + \frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}} \\
-\frac{6}{\sqrt{3}} + 2 \cdot \left( \frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}} \right)
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\hat{\mathbf{y}} = 
\begin{bmatrix}
1 & 0 \\
1 & 1 \\
1 & 2
\end{bmatrix}
\begin{bmatrix}
-\frac{6}{\sqrt{3}} \\
\frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}}
\end{bmatrix}
=
\begin{bmatrix}
-\frac{6}{\sqrt{3}} \\
-\frac{6}{\sqrt{3}} + \frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}} \\
-\frac{6}{\sqrt{3}} + 2 \cdot \left( \frac{2}{\sqrt{2}} + \frac{6}{\sqrt{6}} \right)
\end{bmatrix}
</script>
</div>
<p>계산을 간단히 하면, 최종 직교 투영 벡터는:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\hat{\mathbf{y}} = 
\begin{bmatrix}
2 \\
2 \\
2
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\hat{\mathbf{y}} = 
\begin{bmatrix}
2 \\
2 \\
2
\end{bmatrix}
</script>
</div>
<p>이는 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>의 열 벡터로 생성된 공간에 대해 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{y}</span><script type="math/tex">\mathbf{y}</script></span>의 직교 투영을 나타낸다.</p>
<h3 id="qr_13">QR 분해를 이용한 행렬의 순위 결정</h3>
<p>QR 분해는 행렬의 순위(rank)를 결정하는 데에도 사용할 수 있다. 행렬의 순위는 행렬의 선형 독립적인 열 또는 행의 최대 개수를 의미한다. 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>를 QR 분해하여 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A} = \mathbf{Q} \mathbf{R}</span><script type="math/tex">\mathbf{A} = \mathbf{Q} \mathbf{R}</script></span>로 표현하면, 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 비영(zero가 아닌) 대각 성분의 개수가 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 순위와 동일한다.</p>
<h4 id="_15">순위 결정의 과정</h4>
<ol>
<li>
<p><strong>QR 분해 수행</strong>: 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>에 대해 QR 분해를 수행하여 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A} = \mathbf{Q} \mathbf{R}</span><script type="math/tex">\mathbf{A} = \mathbf{Q} \mathbf{R}</script></span>로 분해한다.</p>
</li>
<li>
<p><strong>상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 분석</strong>: <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 대각 성분을 확인하여, 비영 성분의 개수를 셉니다.</p>
</li>
<li>
<p><strong>행렬의 순위 결정</strong>: 이 비영 성분의 개수가 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 순위이다.</p>
</li>
</ol>
<h4 id="_16">예제: 행렬의 순위 계산</h4>
<p>다음과 같은 <span class="arithmatex"><span class="MathJax_Preview">3 \times 3</span><script type="math/tex">3 \times 3</script></span> 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = 
\begin{bmatrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{A} = 
\begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
</script>
</div>
<p>이 행렬에 대해 QR 분해를 수행하면:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} = 
\begin{bmatrix}
-\sqrt{66} &amp; -\frac{92}{\sqrt{66}} &amp; -\frac{44}{\sqrt{66}} \\
0 &amp; -\frac{6}{\sqrt{66}} &amp; -\frac{12}{\sqrt{66}} \\
0 &amp; 0 &amp; 0
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{R} = 
\begin{bmatrix}
-\sqrt{66} & -\frac{92}{\sqrt{66}} & -\frac{44}{\sqrt{66}} \\
0 & -\frac{6}{\sqrt{66}} & -\frac{12}{\sqrt{66}} \\
0 & 0 & 0
\end{bmatrix}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 대각 성분은 <span class="arithmatex"><span class="MathJax_Preview">-\sqrt{66}</span><script type="math/tex">-\sqrt{66}</script></span>, <span class="arithmatex"><span class="MathJax_Preview">-\frac{6}{\sqrt{66}}</span><script type="math/tex">-\frac{6}{\sqrt{66}}</script></span>, 그리고 <span class="arithmatex"><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>이다. 따라서, 이 행렬의 순위는 2이다.</p>
<p>이 예제는 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 행렬이 두 개의 선형 독립적인 열(또는 행)만을 가지며, 세 번째 열(또는 행)은 다른 두 열(또는 행)의 선형 결합임을 보여준다.</p>
<p>이와 같은 방식으로 QR 분해를 사용하여 행렬의 순위를 효율적으로 결정할 수 있다. 이는 특히 큰 행렬에 대해 행렬의 성질을 분석하는 데 유용한 도구이다.</p>
<p>다만, QR 분해를 수행할 때 대각 성분이 0에 가까운 수인 경우, 수치적 오류에 주의해야 한다. 이러한 경우, 작은 수치적 잡음을 고려하여 행렬의 순위를 결정해야 한다.</p>
<h3 id="_17">선형 독립성 확인</h3>
<p>QR 분해는 행렬의 열 벡터들이 선형 독립인지 확인하는 데 사용할 수 있다. 주어진 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A} \in \mathbb{R}^{m \times n}</span><script type="math/tex">\mathbf{A} \in \mathbb{R}^{m \times n}</script></span>의 QR 분해를 통해 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>이 얻어지면, 이 행렬의 대각 성분이 모두 0이 아닌 경우 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 열 벡터는 선형 독립임을 의미한다.</p>
<h4 id="_18">예제: 선형 독립성 검사</h4>
<p>다음 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = 
\begin{bmatrix}
1 &amp; 2 &amp; 3 \\
2 &amp; 4 &amp; 6 \\
3 &amp; 6 &amp; 9
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{A} = 
\begin{bmatrix}
1 & 2 & 3 \\
2 & 4 & 6 \\
3 & 6 & 9
\end{bmatrix}
</script>
</div>
<p>이 행렬의 QR 분해를 수행하면 다음과 같이 된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{A} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{A} = \mathbf{Q} \mathbf{R}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} = 
\begin{bmatrix}
\sqrt{14} &amp; \frac{28}{\sqrt{14}} &amp; \frac{42}{\sqrt{14}} \\
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{R} = 
\begin{bmatrix}
\sqrt{14} & \frac{28}{\sqrt{14}} & \frac{42}{\sqrt{14}} \\
0 & 0 & 0 \\
0 & 0 & 0
\end{bmatrix}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 두 번째와 세 번째 대각 성분이 0이므로, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 두 번째 및 세 번째 열 벡터는 선형 종속임을 알 수 있다. 따라서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 열 벡터들은 선형 독립이 아니다.</p>
<h3 id="2">2. 행렬 순위 계산</h3>
<p>QR 분해는 행렬의 순위(rank)를 계산하는 데에도 사용된다. 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 QR 분해에서 상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 대각 성분 중 0이 아닌 요소의 수가 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{A}</span><script type="math/tex">\mathbf{A}</script></span>의 순위이다.</p>
<h4 id="_19">예제: 행렬 순위 계산</h4>
<p>다음과 같은 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{B}</span><script type="math/tex">\mathbf{B}</script></span>가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{B} = 
\begin{bmatrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{B} = 
\begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
</script>
</div>
<p><span class="arithmatex"><span class="MathJax_Preview">\mathbf{B}</span><script type="math/tex">\mathbf{B}</script></span>에 대해 QR 분해를 수행하면 다음과 같이 된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{B} = \mathbf{Q} \mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{B} = \mathbf{Q} \mathbf{R}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R} = 
\begin{bmatrix}
-\sqrt{66} &amp; -\frac{32}{\sqrt{66}} &amp; -\frac{48}{\sqrt{66}} \\
0 &amp; \sqrt{6} &amp; \frac{6}{\sqrt{6}} \\
0 &amp; 0 &amp; 0
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{R} = 
\begin{bmatrix}
-\sqrt{66} & -\frac{32}{\sqrt{66}} & -\frac{48}{\sqrt{66}} \\
0 & \sqrt{6} & \frac{6}{\sqrt{6}} \\
0 & 0 & 0
\end{bmatrix}
</script>
</div>
<p><span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>의 대각 성분 중 0이 아닌 두 개의 요소가 있으므로, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{B}</span><script type="math/tex">\mathbf{B}</script></span>의 순위는 2이다. 즉, <span class="arithmatex"><span class="MathJax_Preview">\mathbf{B}</span><script type="math/tex">\mathbf{B}</script></span>는 2차원 공간에서 선형적으로 독립적인 열 벡터 두 개를 가지고 있다.</p>
<h3 id="3">3. 최소 제곱 문제의 정규방정식 유도</h3>
<p>QR 분해는 최소 제곱 문제의 정규방정식(normal equation)을 유도하는 데도 활용된다. 주어진 과적정(underdetermined) 시스템에서, 정규방정식 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}^T\mathbf{X}\mathbf{\beta} = \mathbf{X}^T\mathbf{y}</span><script type="math/tex">\mathbf{X}^T\mathbf{X}\mathbf{\beta} = \mathbf{X}^T\mathbf{y}</script></span>를 풀기 위해 QR 분해를 사용하면 계산이 간단해진다.</p>
<h4 id="_20">예제: 정규방정식 유도</h4>
<p>다음과 같은 과적정 시스템이 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X}\mathbf{\beta} = \mathbf{y}
</div>
<script type="math/tex; mode=display">
\mathbf{X}\mathbf{\beta} = \mathbf{y}
</script>
</div>
<p>여기서 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>는 <span class="arithmatex"><span class="MathJax_Preview">m \times n</span><script type="math/tex">m \times n</script></span> 행렬이고, <span class="arithmatex"><span class="MathJax_Preview">m &gt; n</span><script type="math/tex">m > n</script></span>이다. QR 분해를 이용해 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{X}</span><script type="math/tex">\mathbf{X}</script></span>를 분해하면:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{X} = \mathbf{Q}\mathbf{R}
</div>
<script type="math/tex; mode=display">
\mathbf{X} = \mathbf{Q}\mathbf{R}
</script>
</div>
<p>정규방정식을 풀기 위해, QR 분해를 사용하면 다음과 같은 간단한 선형 시스템으로 변환된다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{R}\mathbf{\beta} = \mathbf{Q}^T\mathbf{y}
</div>
<script type="math/tex; mode=display">
\mathbf{R}\mathbf{\beta} = \mathbf{Q}^T\mathbf{y}
</script>
</div>
<p>상삼각 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{R}</span><script type="math/tex">\mathbf{R}</script></span>을 이용하여 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{\beta}</span><script type="math/tex">\mathbf{\beta}</script></span>를 쉽게 구할 수 있다.</p>
<h3 id="4-qr">4. 고유값 문제와 QR 알고리즘</h3>
<p>QR 알고리즘은 QR 분해를 반복적으로 사용하여 행렬의 고유값을 구하는 방법이다. 이 알고리즘은 대칭 행렬의 고유값을 효율적으로 계산할 수 있다.</p>
<h4 id="_21">예제: 고유값 계산</h4>
<p>대칭 행렬 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{C}</span><script type="math/tex">\mathbf{C}</script></span>가 주어졌다고 가정한다:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbf{C} = 
\begin{bmatrix}
2 &amp; 1 \\
1 &amp; 2
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\mathbf{C} = 
\begin{bmatrix}
2 & 1 \\
1 & 2
\end{bmatrix}
</script>
</div>
<p>QR 알고리즘을 사용하여 <span class="arithmatex"><span class="MathJax_Preview">\mathbf{C}</span><script type="math/tex">\mathbf{C}</script></span>의 고유값을 계산한다. 이 행렬의 QR 분해를 반복하여 새로운 행렬을 생성하고, 이 과정이 수렴하면 대각 성분이 고유값에 가까워진다.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../082/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../082/" class="btn btn-xs btn-link">
        QR 분해의 한계와 문제 해결 전략
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../chapter_07/074/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../chapter_07/074/" class="btn btn-xs btn-link">
        C/C++에서의 QR 분해
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>